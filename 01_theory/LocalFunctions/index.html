
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Ikarus documentation.">
      
      
        <meta name="author" content="The Ikarus Developers">
      
      
        <link rel="canonical" href="https://IkarusRepo.github.io/01_theory/LocalFunctions/">
      
      <link rel="icon" href="../../images/logo_dummy.svg">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.8">
    
    
      
        <title>Local functions - Ikarus</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.644de097.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="pink">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#local-functions" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Ikarus" class="md-header__button md-logo" aria-label="Ikarus" data-md-component="logo">
      
  <img src="../../images/logo_white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Ikarus
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Local functions
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="pink"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="light-blue" data-md-color-accent="pink"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/IkarusRepo/Ikarus" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    IkarusRepo/Ikarus
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Ikarus" class="md-nav__button md-logo" aria-label="Ikarus" data-md-component="logo">
      
  <img src="../../images/logo_white.svg" alt="logo">

    </a>
    Ikarus
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/IkarusRepo/Ikarus" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    IkarusRepo/Ikarus
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../download/" class="md-nav__link">
        Download
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../howtocontribute/" class="md-nav__link">
        How to contribute
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Documentation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Documentation" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Documentation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../documentation/howToEdit/" class="md-nav__link">
        How to edit the documentation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../documentation/BuildTheDocumentationLocally/" class="md-nav__link">
        Build the documentation locally
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Tutorials
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tutorials" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/tutorialsOverview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Theory and Class Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Theory and Class Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Theory and Class Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../interfaceVSimplementation/" class="md-nav__link">
        Interface vs. Implementation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../theoryGeometry/" class="md-nav__link">
        Geometry
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../theoryGrid/" class="md-nav__link">
        Grid
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../FiniteElements/" class="md-nav__link">
        Finite Elements
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Assembler/" class="md-nav__link">
        Assembler
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../NonlinearOperator/" class="md-nav__link">
        NonlinearOperator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ControlRoutines/" class="md-nav__link">
        Control routines
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../LocalBasis/" class="md-nav__link">
        Local basis
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Local functions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Local functions
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#interface" class="md-nav__link">
    Interface
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#derivatives-wrt-coefficients" class="md-nav__link">
    Derivatives w.r.t. coefficients
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#derivatives-wrt-coefficients-and-spatial-derivatives" class="md-nav__link">
    Derivatives w.r.t. coefficients and spatial derivatives
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-dirichlet-energy" class="md-nav__link">
    Example Dirichlet energy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementations" class="md-nav__link">
    Implementations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-implement-your-own-local-functions" class="md-nav__link">
    How to implement your own local functions
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Manifolds/" class="md-nav__link">
        Manifolds
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Solvers/" class="md-nav__link">
        Solvers
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Examples
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Examples" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/integrate_pi/" class="md-nav__link">
        Integrate pi
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../99_Literature/99_Literature/" class="md-nav__link">
        Literature
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../cppRef/" class="md-nav__link">
        C++ recommendations
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../AdvancedTopics/" class="md-nav__link">
        Advanced Topics
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../02_gallery/gallery/" class="md-nav__link">
        Gallery
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#interface" class="md-nav__link">
    Interface
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#derivatives-wrt-coefficients" class="md-nav__link">
    Derivatives w.r.t. coefficients
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#derivatives-wrt-coefficients-and-spatial-derivatives" class="md-nav__link">
    Derivatives w.r.t. coefficients and spatial derivatives
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-dirichlet-energy" class="md-nav__link">
    Example Dirichlet energy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementations" class="md-nav__link">
    Implementations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-implement-your-own-local-functions" class="md-nav__link">
    How to implement your own local functions
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/IkarusRepo/Ikarus/edit/master/docs/01_theory/LocalFunctions.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>



<h1 id="local-functions">Local functions<a class="headerlink" href="#local-functions" title="Permanent link">&para;</a></h1>
<p>This section explains the concept of local functions.</p>
<p>Local functions are functions which are bound to single grid elements.
Therefore they are constructed from some local basis and a coefficient vector.</p>
<p>Usually local functions need to be evaluated in the local coordinate system <span class="arithmatex">\( \mathbb{\xi} \in T_{\text{ref}} \subset\mathbb{R}^n \)</span> :</p>
<div class="arithmatex">\[
f: \boldsymbol{\xi}^n \rightarrow \mathbb{R}^m
\]</div>
<p>where <span class="arithmatex">\(T_{\text{ref}}\)</span> is the reference element, e.g. for a cube <span class="arithmatex">\(T_{\text{ref}}= [0,1]^d\)</span>.</p>
<h2 id="interface">Interface<a class="headerlink" href="#interface" title="Permanent link">&para;</a></h2>
<p>Local functions provide the following interface
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">FunctionReturnType</span><span class="w"> </span><span class="nf">evaluateFunction</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">DomainType</span><span class="o">&amp;</span><span class="w"> </span><span class="n">local</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">FunctionReturnType</span><span class="w"> </span><span class="nf">evaluateFunction</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">&amp;</span><span class="w"> </span><span class="n">integrationPointIndex</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="k">auto</span><span class="w"> </span><span class="n">evaluateDerivative</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">DomainType</span><span class="o">&amp;</span><span class="w"> </span><span class="n">local</span><span class="p">,...);</span><span class="w"></span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="k">auto</span><span class="w"> </span><span class="n">evaluateDerivative</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">&amp;</span><span class="w"> </span><span class="n">integrationPointIndex</span><span class="p">,...);</span><span class="w"></span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="k">auto</span><span class="w"> </span><span class="n">viewOverIntegrationPoints</span><span class="p">();</span><span class="w"> </span><span class="c1">// (1)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">IntegrationRule</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span><span class="p">...</span><span class="w"> </span><span class="n">Ints</span><span class="o">&gt;</span><span class="w"></span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="kt">void</span><span class="w"> </span><span class="n">bind</span><span class="p">(</span><span class="n">IntegrationRule</span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">p_rule</span><span class="p">,</span><span class="w"> </span><span class="n">Derivatives</span><span class="o">&lt;</span><span class="n">Ints</span><span class="p">...</span><span class="o">&gt;&amp;&amp;</span><span class="w"> </span><span class="n">ints</span><span class="p">);</span><span class="w"> </span><span class="c1">// (2)</span>
</code></pre></div></p>
<ol>
<li>This returns a vector of structs of the integration point and its index. Therefore the syntax is usually <code class="highlight"><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="p">[</span><span class="n">gpIndex</span><span class="p">,</span><span class="w"> </span><span class="n">gp</span><span class="p">]</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">localFunction</span><span class="p">.</span><span class="n">viewOverIntegrationPoints</span><span class="p">())</span><span class="w"> </span><span class="p">{...}</span><span class="w"></span></code></li>
<li>This function is passed through to the given <code>localBasis</code>. See <a href="../LocalBasis/">Link</a></li>
</ol>
<p>The "..." in the <code>evaluateDerivative</code> function call are several variadic templates.
In action this looks like</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Usage with integration point index</label><label for="__tabbed_1_2">using integration point coordinates</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">Ikarus</span><span class="o">::</span><span class="nn">DerivativeDirections</span><span class="p">;</span><span class="w"></span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="n">localFunction</span><span class="p">.</span><span class="n">bind</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span><span class="w"> </span><span class="n">bindDerivatives</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">));</span><span class="w">    </span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="k">for</span><span class="p">(</span><span class="k">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="p">[</span><span class="n">gpIndex</span><span class="p">,</span><span class="w"> </span><span class="n">gp</span><span class="p">]</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">localFunction</span><span class="p">.</span><span class="n">viewOverIntegrationPoints</span><span class="p">()){</span><span class="w"></span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">  </span><span class="n">localFunction</span><span class="p">.</span><span class="n">evaluateDerivative</span><span class="p">(</span><span class="n">gpIndex</span><span class="p">,</span><span class="w"> </span><span class="n">wrt</span><span class="p">(</span><span class="n">spatialall</span><span class="p">));</span><span class="w"> </span><span class="c1">// (1)</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">  </span><span class="n">localFunction</span><span class="p">.</span><span class="n">evaluateDerivative</span><span class="p">(</span><span class="n">gpIndex</span><span class="p">,</span><span class="w"> </span><span class="n">wrt</span><span class="p">(</span><span class="n">spatialall</span><span class="p">),</span><span class="w"> </span><span class="n">transformWith</span><span class="p">(</span><span class="n">Jinv</span><span class="p">));</span><span class="w"> </span><span class="c1">// (2)</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="p">}</span><span class="w"></span>
</code></pre></div>
<ol>
<li>Compute the spatial Jacobian of localFunction</li>
<li>Compute the spatial Jacobian of localFunction and transform it to physical coordinates</li>
</ol>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">Ikarus</span><span class="o">::</span><span class="nn">DerivativeDirections</span><span class="p">;</span><span class="w"></span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="k">for</span><span class="p">(</span><span class="k">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="n">gp</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">rule</span><span class="p">){</span><span class="w"></span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="w">  </span><span class="n">localFunction</span><span class="p">.</span><span class="n">evaluateDerivative</span><span class="p">(</span><span class="n">gp</span><span class="p">.</span><span class="n">position</span><span class="p">(),</span><span class="w"> </span><span class="n">wrt</span><span class="p">(</span><span class="n">spatialall</span><span class="p">));</span><span class="w"> </span><span class="c1">// (1)</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="w">  </span><span class="n">localFunction</span><span class="p">.</span><span class="n">evaluateDerivative</span><span class="p">(</span><span class="n">gp</span><span class="p">.</span><span class="n">position</span><span class="p">(),</span><span class="w"> </span><span class="n">wrt</span><span class="p">(</span><span class="n">spatialall</span><span class="p">),</span><span class="w"> </span><span class="n">transformWith</span><span class="p">(</span><span class="n">Jinv</span><span class="p">));</span><span class="w"> </span><span class="c1">// (2)</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="p">}</span><span class="w"></span>
</code></pre></div>
<ol>
<li>Compute the spatial Jacobian of localFunction</li>
<li>Compute the spatial Jacobian of localFunction and transform it to physical coordinates</li>
</ol>
</div>
</div>
</div>
<p>where the first call implements</p>
<div class="arithmatex">\[
\operatorname{grad}_\boldsymbol{\xi} f : \boldsymbol{\xi} \rightarrow \mathbb{R}^{m \times d}.
\]</div>
<p>The second one respect the fact that the local function in reality is defined in some physical space <span class="arithmatex">\(X\)</span> with the coordinate <span class="arithmatex">\(\boldsymbol{x}\)</span>.
Therefore, it transforms the Jacobian from the reference element <span class="arithmatex">\(\operatorname{grad}_{\boldsymbol{\xi}}\)</span> to the Jacobian in physical space <span class="arithmatex">\(\operatorname{grad}_\boldsymbol{x}\)</span> . E.g. it usually implements</p>
<div class="arithmatex">\[
\operatorname{grad}_\boldsymbol{x} = \operatorname{grad}_{\boldsymbol{\xi}} \boldsymbol{J}^{-1} 
\]</div>
<p>where <span class="arithmatex">\(J\)</span> is the Jacobian of the mapping from the reference element <span class="arithmatex">\(T_{\text{ref}}\)</span> to the element living in physical space <span class="arithmatex">\(T\)</span>.
For details see <sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup> page 22.</p>
<p>Instead of passing <code>spatialall</code> to <code>wrt(..)</code>, there are other helper such as</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">localFunction</span><span class="p">.</span><span class="n">evaluateDerivative</span><span class="p">(</span><span class="n">gpIndex</span><span class="p">,</span><span class="w"> </span><span class="n">wrt</span><span class="p">(</span><span class="n">spatial</span><span class="p">(</span><span class="mi">0</span><span class="p">)));</span><span class="w"> </span><span class="c1">// (1) </span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="n">localFunction</span><span class="p">.</span><span class="n">evaluateDerivative</span><span class="p">(</span><span class="n">gpIndex</span><span class="p">,</span><span class="w"> </span><span class="n">wrt</span><span class="p">(</span><span class="n">spatial</span><span class="p">(</span><span class="mi">1</span><span class="p">)));</span><span class="w"> </span><span class="c1">// (2)</span>
</code></pre></div>
<ol>
<li>Compute the first column of the spatial Jacobian of localFunction</li>
<li>Compute the second column of the spatial Jacobian of localFunction</li>
</ol>
<p>which can also be combined with <code>transformWith(Jinv)</code>.</p>
<h2 id="derivatives-wrt-coefficients">Derivatives w.r.t. coefficients<a class="headerlink" href="#derivatives-wrt-coefficients" title="Permanent link">&para;</a></h2>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">localFunction</span><span class="p">.</span><span class="n">evaluateDerivative</span><span class="p">(</span><span class="n">gpIndex</span><span class="p">,</span><span class="w"> </span><span class="n">wrt</span><span class="p">(</span><span class="n">coeffs</span><span class="p">),</span><span class="w"> </span><span class="n">coeffIndices</span><span class="p">(</span><span class="n">j</span><span class="p">));</span><span class="w"></span>
</code></pre></div>
which implements for simple interpolation in vector space valued functions,e.g. <span class="arithmatex">\(f(\boldsymbol{\xi}) = \sum_{I=1}^n N^I(\boldsymbol{\xi}) \boldsymbol{x}_I\)</span> the following</p>
<div class="arithmatex">\[
[\boldsymbol{A}]_{ij}  = A_{ij} =  \frac{\partial f_i(\boldsymbol{\xi})}{\partial \boldsymbol{x}_j}
\]</div>
<p>and the second derivative</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">localFunction</span><span class="p">.</span><span class="n">evaluateDerivative</span><span class="p">(</span><span class="n">gpIndex</span><span class="p">,</span><span class="w"> </span><span class="n">wrt</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span><span class="n">coeffs</span><span class="p">),</span><span class="w"> </span><span class="n">along</span><span class="p">(</span><span class="n">q</span><span class="p">),</span><span class="w"> </span><span class="n">coeffIndices</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">));</span><span class="w"></span>
</code></pre></div>
<div class="arithmatex">\[
[\boldsymbol{B}]_{jk} =  B_{jk} = q_i A_{ijk} =  \frac{\partial^2 (q_i  f_i(\boldsymbol{\xi}))}{\partial \boldsymbol{x}_j\partial \boldsymbol{x}_k}
\]</div>
<p>where <span class="arithmatex">\(\boldsymbol{q}\)</span> is an arbitrary vector of the same size as <span class="arithmatex">\(f\)</span>, i.e. it is the direction of the derivative in this case. $ \boldsymbol{A} $ and $ \boldsymbol{B} $ is simply the returned matrix and they do not have a special meaning. If we would not pass the vector the result would be a third order tensor for a vector valued function <span class="arithmatex">\(f\)</span>.
Therefore the simply return a matrix. This helps for readablilty and for speed. See the <a href="#example-dirichlet-energy">example</a> for details.</p>
<h2 id="derivatives-wrt-coefficients-and-spatial-derivatives">Derivatives w.r.t. coefficients and spatial derivatives<a class="headerlink" href="#derivatives-wrt-coefficients-and-spatial-derivatives" title="Permanent link">&para;</a></h2>
<p>Spatial derivatives and derivatives w.r.t. the coefficients can be combined. Therefore, it is legal to call</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="k">auto</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">localFunction</span><span class="p">.</span><span class="n">evaluateDerivative</span><span class="p">(</span><span class="n">gpIndex</span><span class="p">,</span><span class="w"> </span><span class="n">wrt</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span><span class="n">coeffs</span><span class="p">,</span><span class="n">spatialall</span><span class="p">),</span><span class="w"> </span><span class="n">along</span><span class="p">(</span><span class="n">q</span><span class="p">),</span><span class="w"> </span><span class="n">coeffIndices</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">));</span><span class="w"></span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="k">auto</span><span class="w"> </span><span class="n">B0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">localFunction</span><span class="p">.</span><span class="n">evaluateDerivative</span><span class="p">(</span><span class="n">gpIndex</span><span class="p">,</span><span class="w"> </span><span class="n">wrt</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span><span class="n">coeffs</span><span class="p">,</span><span class="n">spatial</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span><span class="w"> </span><span class="n">along</span><span class="p">(</span><span class="n">q</span><span class="p">),</span><span class="w"> </span><span class="n">coeffIndices</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">));</span><span class="w"></span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="k">auto</span><span class="w"> </span><span class="n">B1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">localFunction</span><span class="p">.</span><span class="n">evaluateDerivative</span><span class="p">(</span><span class="n">gpIndex</span><span class="p">,</span><span class="w"> </span><span class="n">wrt</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span><span class="n">coeffs</span><span class="p">,</span><span class="n">spatial</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span><span class="w"> </span><span class="n">along</span><span class="p">(</span><span class="n">q</span><span class="p">),</span><span class="w"> </span><span class="n">coeffIndices</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">));</span><span class="w"></span>
</code></pre></div>
<p>The first line is then equivalent to</p>
<div class="arithmatex">\[
[\boldsymbol{B}]_{ljk} =  B_{ljk} = q_i A_{iljk} =  \frac{\partial^2 ([\operatorname{grad}_\boldsymbol{\xi} f(\boldsymbol{\xi})]_{il} q_i )}{\partial \boldsymbol{x}_j\partial \boldsymbol{x}_k}.
\]</div>
<p>this returns an object where the first index contains the spatial derivative w.r.t. <span class="arithmatex">\(\xi_0\)</span>.
Thus we have </p>
<div class="arithmatex">\[\begin{align}
\boldsymbol{B}[0]_{jk} = \frac{\partial^2 ([\operatorname{grad}_{\xi^0} f(\xi)]_{i} q_i )}{\partial \boldsymbol{x}_j\partial \boldsymbol{x}_k}, \\
\boldsymbol{B}[1]_{jk} = \frac{\partial^2 ([\operatorname{grad}_{\xi^1} f(\xi)]_{i} q_i )}{\partial \boldsymbol{x}_j\partial \boldsymbol{x}_k}.
\end{align}\]</div>
<p>These objects are also returned when the second and third line above are used.</p>
<p>Again all of these function calls can be combined with <code>transformWith()</code> as</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">localFunction</span><span class="p">.</span><span class="n">evaluateDerivative</span><span class="p">(</span><span class="n">gpIndex</span><span class="p">,</span><span class="w"> </span><span class="n">wrt</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span><span class="n">coeffs</span><span class="p">,</span><span class="n">spatialall</span><span class="p">),</span><span class="w"> </span><span class="n">along</span><span class="p">(</span><span class="n">q</span><span class="p">),</span><span class="n">transformWith</span><span class="p">(</span><span class="n">Jinv</span><span class="p">),</span><span class="w"> </span><span class="n">coeffIndices</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">));</span><span class="w"></span>
</code></pre></div>
<p>which computes</p>
<div class="arithmatex">\[
\frac{\partial^2 ([\operatorname{grad}_\boldsymbol{x} f(\boldsymbol{\xi})]_{il} q_i )}{\partial \boldsymbol{x}_j\partial \boldsymbol{x}_k}.
\]</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Currently only first order spatial derivatives and second order derivatives w.r.t. the coefficients are supported.</p>
</div>
<h2 id="example-dirichlet-energy">Example Dirichlet energy<a class="headerlink" href="#example-dirichlet-energy" title="Permanent link">&para;</a></h2>
<p>This examples shows how the energy, gradient and Hessian of a <a href="https://en.wikipedia.org/wiki/Dirichlet_energy">dirichlet energy</a> can be calculated.
$$
E(\boldsymbol{u}) = \frac{1}{2} \int_\Omega ||\operatorname{grad}_\boldsymbol{x} \boldsymbol{u}(\boldsymbol{x})|| ^2 \textrm{d} \boldsymbol{x}
$$</p>
<p>If we want to mimize this energy w.r.t. the coefficients of the nodes, we need to calculate the energy, gradient and the Hessia w.r.t. the coefficents. 
Of course this depends on the optimization algorithms, but for now lets keep it simple.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="k">auto</span><span class="w"> </span><span class="n">dirichletEnergy</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">energy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="w">  </span><span class="c1">//... bind localBasis to some integration rule</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="w">  </span><span class="c1">// and create uNodalCoeffs</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="w">  </span><span class="n">Ikarus</span><span class="o">::</span><span class="n">StandardLocalFunction</span><span class="w"> </span><span class="nf">uFunction</span><span class="p">(</span><span class="n">localBasis</span><span class="p">,</span><span class="w"> </span><span class="n">uNodalCoeffs</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="p">[</span><span class="n">gpIndex</span><span class="p">,</span><span class="w"> </span><span class="n">gp</span><span class="p">]</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">uFunction</span><span class="p">.</span><span class="n">viewOverIntegrationPoints</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="w">    </span><span class="c1">//.. calculate the inverse Jacobian of the geometry</span>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">gradu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uFunction</span><span class="p">.</span><span class="n">evaluateDerivative</span><span class="p">(</span><span class="n">gpIndex</span><span class="p">,</span><span class="w"> </span><span class="n">wrt</span><span class="p">(</span><span class="n">spatialall</span><span class="p">),</span><span class="w"> </span><span class="n">transformWith</span><span class="p">(</span><span class="n">Jinv</span><span class="p">));</span><span class="w"></span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="w">    </span><span class="n">energy</span><span class="o">+=</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">gradu</span><span class="p">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">*</span><span class="n">gradu</span><span class="p">).</span><span class="n">trace</span><span class="p">()</span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;weight from integration point and geo.integrationElement&quot;</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="w">  </span><span class="p">}</span><span class="w"></span>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="p">}</span><span class="w"></span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="k">auto</span><span class="w"> </span><span class="n">gradientDirichletEnergy</span><span class="p">(</span><span class="n">Eigen</span><span class="o">::</span><span class="n">VectorXd</span><span class="o">&amp;</span><span class="w"> </span><span class="n">g</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="w">  </span><span class="c1">//... bind localBasis to some integration rule</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="w">  </span><span class="c1">// and create uNodalCoeffs</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="w">  </span><span class="k">constexpr</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="c1">// spatial size of u</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="w">      </span><span class="n">Ikarus</span><span class="o">::</span><span class="n">StandardLocalFunction</span><span class="w"> </span><span class="n">uFunction</span><span class="p">(</span><span class="n">localBasis</span><span class="p">,</span><span class="w"> </span><span class="n">uNodalCoeffs</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="p">[</span><span class="n">gpIndex</span><span class="p">,</span><span class="w"> </span><span class="n">gp</span><span class="p">]</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">uFunction</span><span class="p">.</span><span class="n">viewOverIntegrationPoints</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="w">    </span><span class="c1">//.. calculate the inverse Jacobian of the geometry</span>
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">gradu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uFunction</span><span class="p">.</span><span class="n">evaluateDerivative</span><span class="p">(</span><span class="n">gpIndex</span><span class="p">,</span><span class="w"> </span><span class="n">wrt</span><span class="p">(</span><span class="n">spatialall</span><span class="p">),</span><span class="w"> </span><span class="n">transformWith</span><span class="p">(</span><span class="n">Jinv</span><span class="p">));</span><span class="w"></span>
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">fe</span><span class="p">.</span><span class="n">size</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">//loop over coeffs, i.e.nodes of the finite element</span>
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="w">      </span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">graduDCoeffs</span><span class="w"></span>
<a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="n">uFunction</span><span class="p">.</span><span class="n">evaluateDerivative</span><span class="p">(</span><span class="n">gpIndex</span><span class="p">,</span><span class="w"> </span><span class="n">wrt</span><span class="p">(</span><span class="n">spatialall</span><span class="p">,</span><span class="w"> </span><span class="n">coeffs</span><span class="p">),</span><span class="w"> </span><span class="n">transformWith</span><span class="p">(</span><span class="n">Jinv</span><span class="p">),</span><span class="w"> </span><span class="n">coeffIndices</span><span class="p">(</span><span class="n">i</span><span class="p">));</span><span class="w"></span>
<a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="w">      </span><span class="n">Eigen</span><span class="o">::</span><span class="n">Vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">&gt;</span><span class="w"> </span><span class="n">tmp</span><span class="p">;</span><span class="w"></span>
<a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="w">      </span><span class="n">tmp</span><span class="p">.</span><span class="n">setZero</span><span class="p">();</span><span class="w"></span>
<a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">gridDimension</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a><span class="w">        </span><span class="n">tmp</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">graduDCoeffs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gradu</span><span class="p">.</span><span class="n">col</span><span class="p">(</span><span class="n">k</span><span class="p">);</span><span class="w">  </span><span class="c1">// (1)</span>
<a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a><span class="w">      </span><span class="n">g</span><span class="p">.</span><span class="n">segment</span><span class="o">&lt;</span><span class="n">size</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">size</span><span class="p">)</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">tmp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;weight from integration point and geo.integrationElement&quot;</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a><span class="w">    </span><span class="p">}</span><span class="w"></span>
<a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a><span class="w">  </span><span class="p">}</span><span class="w"></span>
<a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a><span class="p">}</span><span class="w"></span>
</code></pre></div>
<ol>
<li><code>graduDCoeffs</code> contains in <code>graduDCoeffs[0]</code> the derivatives w.r.t.the coefficient of the first column and at <code>[1]</code> w.r.t.the second colum of <code>gradu</code></li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="k">auto</span><span class="w"> </span><span class="n">hessianDirichletEnergy</span><span class="p">(</span><span class="n">Matrix</span><span class="o">&amp;</span><span class="w"> </span><span class="n">h</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="w">  </span><span class="c1">//... bind localBasis to some integration rule</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="w">  </span><span class="c1">// and create uNodalCoeffs</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="w">  </span><span class="k">constexpr</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="c1">// spatial size of u</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="w">      </span><span class="n">Ikarus</span><span class="o">::</span><span class="n">StandardLocalFunction</span><span class="w"> </span><span class="n">uFunction</span><span class="p">(</span><span class="n">localBasis</span><span class="p">,</span><span class="w"> </span><span class="n">uNodalCoeffs</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="p">[</span><span class="n">gpIndex</span><span class="p">,</span><span class="w"> </span><span class="n">gp</span><span class="p">]</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">uFunction</span><span class="p">.</span><span class="n">viewOverIntegrationPoints</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="w">    </span><span class="c1">//.. calculate the inverse Jacobian of the geometry</span>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">coeffs</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">.</span><span class="n">e</span><span class="p">.</span><span class="n">nodes</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">finite</span><span class="w"> </span><span class="n">element</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="w">      </span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">graduDCoeffsI</span><span class="w"></span>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="n">uFunction</span><span class="p">.</span><span class="n">evaluateDerivative</span><span class="p">(</span><span class="n">gpIndex</span><span class="p">,</span><span class="w"> </span><span class="n">wrt</span><span class="p">(</span><span class="n">spatialall</span><span class="p">,</span><span class="w"> </span><span class="n">coeffs</span><span class="p">),</span><span class="w"> </span><span class="n">transformWith</span><span class="p">(</span><span class="n">Jinv</span><span class="p">),</span><span class="w"> </span><span class="n">coeffIndices</span><span class="p">(</span><span class="n">i</span><span class="p">));</span><span class="w"></span>
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">fe</span><span class="p">.</span><span class="n">size</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">//loop over coeffs, i.e.nodes of the finite element</span>
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="w">        </span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">graduDCoeffsJ</span><span class="w"></span>
<a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="n">uFunction</span><span class="p">.</span><span class="n">evaluateDerivative</span><span class="p">(</span><span class="n">gpIndex</span><span class="p">,</span><span class="w"> </span><span class="n">wrt</span><span class="p">(</span><span class="n">spatialall</span><span class="p">,</span><span class="w"> </span><span class="n">coeffs</span><span class="p">),</span><span class="w"> </span><span class="n">transformWith</span><span class="p">(</span><span class="n">Jinv</span><span class="p">),</span><span class="w"> </span><span class="n">coeffIndices</span><span class="p">(</span><span class="n">j</span><span class="p">));</span><span class="w"></span>
<a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a><span class="w">        </span><span class="n">Eigen</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">&gt;</span><span class="w"> </span><span class="n">tmp</span><span class="p">;</span><span class="w"></span>
<a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a><span class="w">        </span><span class="n">tmp</span><span class="p">.</span><span class="n">setZero</span><span class="p">();</span><span class="w"></span>
<a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">gridDimension</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a><span class="w">          </span><span class="n">tmp</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">graduDCoeffsI</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">graduDCoeffsJ</span><span class="p">[</span><span class="n">k</span><span class="p">];</span><span class="w"></span>
<a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a><span class="w">        </span><span class="n">h</span><span class="p">.</span><span class="n">block</span><span class="o">&lt;</span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">size</span><span class="p">)</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">tmp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;weight from integration point and geo.integrationElement&quot;</span><span class="p">);</span><span class="w"></span>
<a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a><span class="w">      </span><span class="p">}</span><span class="w"></span>
<a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a><span class="w">    </span><span class="p">}</span><span class="w"></span>
<a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a><span class="w">  </span><span class="p">}</span><span class="w"></span>
<a id="__codelineno-10-22" name="__codelineno-10-22" href="#__codelineno-10-22"></a><span class="p">}</span><span class="w"></span>
</code></pre></div>
<h2 id="implementations">Implementations<a class="headerlink" href="#implementations" title="Permanent link">&para;</a></h2>
<p>In the following we summarize the local functions that are currently available.
In the follwing table <span class="arithmatex">\(N^i(\boldsymbol{\xi})\)</span> are the ansatz functions.</p>
<table>
<thead>
<tr>
<th align="left">Name</th>
<th align="left">Interpolation formula</th>
<th align="left">Note</th>
<th>Header</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Standard</td>
<td align="left">$$ \boldsymbol{x} = \sum_{i=1}^n N^i(\boldsymbol{\xi}) \boldsymbol{x}_i  $$</td>
<td align="left"></td>
<td><code>standardLocalFunction.hh</code></td>
</tr>
<tr>
<td align="left">Projection-Based<sup id="fnref:2"><a class="footnote-ref" href="#fn:2">2</a></sup></td>
<td align="left">$$ \boldsymbol{x} = P\left(\sum_{i=1}^n N^i(\boldsymbol{\xi}) \boldsymbol{x}_i \right) $$</td>
<td align="left">This is one version of geometric finite elements. These are finite elements suited for interpolation on manifolds. Here <span class="arithmatex">\(P: \mathbb{R}^m \rightarrow \mathcal{M}\)</span> is an operator that projects <br /> the usual linear interpolation onto some manifold</td>
<td><code>projectionBasedLocalFunction.hh</code></td>
</tr>
</tbody>
</table>
<h2 id="how-to-implement-your-own-local-functions">How to implement your own local functions<a class="headerlink" href="#how-to-implement-your-own-local-functions" title="Permanent link">&para;</a></h2>
<p>If you are interested in implementing your own local function we have prepared the file
<a href="https://github.com/IkarusRepo/Ikarus/src/include/ikarus/LocalFunctions/LocalFunctionTemplate.h"><code>ikarus/LocalFunctions/LocalFunctionTemplate.h</code></a>.</p>
<p>You can copy the file rename the class to your preferred name and then implement the following functions. If you don't need a function you need to delete the corresponding function.
Then if someone calls the corresponding derivative the call fails at compile time.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="n">FunctionReturnType</span><span class="w"> </span><span class="nf">evaluateEmbeddingFunctionImpl</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Eigen</span><span class="o">::</span><span class="n">VectorXd</span><span class="o">&amp;</span><span class="w"> </span><span class="n">N</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">FunctionReturnType</span><span class="p">{};</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="c1">// (0)</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="n">Jacobian</span><span class="w"> </span><span class="nf">evaluateDerivativeWRTSpaceAllImpl</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">AnsatzFunctionType</span><span class="o">&amp;</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="w">                                           </span><span class="k">const</span><span class="w"> </span><span class="n">AnsatzFunctionJacobian</span><span class="o">&amp;</span><span class="w"> </span><span class="n">dN</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{...}</span><span class="w"> </span><span class="c1">// (1)</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="n">JacobianColType</span><span class="w"> </span><span class="nf">evaluateDerivativeWRTSpaceSingleImpl</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">AnsatzFunctionType</span><span class="o">&amp;</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="w">                                                     </span><span class="k">const</span><span class="w"> </span><span class="n">AnsatzFunctionJacobian</span><span class="o">&amp;</span><span class="w"> </span><span class="n">dN</span><span class="p">,</span><span class="w"></span>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="w">                                                     </span><span class="kt">int</span><span class="w"> </span><span class="n">spaceIndex</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{...}</span><span class="w"> </span><span class="c1">// (2)</span>
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a>
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span class="n">CoeffDerivMatrix</span><span class="w"> </span><span class="nf">evaluateDerivativeWRTCoeffsImpl</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">AnsatzFunctionType</span><span class="o">&amp;</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"></span>
<a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a><span class="w">                                                 </span><span class="k">const</span><span class="w"> </span><span class="n">AnsatzFunctionJacobian</span><span class="o">&amp;</span><span class="w"> </span><span class="n">dN</span><span class="p">,</span><span class="w"></span>
<a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a><span class="w">                                                 </span><span class="kt">int</span><span class="w"> </span><span class="n">coeffsIndex</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{...}</span><span class="w"> </span><span class="c1">// (3)</span>
<a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a>
<a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a><span class="n">CoeffDerivMatrix</span><span class="w"> </span><span class="nf">evaluateSecondDerivativeWRTCoeffs</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">AnsatzFunctionType</span><span class="o">&amp;</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"></span>
<a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a><span class="w">                                                   </span><span class="k">const</span><span class="w"> </span><span class="n">AnsatzFunctionJacobian</span><span class="o">&amp;</span><span class="p">,</span><span class="w"></span>
<a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a><span class="w">                                                   </span><span class="k">const</span><span class="w"> </span><span class="n">AlongType</span><span class="o">&amp;</span><span class="w"> </span><span class="n">along</span><span class="p">,</span><span class="w"></span>
<a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a><span class="w">                                                   </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">,</span><span class="w"> </span><span class="n">gridDim</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">coeffsIndex</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{...}</span><span class="w"> </span><span class="c1">// (4)</span>
<a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a>
<a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a><span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="n">CoeffDerivMatrix</span><span class="p">,</span><span class="w"> </span><span class="n">gridDim</span><span class="o">&gt;</span><span class="w"> </span>
<a id="__codelineno-11-21" name="__codelineno-11-21" href="#__codelineno-11-21"></a><span class="w">        </span><span class="n">evaluateDerivativeWRTCoeffsANDSpatialImpl</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">AnsatzFunctionType</span><span class="o">&amp;</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-11-22" name="__codelineno-11-22" href="#__codelineno-11-22"></a><span class="w">                                                  </span><span class="k">const</span><span class="w"> </span><span class="n">AnsatzFunctionJacobian</span><span class="o">&amp;</span><span class="w"> </span><span class="n">dN</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-11-23" name="__codelineno-11-23" href="#__codelineno-11-23"></a><span class="w">                                                  </span><span class="kt">int</span><span class="w"> </span><span class="n">coeffsIndex</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{...}</span><span class="w"> </span><span class="c1">// (5)</span>
<a id="__codelineno-11-24" name="__codelineno-11-24" href="#__codelineno-11-24"></a>
<a id="__codelineno-11-25" name="__codelineno-11-25" href="#__codelineno-11-25"></a>
<a id="__codelineno-11-26" name="__codelineno-11-26" href="#__codelineno-11-26"></a><span class="n">CoeffDerivMatrix</span><span class="w"> </span><span class="n">evaluateDerivativeWRTCoeffsANDSpatialSingleImpl</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">AnsatzFunctionType</span><span class="o">&amp;</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"></span>
<a id="__codelineno-11-27" name="__codelineno-11-27" href="#__codelineno-11-27"></a><span class="w">                                                                 </span><span class="k">const</span><span class="w"> </span><span class="n">AnsatzFunctionJacobian</span><span class="o">&amp;</span><span class="w"> </span><span class="n">dN</span><span class="p">,</span><span class="w"></span>
<a id="__codelineno-11-28" name="__codelineno-11-28" href="#__codelineno-11-28"></a><span class="w">                                                                 </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">coeffsIndex</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-11-29" name="__codelineno-11-29" href="#__codelineno-11-29"></a><span class="w">                                                                 </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">spatialIndex</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{...}</span><span class="w"> </span><span class="c1">// (6)</span>
<a id="__codelineno-11-30" name="__codelineno-11-30" href="#__codelineno-11-30"></a>
<a id="__codelineno-11-31" name="__codelineno-11-31" href="#__codelineno-11-31"></a>
<a id="__codelineno-11-32" name="__codelineno-11-32" href="#__codelineno-11-32"></a><span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="n">CoeffDerivMatrix</span><span class="p">,</span><span class="w"> </span><span class="n">gridDim</span><span class="o">&gt;</span><span class="w"> </span>
<a id="__codelineno-11-33" name="__codelineno-11-33" href="#__codelineno-11-33"></a><span class="w">        </span><span class="n">evaluateThirdDerivativeWRTCoeffsTwoTimesAndSpatialImpl</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">AnsatzFunctionType</span><span class="o">&amp;</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-11-34" name="__codelineno-11-34" href="#__codelineno-11-34"></a><span class="w">                                                               </span><span class="k">const</span><span class="w"> </span><span class="n">AnsatzFunctionJacobian</span><span class="o">&amp;</span><span class="w"> </span><span class="n">dN</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-11-35" name="__codelineno-11-35" href="#__codelineno-11-35"></a><span class="w">                                                               </span><span class="k">const</span><span class="w"> </span><span class="n">AlongType</span><span class="o">&amp;</span><span class="w"> </span><span class="n">along</span><span class="p">,</span><span class="w"></span>
<a id="__codelineno-11-36" name="__codelineno-11-36" href="#__codelineno-11-36"></a><span class="w">                                                               </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">,</span><span class="w"> </span><span class="n">gridDim</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">coeffsIndex</span><span class="w"></span>
<a id="__codelineno-11-37" name="__codelineno-11-37" href="#__codelineno-11-37"></a><span class="w">                                                               </span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{...}</span><span class="w"> </span><span class="c1">// (7)</span>
<a id="__codelineno-11-38" name="__codelineno-11-38" href="#__codelineno-11-38"></a>
<a id="__codelineno-11-39" name="__codelineno-11-39" href="#__codelineno-11-39"></a><span class="n">CoeffDerivMatrix</span><span class="w"> </span>
<a id="__codelineno-11-40" name="__codelineno-11-40" href="#__codelineno-11-40"></a><span class="w">        </span><span class="n">evaluateThirdDerivativeWRTCoeffsTwoTimesAndSpatialSingleImpl</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">AnsatzFunctionType</span><span class="o">&amp;</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-11-41" name="__codelineno-11-41" href="#__codelineno-11-41"></a><span class="w">                                                                     </span><span class="k">const</span><span class="w"> </span><span class="n">AnsatzFunctionJacobian</span><span class="o">&amp;</span><span class="w"> </span><span class="n">dN</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-11-42" name="__codelineno-11-42" href="#__codelineno-11-42"></a><span class="w">                                                                     </span><span class="k">const</span><span class="w"> </span><span class="n">AlongType</span><span class="o">&amp;</span><span class="w"> </span><span class="n">along</span><span class="p">,</span><span class="w"></span>
<a id="__codelineno-11-43" name="__codelineno-11-43" href="#__codelineno-11-43"></a><span class="w">                                                                     </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">,</span><span class="w"> </span><span class="n">gridDim</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">coeffsIndex</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="w"></span>
<a id="__codelineno-11-44" name="__codelineno-11-44" href="#__codelineno-11-44"></a><span class="w">                                                                     </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">spatialIndex</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{...}</span><span class="w"> </span><span class="c1">// (8)</span>
</code></pre></div>
<ol>
<li>This is called by <code>localFunction.evaluateFunction(...)</code>.</li>
<li>This is called by <code>localFunction.evaluateDerivative(..., wrt(spatialall))</code>.</li>
<li>This is called by <code>localFunction.evaluateDerivative(..., wrt(spatial(i)))</code>.</li>
<li>This is called by <code>localFunction.evaluateDerivative(..., wrt(coeff))</code>.</li>
<li>This is called by <code>localFunction.evaluateDerivative(..., wrt(coeff,coeff))</code>.</li>
<li>This is called by <code>localFunction.evaluateDerivative(..., wrt(spatialall,coeff))</code>.</li>
<li>This is called by <code>localFunction.evaluateDerivative(..., wrt(spatial(i),coeff))</code>.</li>
<li>This is called by <code>localFunction.evaluateDerivative(..., wrt(spatialall,coeff,coeff))</code>.</li>
<li>This is called by <code>localFunction.evaluateDerivative(..., wrt(spatial(i),coeff,coeff))</code>.</li>
</ol>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>Oliver Sander. <em>DUNE—The Distributed and Unified Numerics Environment</em>. Volume 140. Springer Nature, 2020. URL: <a href="https://link.springer.com/book/10.1007/978-3-030-59702-3">https://link.springer.com/book/10.1007/978-3-030-59702-3</a>.&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:2">
<p>Philipp Grohs, Hanne Hardering, Oliver Sander, and Markus Sprecher. Projection-based finite elements for nonlinear function spaces. <em>SIAM J Numer Anal</em>, 57(1):404&ndash;428, 2019. <a href="https://doi.org/10.1137/18M1176798">doi:10.1137/18M1176798</a>.&#160;<a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
</ol>
</div>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../LocalBasis/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Local basis" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Local basis
            </div>
          </div>
        </a>
      
      
        
        <a href="../Manifolds/" class="md-footer__link md-footer__link--next" aria-label="Next: Manifolds" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Manifolds
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2021 The Ikarus Developers
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.5e67fbfe.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.c44cc438.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>