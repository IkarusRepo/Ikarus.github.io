\hypertarget{a00242_source}{}\doxysection{enhancedassumedstrains.\+hh}
\label{a00242_source}\index{enhancedassumedstrains.hh@{enhancedassumedstrains.hh}}
\mbox{\hyperlink{a00242}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// SPDX-\/FileCopyrightText: 2021-\/2024 The Ikarus Developers mueller@ibb.uni-\/stuttgart.de}}
\DoxyCodeLine{2 \textcolor{comment}{// SPDX-\/License-\/Identifier: LGPL-\/3.0-\/or-\/later}}
\DoxyCodeLine{3 }
\DoxyCodeLine{10 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{11 \textcolor{preprocessor}{\#if HAVE\_DUNE\_LOCALFEFUNCTIONS}}
\DoxyCodeLine{12 \textcolor{preprocessor}{  \#include <dune/localfefunctions/derivativetransformators.hh>}}
\DoxyCodeLine{13 \textcolor{preprocessor}{  \#include <dune/localfefunctions/linearAlgebraHelper.hh>}}
\DoxyCodeLine{14 \textcolor{preprocessor}{  \#include <dune/localfefunctions/meta.hh>}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{preprocessor}{  \#include <\mbox{\hyperlink{a00266}{ikarus/finiteelements/fehelper.hh}}>}}
\DoxyCodeLine{17 \textcolor{preprocessor}{  \#include <\mbox{\hyperlink{a00257}{ikarus/finiteelements/ferequirements.hh}}>}}
\DoxyCodeLine{18 \textcolor{preprocessor}{  \#include <\mbox{\hyperlink{a00188}{ikarus/finiteelements/mechanics/easvariants.hh}}>}}
\DoxyCodeLine{19 \textcolor{preprocessor}{  \#include <\mbox{\hyperlink{a00044}{ikarus/utils/eigendunetransformations.hh}}>}}
\DoxyCodeLine{20 }
\DoxyCodeLine{21 \textcolor{keyword}{namespace }\mbox{\hyperlink{a00328}{Ikarus}} \{}
\DoxyCodeLine{22 }
\DoxyCodeLine{32 \textcolor{keyword}{template} <\textcolor{keyword}{typename} DFE>}
\DoxyCodeLine{33 \textcolor{keyword}{class }\mbox{\hyperlink{a01316}{EnhancedAssumedStrains}} : \textcolor{keyword}{public} DFE}
\DoxyCodeLine{34 \{}
\DoxyCodeLine{35 \textcolor{keyword}{public}:}
\DoxyCodeLine{36   \textcolor{keyword}{using }\mbox{\hyperlink{a01316_aa4d918d0864a183347834f9861174790}{DisplacementBasedElement}} = DFE;}
\DoxyCodeLine{37   \textcolor{keyword}{using }\mbox{\hyperlink{a01316_a97269308bd2801507db2e6a94dbb2af6}{FERequirementType}}        = \textcolor{keyword}{typename} DisplacementBasedElement::FERequirementType;}
\DoxyCodeLine{38   \textcolor{keyword}{using }\mbox{\hyperlink{a01316_a74d724732937e321623e6176fa6972b8}{LocalView}}                = \textcolor{keyword}{typename} DisplacementBasedElement::LocalView;}
\DoxyCodeLine{39   \textcolor{keyword}{using }\mbox{\hyperlink{a01316_a1b26b4672074c3cab9342283a103d24f}{Geometry}}                 = \textcolor{keyword}{typename} DisplacementBasedElement::Geometry;}
\DoxyCodeLine{40   \textcolor{keyword}{using }\mbox{\hyperlink{a01316_a43e20490ab0d404b63750e724c06d420}{GridView}}                 = \textcolor{keyword}{typename} DisplacementBasedElement::GridView;}
\DoxyCodeLine{41   \textcolor{keyword}{using }\mbox{\hyperlink{a01316_a953bd75b1ff8c1dec35e12bb7f44a27d}{Traits}}                   = \textcolor{keyword}{typename} DisplacementBasedElement::Traits;}
\DoxyCodeLine{42 }
\DoxyCodeLine{43   \textcolor{keyword}{using }DisplacementBasedElement::localView;}
\DoxyCodeLine{44 }
\DoxyCodeLine{53   \textcolor{keyword}{template} <\textcolor{keyword}{typename}... Args>}
\DoxyCodeLine{54   \textcolor{keyword}{requires}(}
\DoxyCodeLine{55       not std::is\_same\_v<std::remove\_cvref\_t<std::tuple\_element\_t<0, std::tuple<Args...>>>, \mbox{\hyperlink{a01316}{EnhancedAssumedStrains}}>)}
\DoxyCodeLine{56   \textcolor{keyword}{explicit} \mbox{\hyperlink{a01316_aea3c27cdfb45456acdc300b2bce56dce}{EnhancedAssumedStrains}}(Args\&\&... args)}
\DoxyCodeLine{57       : \mbox{\hyperlink{a01316_aa4d918d0864a183347834f9861174790}{DisplacementBasedElement}}(std::forward<Args>(args)...) \{\}}
\DoxyCodeLine{58 }
\DoxyCodeLine{67   \textcolor{keywordtype}{double} \mbox{\hyperlink{a01316_a1a7e1d6360c959bd4d8262a930cd7b0b}{calculateScalar}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01316_a97269308bd2801507db2e6a94dbb2af6}{FERequirementType}}\& par)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{68     \textcolor{keywordflow}{if} (\mbox{\hyperlink{a01316_ac3916915d1d0e5b9bc89468acb9faed2}{isDisplacementBased}}())}
\DoxyCodeLine{69       \textcolor{keywordflow}{return} DisplacementBasedElement::calculateScalar(par);}
\DoxyCodeLine{70     DUNE\_THROW(Dune::NotImplemented,}
\DoxyCodeLine{71                \textcolor{stringliteral}{"{}EAS element do not support any scalar calculations, i.e. they are not derivable from a potential"{}});}
\DoxyCodeLine{72   \}}
\DoxyCodeLine{73 }
\DoxyCodeLine{79   \textcolor{keywordtype}{bool} \mbox{\hyperlink{a01316_ac3916915d1d0e5b9bc89468acb9faed2}{isDisplacementBased}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} easVariant\_.isDisplacmentBased(); \}}
\DoxyCodeLine{80 }
\DoxyCodeLine{89   \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \mbox{\hyperlink{a01316_ab6b14cef4929414a0b054799e83b0a32}{calculateVector}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01316_a97269308bd2801507db2e6a94dbb2af6}{FERequirementType}}\& par, \textcolor{keyword}{typename} Traits::template VectorType<> force)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{90     calculateVectorImpl<double>(par, force);}
\DoxyCodeLine{91   \}}
\DoxyCodeLine{92 }
\DoxyCodeLine{98   \textcolor{keyword}{const} \textcolor{keyword}{auto}\& \mbox{\hyperlink{a01316_a6c74ad9c1f3de43daf4253232969f324}{easVariant}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} easVariant\_; \}}
\DoxyCodeLine{99 }
\DoxyCodeLine{105   \textcolor{keyword}{auto} \mbox{\hyperlink{a01316_a7e84eeac980c53200988ded58cbbe273}{numberOfEASParameters}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} easVariant\_.numberOfEASParameters(); \}}
\DoxyCodeLine{106 }
\DoxyCodeLine{115   \textcolor{keywordtype}{void} \mbox{\hyperlink{a01316_a710d6492af5902d5cc4a3e4481372898}{calculateMatrix}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01316_a97269308bd2801507db2e6a94dbb2af6}{FERequirementType}}\& par, \textcolor{keyword}{typename} Traits::template MatrixType<> K)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{116     \textcolor{keyword}{using namespace }Dune::DerivativeDirections;}
\DoxyCodeLine{117     \textcolor{keyword}{using namespace }\mbox{\hyperlink{a00345}{Dune}};}
\DoxyCodeLine{118 }
\DoxyCodeLine{122     DisplacementBasedElement::calculateMatrix(par, K);}
\DoxyCodeLine{123 }
\DoxyCodeLine{124     \textcolor{keyword}{auto} calculateMatrixContribution = [\&]<\textcolor{keyword}{typename} EAST>(\textcolor{keyword}{const} EAST\& easFunction) \{}
\DoxyCodeLine{125       \textcolor{keyword}{typename} EAST::DType D;}
\DoxyCodeLine{126       calculateDAndLMatrix(easFunction, par, D, L\_);}
\DoxyCodeLine{127 }
\DoxyCodeLine{128       K.template triangularView<Eigen::Upper>() -\/= L\_.transpose() * D.inverse() * L\_;}
\DoxyCodeLine{129       K.template triangularView<Eigen::StrictlyLower>() = K.transpose();}
\DoxyCodeLine{130     \};}
\DoxyCodeLine{131     easVariant\_(calculateMatrixContribution);}
\DoxyCodeLine{132   \}}
\DoxyCodeLine{133 }
\DoxyCodeLine{148   \textcolor{keyword}{template} <\textcolor{keyword}{template} <\textcolor{keyword}{typename}, \textcolor{keywordtype}{int}, \textcolor{keywordtype}{int}> \textcolor{keyword}{class }RT>}
\DoxyCodeLine{149   \textcolor{keyword}{requires}(DisplacementBasedElement::template canProvideResultType<RT>())}
\DoxyCodeLine{150   \textcolor{keyword}{auto} \mbox{\hyperlink{a01316_aeff4b36be356367ddec227258bee24ca}{calculateAt}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01316_a97269308bd2801507db2e6a94dbb2af6}{FERequirementType}}\& req, \textcolor{keyword}{const} \mbox{\hyperlink{a01520}{Dune::FieldVector<double, Traits::mydim>}}\& local) \textcolor{keyword}{const} \{}
\DoxyCodeLine{151     \textcolor{keywordflow}{if} (\mbox{\hyperlink{a01316_ac3916915d1d0e5b9bc89468acb9faed2}{isDisplacementBased}}())}
\DoxyCodeLine{152       \textcolor{keywordflow}{return} DisplacementBasedElement::template calculateAt<RT>(req, local);}
\DoxyCodeLine{153 }
\DoxyCodeLine{154     \textcolor{keyword}{using namespace }Dune::Indices;}
\DoxyCodeLine{155     \textcolor{keyword}{using namespace }Dune::DerivativeDirections;}
\DoxyCodeLine{156 }
\DoxyCodeLine{157     \textcolor{keyword}{using }RTWrapper = \mbox{\hyperlink{a01276}{ResultWrapper<RT<typename Traits::ctype, Traits::mydim, Traits::worlddim>}}, \mbox{\hyperlink{a00328_acfb09bb7db104db62d3d1d2dc3e009b2a57dea6f5039281b7fee517fc43bf3110}{ResultShape::Vector}}>;}
\DoxyCodeLine{158     RTWrapper resultWrapper\{\};}
\DoxyCodeLine{159 }
\DoxyCodeLine{160     \textcolor{keywordflow}{if} \textcolor{keyword}{constexpr} (isSameResultType<RT, ResultType::linearStress>) \{}
\DoxyCodeLine{161       \textcolor{keyword}{const} \textcolor{keyword}{auto} C              = DisplacementBasedElement::materialTangentFunction(req);}
\DoxyCodeLine{162       \textcolor{keyword}{const} \textcolor{keyword}{auto}\& numberOfNodes = DisplacementBasedElement::numberOfNodes();}
\DoxyCodeLine{163       \textcolor{keyword}{auto} uFunction            = DisplacementBasedElement::displacementFunction(req);}
\DoxyCodeLine{164 }
\DoxyCodeLine{165       \textcolor{keyword}{auto} calculateAtContribution = [\&]<\textcolor{keyword}{typename} EAST>(\textcolor{keyword}{const} EAST\& easFunction) \{}
\DoxyCodeLine{166         \textcolor{keyword}{typename} EAST::DType D;}
\DoxyCodeLine{167         calculateDAndLMatrix(easFunction, req, D, L\_);}
\DoxyCodeLine{168 }
\DoxyCodeLine{169         \textcolor{keyword}{const} \textcolor{keyword}{auto} disp  = \mbox{\hyperlink{a00323_ga545d74839895f4576a3b8c97d72abefd}{Dune::viewAsFlatEigenVector}}(uFunction.coefficientsRef());}
\DoxyCodeLine{170         \textcolor{keyword}{const} \textcolor{keyword}{auto} alpha = (-\/D.inverse() * L\_ * disp).eval();}
\DoxyCodeLine{171         \textcolor{keyword}{const} \textcolor{keyword}{auto} M     = easFunction.calcM(local);}
\DoxyCodeLine{172         \textcolor{keyword}{const} \textcolor{keyword}{auto} CEval = C(local);}
\DoxyCodeLine{173         \textcolor{keyword}{auto} easStress   = (CEval * M * alpha).eval();}
\DoxyCodeLine{174         resultWrapper = RTWrapper\{DisplacementBasedElement::template calculateAt<RT>(req, local).asVec() + easStress\};}
\DoxyCodeLine{175       \};}
\DoxyCodeLine{176       easVariant\_(calculateAtContribution);}
\DoxyCodeLine{177       \textcolor{keywordflow}{return} resultWrapper;}
\DoxyCodeLine{178     \}}
\DoxyCodeLine{179   \}}
\DoxyCodeLine{180 }
\DoxyCodeLine{186   \textcolor{keywordtype}{void} \mbox{\hyperlink{a01316_adfe962d09df6de05e8a8a3e875ba046c}{setEASType}}(\textcolor{keywordtype}{int} \mbox{\hyperlink{a01316_a7e84eeac980c53200988ded58cbbe273}{numberOfEASParameters}}) \{}
\DoxyCodeLine{187     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& numberOfNodes = DisplacementBasedElement::numberOfNodes();}
\DoxyCodeLine{188     \textcolor{keywordflow}{if} (not((numberOfNodes == 4 and Traits::mydim == 2) or (numberOfNodes == 8 and Traits::mydim == 3)) and}
\DoxyCodeLine{189         (not \mbox{\hyperlink{a01316_ac3916915d1d0e5b9bc89468acb9faed2}{isDisplacementBased}}()))}
\DoxyCodeLine{190       DUNE\_THROW(Dune::NotImplemented, \textcolor{stringliteral}{"{}EAS only supported for Q1 or H1 elements"{}});}
\DoxyCodeLine{191     easVariant\_.setEASType(\mbox{\hyperlink{a01316_a7e84eeac980c53200988ded58cbbe273}{numberOfEASParameters}}, localView().element().geometry());}
\DoxyCodeLine{192   \}}
\DoxyCodeLine{193 }
\DoxyCodeLine{194 \textcolor{keyword}{protected}:}
\DoxyCodeLine{195   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ScalarType>}
\DoxyCodeLine{196   \textcolor{keyword}{inline} ScalarType \mbox{\hyperlink{a01316_a0ec23706e5aeda1d9d8ed1a952d57027}{calculateScalarImpl}}(}
\DoxyCodeLine{197       \textcolor{keyword}{const} \mbox{\hyperlink{a01316_a97269308bd2801507db2e6a94dbb2af6}{FERequirementType}}\& par, \textcolor{keyword}{const} std::optional<\textcolor{keyword}{const} Eigen::VectorX<ScalarType>>\& dx = std::nullopt)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{198     \textcolor{keywordflow}{if} (\mbox{\hyperlink{a01316_ac3916915d1d0e5b9bc89468acb9faed2}{isDisplacementBased}}())}
\DoxyCodeLine{199       \textcolor{keywordflow}{return} DisplacementBasedElement::template calculateScalarImpl<ScalarType>(par, dx);}
\DoxyCodeLine{200     DUNE\_THROW(Dune::NotImplemented,}
\DoxyCodeLine{201                \textcolor{stringliteral}{"{}EAS element do not support any scalar calculations, i.e. they are not derivable from a potential"{}});}
\DoxyCodeLine{202   \}}
\DoxyCodeLine{203 }
\DoxyCodeLine{204   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ScalarType>}
\DoxyCodeLine{205   \textcolor{keywordtype}{void} \mbox{\hyperlink{a01316_a24d232578192661667e78c555dc5b7b3}{calculateVectorImpl}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01316_a97269308bd2801507db2e6a94dbb2af6}{FERequirementType}}\& par, \textcolor{keyword}{typename} Traits::template VectorType<ScalarType> force,}
\DoxyCodeLine{206                            \textcolor{keyword}{const} std::optional<\textcolor{keyword}{const} Eigen::VectorX<ScalarType>>\& dx = std::nullopt)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{207     \textcolor{keyword}{using namespace }\mbox{\hyperlink{a00345}{Dune}};}
\DoxyCodeLine{208     \textcolor{keyword}{using namespace }Dune::DerivativeDirections;}
\DoxyCodeLine{209 }
\DoxyCodeLine{210     DisplacementBasedElement::calculateVectorImpl(par, force, dx);}
\DoxyCodeLine{211 }
\DoxyCodeLine{212     \textcolor{keyword}{const} \textcolor{keyword}{auto} uFunction      = DisplacementBasedElement::displacementFunction(par, dx);}
\DoxyCodeLine{213     \textcolor{keyword}{auto} strainFunction       = DisplacementBasedElement::strainFunction(par, dx);}
\DoxyCodeLine{214     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& numberOfNodes = DisplacementBasedElement::numberOfNodes();}
\DoxyCodeLine{215 }
\DoxyCodeLine{216     \textcolor{keyword}{auto} C = DisplacementBasedElement::materialTangentFunction(par);}
\DoxyCodeLine{217 }
\DoxyCodeLine{218     \textcolor{keyword}{auto} calculateForceContribution = [\&]<\textcolor{keyword}{typename} EAST>(\textcolor{keyword}{const} EAST\& easFunction) \{}
\DoxyCodeLine{219       \textcolor{keyword}{typename} EAST::DType D;}
\DoxyCodeLine{220       calculateDAndLMatrix(easFunction, par, D, L\_);}
\DoxyCodeLine{221 }
\DoxyCodeLine{222       \textcolor{keyword}{const} \textcolor{keyword}{auto} disp  = \mbox{\hyperlink{a00323_ga545d74839895f4576a3b8c97d72abefd}{Dune::viewAsFlatEigenVector}}(uFunction.coefficientsRef());}
\DoxyCodeLine{223       \textcolor{keyword}{const} \textcolor{keyword}{auto} alpha = (-\/D.inverse() * L\_ * disp).eval();}
\DoxyCodeLine{224       \textcolor{keyword}{const} \textcolor{keyword}{auto} geo   = localView().element().geometry();}
\DoxyCodeLine{225 }
\DoxyCodeLine{226       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}\& [gpIndex, gp] : strainFunction.viewOverIntegrationPoints()) \{}
\DoxyCodeLine{227         \textcolor{keyword}{const} \textcolor{keyword}{auto} M            = easFunction.calcM(gp.position());}
\DoxyCodeLine{228         \textcolor{keyword}{const} \textcolor{keywordtype}{double} intElement = geo.integrationElement(gp.position()) * gp.weight();}
\DoxyCodeLine{229         \textcolor{keyword}{const} \textcolor{keyword}{auto} CEval        = C(gpIndex);}
\DoxyCodeLine{230         \textcolor{keyword}{auto} stresses           = (CEval * M * alpha).eval();}
\DoxyCodeLine{231         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < numberOfNodes; ++i) \{}
\DoxyCodeLine{232           \textcolor{keyword}{const} \textcolor{keyword}{auto} bopI = strainFunction.evaluateDerivative(gpIndex, wrt(coeff(i)), on(gridElement));}
\DoxyCodeLine{233           force.template segment<Traits::worlddim>(Traits::worlddim * i) += bopI.transpose() * stresses * intElement;}
\DoxyCodeLine{234         \}}
\DoxyCodeLine{235       \}}
\DoxyCodeLine{236     \};}
\DoxyCodeLine{237     easVariant\_(calculateForceContribution);}
\DoxyCodeLine{238   \}}
\DoxyCodeLine{239 }
\DoxyCodeLine{240 \textcolor{keyword}{private}:}
\DoxyCodeLine{241   \mbox{\hyperlink{a01312}{EAS::EASVariant<Geometry>}} easVariant\_;}
\DoxyCodeLine{242   \textcolor{keyword}{mutable} Eigen::MatrixXd L\_;}
\DoxyCodeLine{243 }
\DoxyCodeLine{244   \textcolor{keyword}{template} <\textcolor{keywordtype}{int} enhancedStrainSize>}
\DoxyCodeLine{245   \textcolor{keywordtype}{void} calculateDAndLMatrix(\textcolor{keyword}{const} \textcolor{keyword}{auto}\& easFunction, \textcolor{keyword}{const} \textcolor{keyword}{auto}\& par,}
\DoxyCodeLine{246                             Eigen::Matrix<double, enhancedStrainSize, enhancedStrainSize>\& DMat,}
\DoxyCodeLine{247                             Eigen::MatrixXd\& LMat)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{248     \textcolor{keyword}{using namespace }\mbox{\hyperlink{a00345}{Dune}};}
\DoxyCodeLine{249     \textcolor{keyword}{using namespace }Dune::DerivativeDirections;}
\DoxyCodeLine{250 }
\DoxyCodeLine{251     \textcolor{keyword}{auto} strainFunction      = DisplacementBasedElement::strainFunction(par);}
\DoxyCodeLine{252     \textcolor{keyword}{const} \textcolor{keyword}{auto} C             = DisplacementBasedElement::materialTangentFunction(par);}
\DoxyCodeLine{253     \textcolor{keyword}{const} \textcolor{keyword}{auto} geo           = localView().element().geometry();}
\DoxyCodeLine{254     \textcolor{keyword}{const} \textcolor{keyword}{auto} numberOfNodes = DisplacementBasedElement::numberOfNodes();}
\DoxyCodeLine{255     DMat.setZero();}
\DoxyCodeLine{256     LMat.setZero(enhancedStrainSize, localView().size());}
\DoxyCodeLine{257     \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}\& [gpIndex, gp] : strainFunction.viewOverIntegrationPoints()) \{}
\DoxyCodeLine{258       \textcolor{keyword}{const} \textcolor{keyword}{auto} M      = easFunction.calcM(gp.position());}
\DoxyCodeLine{259       \textcolor{keyword}{const} \textcolor{keyword}{auto} CEval  = C(gpIndex);}
\DoxyCodeLine{260       \textcolor{keyword}{const} \textcolor{keywordtype}{double} detJ = geo.integrationElement(gp.position());}
\DoxyCodeLine{261       DMat += M.transpose() * CEval * M * detJ * gp.weight();}
\DoxyCodeLine{262       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0U; i < numberOfNodes; ++i) \{}
\DoxyCodeLine{263         \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} I = Traits::worlddim * i;}
\DoxyCodeLine{264         \textcolor{keyword}{const} \textcolor{keyword}{auto} Bi  = strainFunction.evaluateDerivative(gpIndex, wrt(coeff(i)), on(gridElement));}
\DoxyCodeLine{265         LMat.template block<enhancedStrainSize, Traits::worlddim>(0, I) +=}
\DoxyCodeLine{266             M.transpose() * CEval * Bi * detJ * gp.weight();}
\DoxyCodeLine{267       \}}
\DoxyCodeLine{268     \}}
\DoxyCodeLine{269   \}}
\DoxyCodeLine{270 \};}
\DoxyCodeLine{271 \} \textcolor{comment}{// namespace Ikarus}}
\DoxyCodeLine{272 }
\DoxyCodeLine{273 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{274 \textcolor{preprocessor}{  \#error EnhancedAssumedStrains depends on dune-\/localfefunctions, which is not included}}
\DoxyCodeLine{275 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
