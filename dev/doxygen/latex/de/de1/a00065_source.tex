\hypertarget{a00065_source}{}\doxysection{simpleassemblers.\+hh}
\label{a00065_source}\index{simpleassemblers.hh@{simpleassemblers.hh}}
\mbox{\hyperlink{a00065}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// SPDX-\/FileCopyrightText: 2021-\/2024 The Ikarus Developers mueller@ibb.uni-\/stuttgart.de}}
\DoxyCodeLine{2 \textcolor{comment}{// SPDX-\/License-\/Identifier: LGPL-\/3.0-\/or-\/later}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include <mutex>}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include <ranges>}}
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include <utility>}}
\DoxyCodeLine{8 }
\DoxyCodeLine{9 \textcolor{preprocessor}{\#include <dune/common/math.hh>}}
\DoxyCodeLine{10 \textcolor{preprocessor}{\#include <dune/functions/backends/istlvectorbackend.hh>}}
\DoxyCodeLine{11 }
\DoxyCodeLine{12 \textcolor{preprocessor}{\#include <Eigen/Core>}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include <Eigen/Dense>}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include <Eigen/Sparse>}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a02456}{ikarus/linearalgebra/dirichletvalues.hh}}>}}
\DoxyCodeLine{17 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00101}{ikarus/utils/concepts.hh}}>}}
\DoxyCodeLine{18 }
\DoxyCodeLine{19 \textcolor{keyword}{namespace }\mbox{\hyperlink{a00219}{Ikarus}} \{}
\DoxyCodeLine{20 }
\DoxyCodeLine{24   \textcolor{keyword}{template} <\textcolor{keyword}{typename} FEContainer\_, \textcolor{keyword}{typename} DirichletValuesType\_>}
\DoxyCodeLine{25   \textcolor{keyword}{class }\mbox{\hyperlink{a01057}{FlatAssemblerBase}} \{}
\DoxyCodeLine{26   \textcolor{keyword}{public}:}
\DoxyCodeLine{27     \textcolor{keyword}{using }\mbox{\hyperlink{a01057_a8d033b14de49e508c7edfd5f8c37ca83}{FEContainerRaw}}    = std::remove\_cvref\_t<FEContainer\_>;}
\DoxyCodeLine{28     \textcolor{keyword}{using }\mbox{\hyperlink{a01057_aba7339d4e117f0f310c8ba9cd6da1e5a}{FERequirementType}} = \textcolor{keyword}{typename} FEContainerRaw::value\_type::FERequirementType;}
\DoxyCodeLine{29     \textcolor{keyword}{using }\mbox{\hyperlink{a01057_a1b2ccee915a297c90f3865c71f2c3c14}{GlobalIndex}}       = \textcolor{keyword}{typename} FEContainerRaw::value\_type::GlobalIndex;}
\DoxyCodeLine{30     \textcolor{keyword}{using }\mbox{\hyperlink{a01057_aec6afbe8af2828aa945ab2b8f2c1aca6}{Basis}}             = \textcolor{keyword}{typename} DirichletValuesType\_::Basis;}
\DoxyCodeLine{31     \textcolor{keyword}{using }\mbox{\hyperlink{a01057_a0c71856323f0e835ec785987c0aada18}{GridView}}          = \textcolor{keyword}{typename} \mbox{\hyperlink{a01333_a066e94e24a8000ee0f47fff24c5c09b4}{Basis::GridView}};}
\DoxyCodeLine{32     \textcolor{keyword}{using }\mbox{\hyperlink{a01057_a030d83efead739f9abcb338d8f1d06b4}{FEContainer}}       = FEContainer\_;}
\DoxyCodeLine{33     \textcolor{comment}{// If we get a reference we store the reference but if we get an r-\/value we store by value}}
\DoxyCodeLine{34     \textcolor{keyword}{using }\mbox{\hyperlink{a01057_a554c8df2e30ed6ec250e5395f77d8f6f}{FEContainerType}}     = std::conditional\_t<std::is\_reference\_v<FEContainer>, \textcolor{keyword}{const} \mbox{\hyperlink{a01057_a030d83efead739f9abcb338d8f1d06b4}{FEContainer}}, \mbox{\hyperlink{a01057_a030d83efead739f9abcb338d8f1d06b4}{FEContainer}}>;}
\DoxyCodeLine{35     \textcolor{keyword}{using }\mbox{\hyperlink{a01057_ab0275407303cf74b78fe44f0ad405e06}{DirichletValuesType}} = DirichletValuesType\_;}
\DoxyCodeLine{36     \mbox{\hyperlink{a01057_aaa76896f0fdb0e6a116bb7790dbaceb1}{FlatAssemblerBase}}(\mbox{\hyperlink{a01057_a030d83efead739f9abcb338d8f1d06b4}{FEContainer}} \&\&fes, \textcolor{keyword}{const} \mbox{\hyperlink{a01057_ab0275407303cf74b78fe44f0ad405e06}{DirichletValuesType}} \&p\_dirichletValues)}
\DoxyCodeLine{37         : feContainer\{std::forward<\mbox{\hyperlink{a01057_a030d83efead739f9abcb338d8f1d06b4}{FEContainer}}>(fes)\}, dirichletValues\{\&p\_dirichletValues\} \{}
\DoxyCodeLine{38       constraintsBelow\_.reserve(dirichletValues-\/>size());}
\DoxyCodeLine{39       \textcolor{keywordtype}{size\_t} counter = 0;}
\DoxyCodeLine{40       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} iv : std::ranges::iota\_view\{\textcolor{keyword}{decltype}(dirichletValues-\/>size())(0), dirichletValues-\/>size()\}) \{}
\DoxyCodeLine{41         constraintsBelow\_.emplace\_back(counter);}
\DoxyCodeLine{42         \textcolor{keywordflow}{if} (dirichletValues-\/>isConstrained(iv)) ++counter;}
\DoxyCodeLine{43       \}}
\DoxyCodeLine{44       fixedDofs = dirichletValues-\/>fixedDOFsize();}
\DoxyCodeLine{45     \}}
\DoxyCodeLine{46 }
\DoxyCodeLine{48     \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{a01057_a8fd0336be5b5e2d0bcbcdb25bacc5f2f}{reducedSize}}() \{ \textcolor{keywordflow}{return} dirichletValues-\/>size() -\/ fixedDofs; \}}
\DoxyCodeLine{49 }
\DoxyCodeLine{51     \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{a01057_ac105af5d51473a274f597d509308c55f}{size}}() \{ \textcolor{keywordflow}{return} dirichletValues-\/>size(); \}}
\DoxyCodeLine{52 }
\DoxyCodeLine{56     Eigen::VectorXd \mbox{\hyperlink{a01057_a03f97ed023cb3e704edfe556408e6167}{createFullVector}}(Eigen::Ref<const Eigen::VectorXd> reducedVector);}
\DoxyCodeLine{57 }
\DoxyCodeLine{59     \textcolor{keyword}{auto} \&\mbox{\hyperlink{a01057_aa92c131a0915eb5864613bdbab5c4990}{finiteElements}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} feContainer; \}}
\DoxyCodeLine{60 }
\DoxyCodeLine{62     [[nodiscard]] \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{a01057_a85a20ef2dd30a677994a9c79677cfdf2}{constraintsBelow}}(\textcolor{keywordtype}{size\_t} i)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} constraintsBelow\_[i]; \}}
\DoxyCodeLine{63 }
\DoxyCodeLine{65     [[nodiscard]] \textcolor{keywordtype}{bool} \mbox{\hyperlink{a01057_a317a691c0aca9e9d5953845762c7f626}{isConstrained}}(\textcolor{keywordtype}{size\_t} i)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} dirichletValues-\/>isConstrained(i); \}}
\DoxyCodeLine{66 }
\DoxyCodeLine{70     [[nodiscard]] \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{a01057_a6179ef97228c75448f8d109f031bc667}{estimateOfConnectivity}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{71       \textcolor{keywordflow}{return} dirichletValues-\/>basis().gridView().size(GridView::dimension) * 8;}
\DoxyCodeLine{72     \}}
\DoxyCodeLine{73 }
\DoxyCodeLine{74   \textcolor{keyword}{private}:}
\DoxyCodeLine{75     \mbox{\hyperlink{a01057_a554c8df2e30ed6ec250e5395f77d8f6f}{FEContainerType}} feContainer;}
\DoxyCodeLine{76     \mbox{\hyperlink{a01057_ab0275407303cf74b78fe44f0ad405e06}{DirichletValuesType}} \textcolor{keyword}{const} *dirichletValues;}
\DoxyCodeLine{77     std::vector<size\_t> constraintsBelow\_\{\};}
\DoxyCodeLine{78     \textcolor{keywordtype}{size\_t} fixedDofs\{\};}
\DoxyCodeLine{79   \};}
\DoxyCodeLine{80 }
\DoxyCodeLine{81   \textcolor{keyword}{template} <\textcolor{keyword}{class} T, \textcolor{keyword}{class} DirichletValuesType>}
\DoxyCodeLine{82   \mbox{\hyperlink{a00219_aae746d345e1205875e56c9ab61d6d9b1}{FlatAssemblerBase}}(T \&\&fes, \textcolor{keyword}{const} DirichletValuesType \&dirichletValues\_) -\/> \mbox{\hyperlink{a01057}{FlatAssemblerBase<T, DirichletValuesType>}};}
\DoxyCodeLine{83 }
\DoxyCodeLine{85   \textcolor{keyword}{template} <\textcolor{keyword}{typename} FEContainer\_, \textcolor{keyword}{typename} DirichletValuesType\_>}
\DoxyCodeLine{86   \textcolor{keyword}{class }\mbox{\hyperlink{a01061}{ScalarAssembler}} : \textcolor{keyword}{public} \mbox{\hyperlink{a01057}{FlatAssemblerBase}}<FEContainer\_, DirichletValuesType\_> \{}
\DoxyCodeLine{87     \textcolor{keyword}{using }\mbox{\hyperlink{a01057_a8d033b14de49e508c7edfd5f8c37ca83}{FEContainerRaw}} = std::remove\_cvref\_t<FEContainer\_>;}
\DoxyCodeLine{88 }
\DoxyCodeLine{89     \textcolor{keyword}{using }\mbox{\hyperlink{a01057_aba7339d4e117f0f310c8ba9cd6da1e5a}{FERequirementType}}   = \textcolor{keyword}{typename} FEContainerRaw::value\_type::FERequirementType;}
\DoxyCodeLine{90     \textcolor{keyword}{using }\mbox{\hyperlink{a01057_a1b2ccee915a297c90f3865c71f2c3c14}{GlobalIndex}}         = \textcolor{keyword}{typename} FEContainerRaw::value\_type::GlobalIndex;}
\DoxyCodeLine{91     \textcolor{keyword}{using }\mbox{\hyperlink{a01057_aec6afbe8af2828aa945ab2b8f2c1aca6}{Basis}}               = \textcolor{keyword}{typename} DirichletValuesType\_::Basis;}
\DoxyCodeLine{92     \textcolor{keyword}{using }\mbox{\hyperlink{a01057_a030d83efead739f9abcb338d8f1d06b4}{FEContainer}}         = FEContainer\_;}
\DoxyCodeLine{93     \textcolor{keyword}{using }\mbox{\hyperlink{a01057_ab0275407303cf74b78fe44f0ad405e06}{DirichletValuesType}} = DirichletValuesType\_;}
\DoxyCodeLine{94 }
\DoxyCodeLine{95   \textcolor{keyword}{public}:}
\DoxyCodeLine{96     \mbox{\hyperlink{a01061_a7fa7751093b40062b2250205cb1b27b2}{ScalarAssembler}}(\mbox{\hyperlink{a01057_a030d83efead739f9abcb338d8f1d06b4}{FEContainer}} \&\&fes, \textcolor{keyword}{const} \mbox{\hyperlink{a01057_ab0275407303cf74b78fe44f0ad405e06}{DirichletValuesType}} \&dirichletValues\_)}
\DoxyCodeLine{97         : \mbox{\hyperlink{a01057}{FlatAssemblerBase}}<\mbox{\hyperlink{a01057_a030d83efead739f9abcb338d8f1d06b4}{FEContainer}}, \mbox{\hyperlink{a01057_ab0275407303cf74b78fe44f0ad405e06}{DirichletValuesType}}>(std::forward<\mbox{\hyperlink{a01057_a030d83efead739f9abcb338d8f1d06b4}{FEContainer}}>(fes), dirichletValues\_) \{\}}
\DoxyCodeLine{98 }
\DoxyCodeLine{100     \textcolor{keywordtype}{double} \&\mbox{\hyperlink{a01061_aa902bc1afe643ae6f9c9b38e6a7b5897}{getScalar}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01057_aba7339d4e117f0f310c8ba9cd6da1e5a}{FERequirementType}} \&feRequirements) \{ \textcolor{keywordflow}{return} getScalarImpl(feRequirements); \}}
\DoxyCodeLine{101 }
\DoxyCodeLine{102   \textcolor{keyword}{private}:}
\DoxyCodeLine{103     \textcolor{keywordtype}{double} \&getScalarImpl(\textcolor{keyword}{const} FERequirementType \&feRequirements) \{}
\DoxyCodeLine{104       scal = 0.0;}
\DoxyCodeLine{105       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&fe : this-\/>\mbox{\hyperlink{a01057_aa92c131a0915eb5864613bdbab5c4990}{finiteElements}}()) \{}
\DoxyCodeLine{106         scal += fe.calculateScalar(feRequirements);}
\DoxyCodeLine{107       \}}
\DoxyCodeLine{108       \textcolor{keywordflow}{return} scal;}
\DoxyCodeLine{109     \}}
\DoxyCodeLine{110 }
\DoxyCodeLine{111     \textcolor{keywordtype}{double} scal\{0.0\};}
\DoxyCodeLine{112   \};}
\DoxyCodeLine{113 }
\DoxyCodeLine{114   \textcolor{keyword}{template} <\textcolor{keyword}{class} T, \textcolor{keyword}{class} DirichletValuesType>}
\DoxyCodeLine{115   \mbox{\hyperlink{a00219_aaf9f4c23b4cf17ef0fcd179c23fe8b76}{ScalarAssembler}}(T \&\&fes, \textcolor{keyword}{const} DirichletValuesType \&dirichletValues\_) -\/> \mbox{\hyperlink{a01061}{ScalarAssembler<T, DirichletValuesType>}};}
\DoxyCodeLine{116 }
\DoxyCodeLine{118   \textcolor{keyword}{template} <\textcolor{keyword}{typename} FEContainer\_, \textcolor{keyword}{typename} DirichletValuesType\_>}
\DoxyCodeLine{119   \textcolor{keyword}{class }\mbox{\hyperlink{a01065}{VectorFlatAssembler}} : \textcolor{keyword}{public} \mbox{\hyperlink{a01061}{ScalarAssembler}}<FEContainer\_, DirichletValuesType\_> \{}
\DoxyCodeLine{120     \textcolor{keyword}{using }\mbox{\hyperlink{a01057_a8d033b14de49e508c7edfd5f8c37ca83}{FEContainerRaw}} = std::remove\_cvref\_t<FEContainer\_>;}
\DoxyCodeLine{121 }
\DoxyCodeLine{122     \textcolor{keyword}{using }\mbox{\hyperlink{a01057_aba7339d4e117f0f310c8ba9cd6da1e5a}{FERequirementType}}   = \textcolor{keyword}{typename} FEContainerRaw::value\_type::FERequirementType;}
\DoxyCodeLine{123     \textcolor{keyword}{using }\mbox{\hyperlink{a01057_a1b2ccee915a297c90f3865c71f2c3c14}{GlobalIndex}}         = \textcolor{keyword}{typename} FEContainerRaw::value\_type::GlobalIndex;}
\DoxyCodeLine{124     \textcolor{keyword}{using }\mbox{\hyperlink{a01057_aec6afbe8af2828aa945ab2b8f2c1aca6}{Basis}}               = \textcolor{keyword}{typename} DirichletValuesType\_::Basis;}
\DoxyCodeLine{125     \textcolor{keyword}{using }\mbox{\hyperlink{a01057_a030d83efead739f9abcb338d8f1d06b4}{FEContainer}}         = FEContainer\_;}
\DoxyCodeLine{126     \textcolor{keyword}{using }\mbox{\hyperlink{a01057_ab0275407303cf74b78fe44f0ad405e06}{DirichletValuesType}} = DirichletValuesType\_;}
\DoxyCodeLine{127 }
\DoxyCodeLine{128   \textcolor{keyword}{public}:}
\DoxyCodeLine{129     \mbox{\hyperlink{a01065_ab29654e07434ec261e3f2b449eb36a8c}{VectorFlatAssembler}}(\mbox{\hyperlink{a01057_a030d83efead739f9abcb338d8f1d06b4}{FEContainer}} \&\&fes, \textcolor{keyword}{const} \mbox{\hyperlink{a01057_ab0275407303cf74b78fe44f0ad405e06}{DirichletValuesType}} \&dirichletValues\_)}
\DoxyCodeLine{130         : \mbox{\hyperlink{a01061}{ScalarAssembler}}<\mbox{\hyperlink{a01057_a030d83efead739f9abcb338d8f1d06b4}{FEContainer}}, \mbox{\hyperlink{a01057_ab0275407303cf74b78fe44f0ad405e06}{DirichletValuesType}}>(std::forward<\mbox{\hyperlink{a01057_a030d83efead739f9abcb338d8f1d06b4}{FEContainer}}>(fes), dirichletValues\_) \{\}}
\DoxyCodeLine{131 }
\DoxyCodeLine{133     Eigen::VectorXd \&\mbox{\hyperlink{a01065_a1904b244fe6fa606c489b7969fbf12c8}{getRawVector}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01057_aba7339d4e117f0f310c8ba9cd6da1e5a}{FERequirementType}} \&feRequirements) \{ \textcolor{keywordflow}{return} getRawVectorImpl(feRequirements); \}}
\DoxyCodeLine{134 }
\DoxyCodeLine{137     Eigen::VectorXd \&\mbox{\hyperlink{a01065_a10b6154f85148a2d12a1ba5fc5ecae86}{getVector}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01057_aba7339d4e117f0f310c8ba9cd6da1e5a}{FERequirementType}} \&feRequirements) \{ \textcolor{keywordflow}{return} getVectorImpl(feRequirements); \}}
\DoxyCodeLine{138 }
\DoxyCodeLine{141     Eigen::VectorXd \&\mbox{\hyperlink{a01065_a9c9b52a7afc7dac62127ab3b33b4fa13}{getReducedVector}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01057_aba7339d4e117f0f310c8ba9cd6da1e5a}{FERequirementType}} \&feRequirements) \{}
\DoxyCodeLine{142       \textcolor{keywordflow}{return} getReducedVectorImpl(feRequirements);}
\DoxyCodeLine{143     \}}
\DoxyCodeLine{144 }
\DoxyCodeLine{145   \textcolor{keyword}{private}:}
\DoxyCodeLine{146     \textcolor{keywordtype}{void} assembleRawVectorImpl(\textcolor{keyword}{const} FERequirementType \&feRequirements, Eigen::VectorXd \&assemblyVec);}
\DoxyCodeLine{147     Eigen::VectorXd \&getRawVectorImpl(\textcolor{keyword}{const} FERequirementType \&feRequirements);}
\DoxyCodeLine{148     Eigen::VectorXd \&getVectorImpl(\textcolor{keyword}{const} FERequirementType \&feRequirements);}
\DoxyCodeLine{149     Eigen::VectorXd \&getReducedVectorImpl(\textcolor{keyword}{const} FERequirementType \&feRequirements);}
\DoxyCodeLine{150 }
\DoxyCodeLine{151     Eigen::VectorXd vecRaw\{\};}
\DoxyCodeLine{152     Eigen::VectorXd vec\{\};}
\DoxyCodeLine{153     Eigen::VectorXd vecRed\{\};}
\DoxyCodeLine{154   \};}
\DoxyCodeLine{155 }
\DoxyCodeLine{156   \textcolor{keyword}{template} <\textcolor{keyword}{class} T, \textcolor{keyword}{class} DirichletValuesType>}
\DoxyCodeLine{157   \mbox{\hyperlink{a00219_ae782c431726d82767ff3243dc287f34a}{VectorFlatAssembler}}(T \&\&fes, \textcolor{keyword}{const} DirichletValuesType \&dirichletValues\_)}
\DoxyCodeLine{158       -\/> \mbox{\hyperlink{a01065}{VectorFlatAssembler<T, DirichletValuesType>}};}
\DoxyCodeLine{159 }
\DoxyCodeLine{163   \textcolor{keyword}{template} <\textcolor{keyword}{typename} FEContainer\_, \textcolor{keyword}{typename} DirichletValuesType\_>}
\DoxyCodeLine{164   \textcolor{keyword}{class }\mbox{\hyperlink{a01069}{SparseFlatAssembler}} : \textcolor{keyword}{public} \mbox{\hyperlink{a01065}{VectorFlatAssembler}}<FEContainer\_, DirichletValuesType\_> \{}
\DoxyCodeLine{165   \textcolor{keyword}{public}:}
\DoxyCodeLine{166     \textcolor{keyword}{using }\mbox{\hyperlink{a01057_a8d033b14de49e508c7edfd5f8c37ca83}{FEContainerRaw}} = std::remove\_cvref\_t<FEContainer\_>;}
\DoxyCodeLine{167 }
\DoxyCodeLine{168     \textcolor{keyword}{using }\mbox{\hyperlink{a01057_aba7339d4e117f0f310c8ba9cd6da1e5a}{FERequirementType}}   = \textcolor{keyword}{typename} FEContainerRaw::value\_type::FERequirementType;}
\DoxyCodeLine{169     \textcolor{keyword}{using }\mbox{\hyperlink{a01057_a1b2ccee915a297c90f3865c71f2c3c14}{GlobalIndex}}         = \textcolor{keyword}{typename} FEContainerRaw::value\_type::GlobalIndex;}
\DoxyCodeLine{170     \textcolor{keyword}{using }\mbox{\hyperlink{a01057_aec6afbe8af2828aa945ab2b8f2c1aca6}{Basis}}               = \textcolor{keyword}{typename} DirichletValuesType\_::Basis;}
\DoxyCodeLine{171     \textcolor{keyword}{using }\mbox{\hyperlink{a01057_a030d83efead739f9abcb338d8f1d06b4}{FEContainer}}         = FEContainer\_;}
\DoxyCodeLine{172     \textcolor{keyword}{using }\mbox{\hyperlink{a01057_ab0275407303cf74b78fe44f0ad405e06}{DirichletValuesType}} = DirichletValuesType\_;}
\DoxyCodeLine{173 }
\DoxyCodeLine{174     \mbox{\hyperlink{a01069_a3015c0013b0a8773370353b1602b17b9}{SparseFlatAssembler}}(\mbox{\hyperlink{a01057_a030d83efead739f9abcb338d8f1d06b4}{FEContainer}} \&\&fes, \textcolor{keyword}{const} \mbox{\hyperlink{a01057_ab0275407303cf74b78fe44f0ad405e06}{DirichletValuesType}} \&dirichletValues\_)}
\DoxyCodeLine{175         : \mbox{\hyperlink{a01065}{VectorFlatAssembler}}<\mbox{\hyperlink{a01057_a030d83efead739f9abcb338d8f1d06b4}{FEContainer}}, \mbox{\hyperlink{a01057_ab0275407303cf74b78fe44f0ad405e06}{DirichletValuesType}}>(std::forward<\mbox{\hyperlink{a01057_a030d83efead739f9abcb338d8f1d06b4}{FEContainer}}>(fes), dirichletValues\_) \{\}}
\DoxyCodeLine{176 }
\DoxyCodeLine{177     \textcolor{keyword}{using }\mbox{\hyperlink{a01057_a0c71856323f0e835ec785987c0aada18}{GridView}} = \textcolor{keyword}{typename} \mbox{\hyperlink{a01333_a066e94e24a8000ee0f47fff24c5c09b4}{Basis::GridView}};}
\DoxyCodeLine{178 }
\DoxyCodeLine{180     Eigen::SparseMatrix<double> \&\mbox{\hyperlink{a01069_aa926cf1bab496cb58875a4891f6d0c59}{getRawMatrix}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01057_aba7339d4e117f0f310c8ba9cd6da1e5a}{FERequirementType}} \&feRequirements) \{}
\DoxyCodeLine{181       \textcolor{keywordflow}{return} getRawMatrixImpl(feRequirements);}
\DoxyCodeLine{182     \}}
\DoxyCodeLine{183 }
\DoxyCodeLine{186     Eigen::SparseMatrix<double> \&\mbox{\hyperlink{a01069_aa1a2c6dabeddd55027018b59d150c8a0}{getMatrix}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01057_aba7339d4e117f0f310c8ba9cd6da1e5a}{FERequirementType}} \&feRequirements) \{}
\DoxyCodeLine{187       \textcolor{keywordflow}{return} getMatrixImpl(feRequirements);}
\DoxyCodeLine{188     \}}
\DoxyCodeLine{189 }
\DoxyCodeLine{192     Eigen::SparseMatrix<double> \&\mbox{\hyperlink{a01069_a733314b660fe45a875c7e1655dc1b6da}{getReducedMatrix}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01057_aba7339d4e117f0f310c8ba9cd6da1e5a}{FERequirementType}} \&feRequirements) \{}
\DoxyCodeLine{193       \textcolor{keywordflow}{return} getReducedMatrixImpl(feRequirements);}
\DoxyCodeLine{194     \}}
\DoxyCodeLine{195 }
\DoxyCodeLine{196   \textcolor{keyword}{private}:}
\DoxyCodeLine{197     \textcolor{keywordtype}{void} assembleRawMatrixImpl(\textcolor{keyword}{const} \mbox{\hyperlink{a01069_acc6bac955dd0f718adc2fe24566fa5b2}{FERequirementType}} \&feRequirements, Eigen::SparseMatrix<double> \&assemblyMat);}
\DoxyCodeLine{198     Eigen::SparseMatrix<double> \&getRawMatrixImpl(\textcolor{keyword}{const} \mbox{\hyperlink{a01069_acc6bac955dd0f718adc2fe24566fa5b2}{FERequirementType}} \&feRequirements);}
\DoxyCodeLine{199     Eigen::SparseMatrix<double> \&getMatrixImpl(\textcolor{keyword}{const} \mbox{\hyperlink{a01069_acc6bac955dd0f718adc2fe24566fa5b2}{FERequirementType}} \&feRequirements);}
\DoxyCodeLine{200     Eigen::SparseMatrix<double> \&getReducedMatrixImpl(\textcolor{keyword}{const} \mbox{\hyperlink{a01069_acc6bac955dd0f718adc2fe24566fa5b2}{FERequirementType}} \&feRequirements);}
\DoxyCodeLine{201 }
\DoxyCodeLine{205     \textcolor{keywordtype}{void} createOccupationPattern(Eigen::SparseMatrix<double> \&assemblyMat);}
\DoxyCodeLine{206 }
\DoxyCodeLine{211     \textcolor{keywordtype}{void} createReducedOccupationPattern(Eigen::SparseMatrix<double> \&assemblyMat);}
\DoxyCodeLine{212 }
\DoxyCodeLine{214     \textcolor{keywordtype}{void} createLinearDOFsPerElement(Eigen::SparseMatrix<double> \&assemblyMat);}
\DoxyCodeLine{215 }
\DoxyCodeLine{217     \textcolor{keywordtype}{void} createLinearDOFsPerElementReduced(Eigen::SparseMatrix<double> \&assemblyMat);}
\DoxyCodeLine{218 }
\DoxyCodeLine{219     \textcolor{keywordtype}{void} preProcessSparseMatrix(Eigen::SparseMatrix<double> \&assemblyMat);}
\DoxyCodeLine{220 }
\DoxyCodeLine{221     \textcolor{keywordtype}{void} preProcessSparseMatrixReduced(Eigen::SparseMatrix<double> \&assemblyMat);}
\DoxyCodeLine{222 }
\DoxyCodeLine{223     Eigen::SparseMatrix<double> spMatRaw;}
\DoxyCodeLine{224     Eigen::SparseMatrix<double> spMat;}
\DoxyCodeLine{225     Eigen::SparseMatrix<double> spMatReduced;}
\DoxyCodeLine{226     std::vector<std::vector<Eigen::Index>> elementLinearIndices;}
\DoxyCodeLine{227     std::vector<std::vector<Eigen::Index>> elementLinearReducedIndices;}
\DoxyCodeLine{228     std::once\_flag sparsePreProcessorRaw, sparsePreProcessor, sparsePreProcessorReduced;}
\DoxyCodeLine{229   \};}
\DoxyCodeLine{230 }
\DoxyCodeLine{231   \textcolor{keyword}{template} <\textcolor{keyword}{class} T, \textcolor{keyword}{class} DirichletValuesType>}
\DoxyCodeLine{232   \mbox{\hyperlink{a00219_a419009b1eed12161465ccd4f476f07be}{SparseFlatAssembler}}(T \&\&fes, \textcolor{keyword}{const} DirichletValuesType \&dirichletValues\_)}
\DoxyCodeLine{233       -\/> \mbox{\hyperlink{a01069}{SparseFlatAssembler<T, DirichletValuesType>}};}
\DoxyCodeLine{234 }
\DoxyCodeLine{238   \textcolor{keyword}{template} <\textcolor{keyword}{typename} FEContainer\_,}
\DoxyCodeLine{239             \textcolor{keyword}{typename} DirichletValuesType\_>  \textcolor{comment}{// requires Ikarus::Concepts::FlatIndexBasis<BasisEmbedded>}}
\DoxyCodeLine{240   \textcolor{keyword}{class }\mbox{\hyperlink{a01073}{DenseFlatAssembler}} : \textcolor{keyword}{public} \mbox{\hyperlink{a01065}{VectorFlatAssembler}}<FEContainer\_, DirichletValuesType\_> \{}
\DoxyCodeLine{241   \textcolor{keyword}{public}:}
\DoxyCodeLine{242     \textcolor{keyword}{using }\mbox{\hyperlink{a01057_a8d033b14de49e508c7edfd5f8c37ca83}{FEContainerRaw}} = std::remove\_cvref\_t<FEContainer\_>;}
\DoxyCodeLine{243 }
\DoxyCodeLine{244     \textcolor{keyword}{using }\mbox{\hyperlink{a01057_aba7339d4e117f0f310c8ba9cd6da1e5a}{FERequirementType}}   = \textcolor{keyword}{typename} FEContainerRaw::value\_type::FERequirementType;}
\DoxyCodeLine{245     \textcolor{keyword}{using }\mbox{\hyperlink{a01057_a1b2ccee915a297c90f3865c71f2c3c14}{GlobalIndex}}         = \textcolor{keyword}{typename} FEContainerRaw::value\_type::GlobalIndex;}
\DoxyCodeLine{246     \textcolor{keyword}{using }\mbox{\hyperlink{a01057_aec6afbe8af2828aa945ab2b8f2c1aca6}{Basis}}               = \textcolor{keyword}{typename} DirichletValuesType\_::Basis;}
\DoxyCodeLine{247     \textcolor{keyword}{using }\mbox{\hyperlink{a01057_a030d83efead739f9abcb338d8f1d06b4}{FEContainer}}         = FEContainer\_;}
\DoxyCodeLine{248     \textcolor{keyword}{using }\mbox{\hyperlink{a01057_ab0275407303cf74b78fe44f0ad405e06}{DirichletValuesType}} = DirichletValuesType\_;}
\DoxyCodeLine{249 }
\DoxyCodeLine{250     \textcolor{keyword}{explicit} \mbox{\hyperlink{a01073_ab93366f696ae7d7ff75428d9fd117e00}{DenseFlatAssembler}}(\mbox{\hyperlink{a01057_a030d83efead739f9abcb338d8f1d06b4}{FEContainer}} \&\&fes, \textcolor{keyword}{const} \mbox{\hyperlink{a01057_ab0275407303cf74b78fe44f0ad405e06}{DirichletValuesType}} \&dirichletValues\_)}
\DoxyCodeLine{251         : \mbox{\hyperlink{a01065}{VectorFlatAssembler}}<\mbox{\hyperlink{a01057_a030d83efead739f9abcb338d8f1d06b4}{FEContainer}}, \mbox{\hyperlink{a01057_ab0275407303cf74b78fe44f0ad405e06}{DirichletValuesType}}>(std::forward<\mbox{\hyperlink{a01057_a030d83efead739f9abcb338d8f1d06b4}{FEContainer}}>(fes), dirichletValues\_) \{\}}
\DoxyCodeLine{252 }
\DoxyCodeLine{254     Eigen::MatrixXd \&\mbox{\hyperlink{a01073_a12716cf503b72a40ce0618a820a65628}{getRawMatrix}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01057_aba7339d4e117f0f310c8ba9cd6da1e5a}{FERequirementType}} \&feRequirements) \{ \textcolor{keywordflow}{return} getRawMatrixImpl(feRequirements); \}}
\DoxyCodeLine{255 }
\DoxyCodeLine{258     Eigen::MatrixXd \&\mbox{\hyperlink{a01073_a888912b546a2ddbb0ceb5d769e31f5b3}{getMatrix}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01057_aba7339d4e117f0f310c8ba9cd6da1e5a}{FERequirementType}} \&feRequirements) \{ \textcolor{keywordflow}{return} getMatrixImpl(feRequirements); \}}
\DoxyCodeLine{259 }
\DoxyCodeLine{262     Eigen::MatrixXd \&\mbox{\hyperlink{a01073_a5cd62c7b246ab0ca3fba525de391c90b}{getReducedMatrix}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01057_aba7339d4e117f0f310c8ba9cd6da1e5a}{FERequirementType}} \&feRequirements) \{}
\DoxyCodeLine{263       \textcolor{keywordflow}{return} getReducedMatrixImpl(feRequirements);}
\DoxyCodeLine{264     \}}
\DoxyCodeLine{265 }
\DoxyCodeLine{266   \textcolor{keyword}{private}:}
\DoxyCodeLine{267     \textcolor{keywordtype}{void} assembleRawMatrixImpl(\textcolor{keyword}{const} \mbox{\hyperlink{a01073_a89aff4a4368660faf50ffb1b0e48480f}{FERequirementType}} \&feRequirements, Eigen::MatrixXd \&assemblyMat);}
\DoxyCodeLine{268     Eigen::MatrixXd \&getRawMatrixImpl(\textcolor{keyword}{const} \mbox{\hyperlink{a01073_a89aff4a4368660faf50ffb1b0e48480f}{FERequirementType}} \&feRequirements);}
\DoxyCodeLine{269     Eigen::MatrixXd \&getMatrixImpl(\textcolor{keyword}{const} \mbox{\hyperlink{a01073_a89aff4a4368660faf50ffb1b0e48480f}{FERequirementType}} \&feRequirements);}
\DoxyCodeLine{270     Eigen::MatrixXd \&getReducedMatrixImpl(\textcolor{keyword}{const} \mbox{\hyperlink{a01073_a89aff4a4368660faf50ffb1b0e48480f}{FERequirementType}} \&feRequirements);}
\DoxyCodeLine{271 }
\DoxyCodeLine{272     Eigen::MatrixXd matRaw\{\};}
\DoxyCodeLine{273     Eigen::MatrixXd mat\{\};}
\DoxyCodeLine{274     Eigen::MatrixXd matRed\{\};}
\DoxyCodeLine{275   \};}
\DoxyCodeLine{276 }
\DoxyCodeLine{277   \textcolor{comment}{// https://en.cppreference.com/w/cpp/language/class\_template\_argument\_deduction}}
\DoxyCodeLine{278   \textcolor{keyword}{template} <\textcolor{keyword}{class} T, \textcolor{keyword}{class} DirichletValuesType>}
\DoxyCodeLine{279   \mbox{\hyperlink{a00219_abbb70261c7a5e5394a4402ca7dfb2b80}{DenseFlatAssembler}}(T \&\&fes, \textcolor{keyword}{const} DirichletValuesType \&dirichletValues\_)}
\DoxyCodeLine{280       -\/> \mbox{\hyperlink{a01073}{DenseFlatAssembler<T, DirichletValuesType>}};}
\DoxyCodeLine{281 }
\DoxyCodeLine{282 \}  \textcolor{comment}{// namespace Ikarus}}
\DoxyCodeLine{283 }
\DoxyCodeLine{284 \textcolor{preprocessor}{\#include "{}simpleassemblers.inl"{}}}

\end{DoxyCode}
