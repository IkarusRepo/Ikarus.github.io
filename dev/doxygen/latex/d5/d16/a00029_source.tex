\hypertarget{a00029_source}{}\doxysection{svk.\+hh}
\label{a00029_source}\index{svk.hh@{svk.hh}}
\mbox{\hyperlink{a00029}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// SPDX-\/FileCopyrightText: 2021-\/2024 The Ikarus Developers mueller@ibb.uni-\/stuttgart.de}}
\DoxyCodeLine{2 \textcolor{comment}{// SPDX-\/License-\/Identifier: LGPL-\/3.0-\/or-\/later}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{5 }
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00038}{ikarus/finiteelements/mechanics/materials/interface.hh}}>}}
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00098}{ikarus/utils/tensorutils.hh}}>}}
\DoxyCodeLine{8 }
\DoxyCodeLine{9 \textcolor{keyword}{namespace }\mbox{\hyperlink{a00219}{Ikarus}} \{}
\DoxyCodeLine{10   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ScalarType\_ = \textcolor{keywordtype}{double}>}
\DoxyCodeLine{11   \textcolor{keyword}{struct }\mbox{\hyperlink{a01177}{StVenantKirchhoffT}} : \textcolor{keyword}{public} \mbox{\hyperlink{a01161}{Material}}<StVenantKirchhoffT<ScalarType\_>> \{}
\DoxyCodeLine{12     [[nodiscard]] \textcolor{keyword}{constexpr} std::string \mbox{\hyperlink{a01177_a4ab3b1f75acb9e6aa6ed727849469b46}{nameImpl}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}StVenantKirchhoff"{}}; \}}
\DoxyCodeLine{13 }
\DoxyCodeLine{14     \textcolor{keyword}{explicit} \mbox{\hyperlink{a01177_a468ab55507d04b1cea816372d4e49bdf}{StVenantKirchhoffT}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01209}{LamesFirstParameterAndShearModulus}}\& mpt) : \mbox{\hyperlink{a01177_acc6e8e711bfb538fbcf99b2e9b9a3f2f}{materialParameter}}\{mpt\} \{\}}
\DoxyCodeLine{15     \textcolor{keyword}{using }\mbox{\hyperlink{a01177_a3a382a8805a37e4a8e1cf86ee215ee31}{ScalarType}}                    = ScalarType\_;}
\DoxyCodeLine{16     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} \mbox{\hyperlink{a01177_a17c96c4abafe6e6615aa0c23a8891488}{worldDimension}} = 3;}
\DoxyCodeLine{17     \textcolor{keyword}{using }\mbox{\hyperlink{a01177_a0fb732938eb00ca0a6c59cf2d483f456}{StrainMatrix}}                  = Eigen::Matrix<ScalarType, worldDimension, worldDimension>;}
\DoxyCodeLine{18     \textcolor{keyword}{using }\mbox{\hyperlink{a01177_a70bea18fc103ae2673a1d7bf19c455a2}{StressMatrix}}                  = \mbox{\hyperlink{a01177_a0fb732938eb00ca0a6c59cf2d483f456}{StrainMatrix}};}
\DoxyCodeLine{19 }
\DoxyCodeLine{20     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{auto} \mbox{\hyperlink{a01177_afb77a308376e0209e078d69202b8ac56}{strainTag}}          = StrainTags::greenLagrangian;}
\DoxyCodeLine{21     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{auto} \mbox{\hyperlink{a01177_ae423057c0e7d1894129c20564756fe84}{stressTag}}          = StressTags::PK2;}
\DoxyCodeLine{22     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{auto} \mbox{\hyperlink{a01177_a0e3a93114979e2edb67d61282b34d89c}{tangentModuliTag}}   = TangentModuliTags::Material;}
\DoxyCodeLine{23     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{bool} \mbox{\hyperlink{a01177_a100dbfdcc4ef61fd10cdc71aeb02168b}{energyAcceptsVoigt}} = \textcolor{keyword}{true};}
\DoxyCodeLine{24     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{bool} \mbox{\hyperlink{a01177_a4a237ac8dd0cd4ae7a1846be796c1600}{stressToVoigt}}      = \textcolor{keyword}{true};}
\DoxyCodeLine{25     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{bool} \mbox{\hyperlink{a01177_a0266cef35bc72574c77c99c35e4a1124}{stressAcceptsVoigt}} = \textcolor{keyword}{true};}
\DoxyCodeLine{26     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{bool} \mbox{\hyperlink{a01177_aaf29ca383a0ffd01eef92f79a4e7e692}{moduliToVoigt}}      = \textcolor{keyword}{true};}
\DoxyCodeLine{27     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{bool} \mbox{\hyperlink{a01177_ac5e3c259d5d00e660aa4e8d41637d2a5}{moduliAcceptsVoigt}} = \textcolor{keyword}{true};}
\DoxyCodeLine{28     \textcolor{comment}{// this factor denotes the differences between the returned stresses and moduli and the passed strain}}
\DoxyCodeLine{29     \textcolor{comment}{// for neoHooke the inserted quantity is C the Green-\/Lagrangian strain tensor,}}
\DoxyCodeLine{30     \textcolor{comment}{// the function relation between the energy and the stresses is S = 1\(\backslash\)partial \(\backslash\)psi(E)/ \(\backslash\)partial E.}}
\DoxyCodeLine{31     \textcolor{comment}{// This factor is pre factor, which is the difference to the actual derivative is written here}}
\DoxyCodeLine{32     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{double} \mbox{\hyperlink{a01177_aa006c6876d478c038981ecff45bce52f}{derivativeFactor}} = 1;}
\DoxyCodeLine{33 }
\DoxyCodeLine{34     \textcolor{keyword}{template} <\textcolor{keyword}{typename} Derived>}
\DoxyCodeLine{35     \mbox{\hyperlink{a01177_a3a382a8805a37e4a8e1cf86ee215ee31}{ScalarType}} \mbox{\hyperlink{a01177_a141b69c90248f5407096ea92863f1f63}{storedEnergyImpl}}(\textcolor{keyword}{const} Eigen::MatrixBase<Derived>\& E)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{36       \textcolor{keyword}{static\_assert}(Concepts::EigenMatrixOrVoigtNotation3<Derived>);}
\DoxyCodeLine{37       \textcolor{keywordflow}{if} \textcolor{keyword}{constexpr} (\mbox{\hyperlink{a01581}{Concepts::EigenVector<Derived>}}) \{}
\DoxyCodeLine{38         \textcolor{keyword}{const} \mbox{\hyperlink{a01177_a3a382a8805a37e4a8e1cf86ee215ee31}{ScalarType}} traceE = E.template segment<3>(0).sum();}
\DoxyCodeLine{39         \textcolor{keyword}{const} \mbox{\hyperlink{a01177_a3a382a8805a37e4a8e1cf86ee215ee31}{ScalarType}} squaredNorm}
\DoxyCodeLine{40             = E.template segment<3>(0).squaredNorm() + E.template segment<3>(3).squaredNorm() / \mbox{\hyperlink{a01177_a3a382a8805a37e4a8e1cf86ee215ee31}{ScalarType}}(2.0);}
\DoxyCodeLine{41         \textcolor{keywordflow}{return} \mbox{\hyperlink{a01177_acc6e8e711bfb538fbcf99b2e9b9a3f2f}{materialParameter}}.\mbox{\hyperlink{a01209_a0157695e9fc8b735e86f828cc35b64fc}{lambda}} / \mbox{\hyperlink{a01177_a3a382a8805a37e4a8e1cf86ee215ee31}{ScalarType}}(2.0) * traceE * traceE + \mbox{\hyperlink{a01177_acc6e8e711bfb538fbcf99b2e9b9a3f2f}{materialParameter}}.\mbox{\hyperlink{a01209_a3558ad06d2a831f0d412d76956d516f8}{mu}} * squaredNorm;}
\DoxyCodeLine{42       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{43         \textcolor{keyword}{const} \textcolor{keyword}{auto} traceE = E.trace();}
\DoxyCodeLine{44         \textcolor{keywordflow}{return} \mbox{\hyperlink{a01177_acc6e8e711bfb538fbcf99b2e9b9a3f2f}{materialParameter}}.\mbox{\hyperlink{a01209_a0157695e9fc8b735e86f828cc35b64fc}{lambda}} / \mbox{\hyperlink{a01177_a3a382a8805a37e4a8e1cf86ee215ee31}{ScalarType}}(2.0) * traceE * traceE + \mbox{\hyperlink{a01177_acc6e8e711bfb538fbcf99b2e9b9a3f2f}{materialParameter}}.\mbox{\hyperlink{a01209_a3558ad06d2a831f0d412d76956d516f8}{mu}} * E.squaredNorm();}
\DoxyCodeLine{45       \}}
\DoxyCodeLine{46     \}}
\DoxyCodeLine{47 }
\DoxyCodeLine{48     \textcolor{keyword}{template} <\textcolor{keywordtype}{bool} voigt, \textcolor{keyword}{typename} Derived>}
\DoxyCodeLine{49     \textcolor{keyword}{auto} \mbox{\hyperlink{a01177_a8934cae3774e3c2044f3ad67457963cd}{stressesImpl}}(\textcolor{keyword}{const} Eigen::MatrixBase<Derived>\& EMB)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{50       \textcolor{keyword}{static\_assert}(Concepts::EigenMatrixOrVoigtNotation3<\textcolor{keyword}{decltype}(EMB.eval())>);}
\DoxyCodeLine{51       \textcolor{keyword}{const} \textcolor{keyword}{auto}\& E = EMB.derived();}
\DoxyCodeLine{52       \textcolor{keywordflow}{if} \textcolor{keyword}{constexpr} (!voigt) \{}
\DoxyCodeLine{53         \textcolor{keywordflow}{if} \textcolor{keyword}{constexpr} (\mbox{\hyperlink{a01581}{Concepts::EigenVector<Derived>}}) \{}
\DoxyCodeLine{54           \textcolor{keyword}{static\_assert}(Concepts::EigenVector6<Derived>);}
\DoxyCodeLine{55           Eigen::Matrix<ScalarType, 3, 3> S;}
\DoxyCodeLine{56           \textcolor{keyword}{const} \mbox{\hyperlink{a01177_a3a382a8805a37e4a8e1cf86ee215ee31}{ScalarType}} traceE = E.template segment<3>(0).sum();}
\DoxyCodeLine{57           S.diagonal().array()}
\DoxyCodeLine{58               = \mbox{\hyperlink{a01177_acc6e8e711bfb538fbcf99b2e9b9a3f2f}{materialParameter}}.\mbox{\hyperlink{a01209_a0157695e9fc8b735e86f828cc35b64fc}{lambda}} * traceE + 2 * \mbox{\hyperlink{a01177_acc6e8e711bfb538fbcf99b2e9b9a3f2f}{materialParameter}}.\mbox{\hyperlink{a01209_a3558ad06d2a831f0d412d76956d516f8}{mu}} * E.template segment<3>(0).array();}
\DoxyCodeLine{59           S(1, 2) = S(2, 1) = \mbox{\hyperlink{a01177_acc6e8e711bfb538fbcf99b2e9b9a3f2f}{materialParameter}}.\mbox{\hyperlink{a01209_a3558ad06d2a831f0d412d76956d516f8}{mu}} * E(3);}
\DoxyCodeLine{60           S(0, 2) = S(2, 0) = \mbox{\hyperlink{a01177_acc6e8e711bfb538fbcf99b2e9b9a3f2f}{materialParameter}}.\mbox{\hyperlink{a01209_a3558ad06d2a831f0d412d76956d516f8}{mu}} * E(4);}
\DoxyCodeLine{61           S(0, 1) = S(1, 0) = \mbox{\hyperlink{a01177_acc6e8e711bfb538fbcf99b2e9b9a3f2f}{materialParameter}}.\mbox{\hyperlink{a01209_a3558ad06d2a831f0d412d76956d516f8}{mu}} * E(5);  \textcolor{comment}{// no two since E voigt has 2* on off-\/diagonal terms}}
\DoxyCodeLine{62           \textcolor{keywordflow}{return} S;}
\DoxyCodeLine{63         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{64           \textcolor{keyword}{static\_assert}(Concepts::EigenMatrix33<Derived>);}
\DoxyCodeLine{65           \textcolor{keywordflow}{return} (\mbox{\hyperlink{a01177_acc6e8e711bfb538fbcf99b2e9b9a3f2f}{materialParameter}}.\mbox{\hyperlink{a01209_a0157695e9fc8b735e86f828cc35b64fc}{lambda}} * E.trace() * StrainMatrix::Identity() + 2 * \mbox{\hyperlink{a01177_acc6e8e711bfb538fbcf99b2e9b9a3f2f}{materialParameter}}.\mbox{\hyperlink{a01209_a3558ad06d2a831f0d412d76956d516f8}{mu}} * E)}
\DoxyCodeLine{66               .\mbox{\hyperlink{a00219_a746ffb7ea71ab7ea16727793ff59c3c7}{eval}}();}
\DoxyCodeLine{67         \}}
\DoxyCodeLine{68       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{69         \textcolor{keywordflow}{if} \textcolor{keyword}{constexpr} (\mbox{\hyperlink{a01581}{Concepts::EigenVector<Derived>}}) \{}
\DoxyCodeLine{70           \textcolor{keyword}{static\_assert}(Concepts::EigenVector6<Derived>);}
\DoxyCodeLine{71           Eigen::Matrix<ScalarType, 6, 1> S;}
\DoxyCodeLine{72           \textcolor{keyword}{const} \mbox{\hyperlink{a01177_a3a382a8805a37e4a8e1cf86ee215ee31}{ScalarType}} traceE          = E.template segment<3>(0).sum();}
\DoxyCodeLine{73           S.template segment<3>(0).array() = traceE * \mbox{\hyperlink{a01177_acc6e8e711bfb538fbcf99b2e9b9a3f2f}{materialParameter}}.\mbox{\hyperlink{a01209_a0157695e9fc8b735e86f828cc35b64fc}{lambda}};}
\DoxyCodeLine{74           S.template segment<3>(0) += \mbox{\hyperlink{a01177_acc6e8e711bfb538fbcf99b2e9b9a3f2f}{materialParameter}}.\mbox{\hyperlink{a01209_a3558ad06d2a831f0d412d76956d516f8}{mu}} * 2 * E.template segment<3>(0);}
\DoxyCodeLine{75           S.template segment<3>(3)}
\DoxyCodeLine{76               = \mbox{\hyperlink{a01177_acc6e8e711bfb538fbcf99b2e9b9a3f2f}{materialParameter}}.\mbox{\hyperlink{a01209_a3558ad06d2a831f0d412d76956d516f8}{mu}} * E.template segment<3>(3);  \textcolor{comment}{// no two since E voigt has 2* on off-\/diagonal terms}}
\DoxyCodeLine{77           \textcolor{keywordflow}{return} S;}
\DoxyCodeLine{78         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{79           Eigen::Matrix<ScalarType, 6, 1> S;}
\DoxyCodeLine{80           S.template segment<3>(0).array() = E.trace() * \mbox{\hyperlink{a01177_acc6e8e711bfb538fbcf99b2e9b9a3f2f}{materialParameter}}.\mbox{\hyperlink{a01209_a0157695e9fc8b735e86f828cc35b64fc}{lambda}};}
\DoxyCodeLine{81           S.template segment<3>(0) += 2 * \mbox{\hyperlink{a01177_acc6e8e711bfb538fbcf99b2e9b9a3f2f}{materialParameter}}.\mbox{\hyperlink{a01209_a3558ad06d2a831f0d412d76956d516f8}{mu}} * E.diagonal();}
\DoxyCodeLine{82           S(3) = 2 * \mbox{\hyperlink{a01177_acc6e8e711bfb538fbcf99b2e9b9a3f2f}{materialParameter}}.\mbox{\hyperlink{a01209_a3558ad06d2a831f0d412d76956d516f8}{mu}} * E(1, 2);}
\DoxyCodeLine{83           S(4) = 2 * \mbox{\hyperlink{a01177_acc6e8e711bfb538fbcf99b2e9b9a3f2f}{materialParameter}}.\mbox{\hyperlink{a01209_a3558ad06d2a831f0d412d76956d516f8}{mu}} * E(0, 2);}
\DoxyCodeLine{84           S(5) = 2 * \mbox{\hyperlink{a01177_acc6e8e711bfb538fbcf99b2e9b9a3f2f}{materialParameter}}.\mbox{\hyperlink{a01209_a3558ad06d2a831f0d412d76956d516f8}{mu}} * E(0, 1);}
\DoxyCodeLine{85           \textcolor{keywordflow}{return} S;}
\DoxyCodeLine{86         \}}
\DoxyCodeLine{87       \}}
\DoxyCodeLine{88     \}}
\DoxyCodeLine{89 }
\DoxyCodeLine{90     \textcolor{keyword}{template} <\textcolor{keywordtype}{bool} voigt, \textcolor{keyword}{typename} Derived>}
\DoxyCodeLine{91     \textcolor{keyword}{auto} \mbox{\hyperlink{a01177_a9c72bd442ae0113ee0f133959852c187}{tangentModuliImpl}}(\textcolor{keyword}{const} Eigen::MatrixBase<Derived>\&)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{92       \textcolor{keyword}{static\_assert}(Concepts::EigenMatrixOrVoigtNotation3<Derived>);}
\DoxyCodeLine{93       \textcolor{keywordflow}{if} \textcolor{keyword}{constexpr} (!voigt) \{}
\DoxyCodeLine{94         Eigen::TensorFixedSize<ScalarType, Eigen::Sizes<3, 3, 3, 3>> moduli;}
\DoxyCodeLine{95         moduli = \mbox{\hyperlink{a01177_acc6e8e711bfb538fbcf99b2e9b9a3f2f}{materialParameter}}.\mbox{\hyperlink{a01209_a0157695e9fc8b735e86f828cc35b64fc}{lambda}} * \mbox{\hyperlink{a00219_adb08b6f9cc40847b70286dc314a23000}{identityFourthOrder}}()}
\DoxyCodeLine{96                  + 2 * \mbox{\hyperlink{a01177_acc6e8e711bfb538fbcf99b2e9b9a3f2f}{materialParameter}}.\mbox{\hyperlink{a01209_a3558ad06d2a831f0d412d76956d516f8}{mu}} * \mbox{\hyperlink{a00219_a1c9618ef351cd986d4f64fde7f52e860}{symmetricIdentityFourthOrder}}();}
\DoxyCodeLine{97         \textcolor{keywordflow}{return} moduli;}
\DoxyCodeLine{98       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{99         Eigen::Matrix<ScalarType, 6, 6> moduli;}
\DoxyCodeLine{100         moduli.setZero();}
\DoxyCodeLine{101         moduli.template block<3, 3>(0, 0).array() = \mbox{\hyperlink{a01177_acc6e8e711bfb538fbcf99b2e9b9a3f2f}{materialParameter}}.\mbox{\hyperlink{a01209_a0157695e9fc8b735e86f828cc35b64fc}{lambda}};}
\DoxyCodeLine{102         moduli.template block<3, 3>(0, 0).diagonal().array() += 2 * \mbox{\hyperlink{a01177_acc6e8e711bfb538fbcf99b2e9b9a3f2f}{materialParameter}}.\mbox{\hyperlink{a01209_a3558ad06d2a831f0d412d76956d516f8}{mu}};}
\DoxyCodeLine{103         moduli.template block<3, 3>(3, 3).diagonal().array() = \mbox{\hyperlink{a01177_acc6e8e711bfb538fbcf99b2e9b9a3f2f}{materialParameter}}.\mbox{\hyperlink{a01209_a3558ad06d2a831f0d412d76956d516f8}{mu}};}
\DoxyCodeLine{104         \textcolor{keywordflow}{return} moduli;}
\DoxyCodeLine{105       \}}
\DoxyCodeLine{106     \}}
\DoxyCodeLine{107 }
\DoxyCodeLine{108     \textcolor{keyword}{template} <\textcolor{keyword}{typename} ScalarTypeOther>}
\DoxyCodeLine{109     \textcolor{keyword}{auto} \mbox{\hyperlink{a01177_a804a4428cd7824f964f6b7de6b6612b4}{rebind}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{110       \textcolor{keywordflow}{return} \mbox{\hyperlink{a01177}{StVenantKirchhoff<ScalarTypeOther>}}(\mbox{\hyperlink{a01177_acc6e8e711bfb538fbcf99b2e9b9a3f2f}{materialParameter}});}
\DoxyCodeLine{111     \}}
\DoxyCodeLine{112 }
\DoxyCodeLine{113     \mbox{\hyperlink{a01209}{LamesFirstParameterAndShearModulus}} \mbox{\hyperlink{a01177_acc6e8e711bfb538fbcf99b2e9b9a3f2f}{materialParameter}};}
\DoxyCodeLine{114   \};}
\DoxyCodeLine{115 }
\DoxyCodeLine{116   \textcolor{keyword}{typedef} \mbox{\hyperlink{a01177}{StVenantKirchhoffT<double>}} \mbox{\hyperlink{a00219_ab6b67c66afecf13985c9bf252ac644da}{StVenantKirchhoff}};}
\DoxyCodeLine{117 }
\DoxyCodeLine{118 \}  \textcolor{comment}{// namespace Ikarus}}

\end{DoxyCode}
