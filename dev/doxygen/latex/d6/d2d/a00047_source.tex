\hypertarget{a00047_source}{}\doxysection{neohooke.\+hh}
\label{a00047_source}\index{neohooke.hh@{neohooke.hh}}
\mbox{\hyperlink{a00047}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// SPDX-\/FileCopyrightText: 2021-\/2024 The Ikarus Developers mueller@ibb.uni-\/stuttgart.de}}
\DoxyCodeLine{2 \textcolor{comment}{// SPDX-\/License-\/Identifier: LGPL-\/3.0-\/or-\/later}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{5 }
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00038}{ikarus/finiteelements/mechanics/materials/interface.hh}}>}}
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00098}{ikarus/utils/tensorutils.hh}}>}}
\DoxyCodeLine{8 }
\DoxyCodeLine{9 \textcolor{keyword}{namespace }\mbox{\hyperlink{a00219}{Ikarus}} \{}
\DoxyCodeLine{10 }
\DoxyCodeLine{11   \textcolor{comment}{// see Javier Bonet, Richard D. Wood -\/ Nonlinear Continuum Mechanics for Finite Element Analysis, 2nd Edition (2008)}}
\DoxyCodeLine{12   \textcolor{comment}{// Section 6.4.3}}
\DoxyCodeLine{13   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ScalarType\_ = \textcolor{keywordtype}{double}>}
\DoxyCodeLine{14   \textcolor{keyword}{struct }\mbox{\hyperlink{a01173}{NeoHookeT}} : \textcolor{keyword}{public} \mbox{\hyperlink{a01161}{Material}}<NeoHookeT<ScalarType\_>> \{}
\DoxyCodeLine{15     [[nodiscard]] \textcolor{keyword}{constexpr} std::string \mbox{\hyperlink{a01173_a437008f3343a4f701fdd4c5e425313ce}{nameImpl}}() const noexcept \{ \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}NeoHooke"{}}; \}}
\DoxyCodeLine{16 }
\DoxyCodeLine{17     \textcolor{keyword}{explicit} \mbox{\hyperlink{a01173_a10eb1792f7a78e2f52c625a01301f5ef}{NeoHookeT}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01209}{LamesFirstParameterAndShearModulus}}\& mpt) : \mbox{\hyperlink{a01173_a65f7f8af8bb74bba74ea19836eceab25}{lambdaAndmu}}\{mpt\} \{\}}
\DoxyCodeLine{18     \textcolor{keyword}{using }\mbox{\hyperlink{a01173_a2c6a3eab38f9a88b18a869d9e66eda53}{ScalarType}}                    = ScalarType\_;}
\DoxyCodeLine{19     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} \mbox{\hyperlink{a01173_a5eebe95a0e13399abd7f26020f0c0f3a}{worldDimension}} = 3;}
\DoxyCodeLine{20     \textcolor{keyword}{using }\mbox{\hyperlink{a01173_a273e05e32f6a9728440ad3da6669ec7a}{StrainMatrix}}                  = Eigen::Matrix<ScalarType, worldDimension, worldDimension>;}
\DoxyCodeLine{21     \textcolor{keyword}{using }\mbox{\hyperlink{a01173_ac8ebe95bef84eb82bf38ed45261f2173}{StressMatrix}}                  = \mbox{\hyperlink{a01173_a273e05e32f6a9728440ad3da6669ec7a}{StrainMatrix}};}
\DoxyCodeLine{22 }
\DoxyCodeLine{23     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{auto} \mbox{\hyperlink{a01173_a505b0b0ada1c096262412fda6a823cef}{strainTag}}          = StrainTags::rightCauchyGreenTensor;}
\DoxyCodeLine{24     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{auto} \mbox{\hyperlink{a01173_aa0b04d47fd84e036f8487cf9641abb41}{stressTag}}          = StressTags::PK2;}
\DoxyCodeLine{25     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{auto} \mbox{\hyperlink{a01173_ab6adef71801c1e3d9cff0fc522950c1f}{tangentModuliTag}}   = TangentModuliTags::Material;}
\DoxyCodeLine{26     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{bool} \mbox{\hyperlink{a01173_a39c43bb592cf54c9a2fd3b60c741a252}{energyAcceptsVoigt}} = \textcolor{keyword}{false};}
\DoxyCodeLine{27     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{bool} \mbox{\hyperlink{a01173_a37a9776bddff633282912937c1e737a3}{stressToVoigt}}      = \textcolor{keyword}{false};}
\DoxyCodeLine{28     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{bool} \mbox{\hyperlink{a01173_ada1f302b0b332d6cff1ddfa62ac72871}{stressAcceptsVoigt}} = \textcolor{keyword}{false};}
\DoxyCodeLine{29     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{bool} \mbox{\hyperlink{a01173_ad72e02a26d4a3b6d8d29f6341a15952a}{moduliToVoigt}}      = \textcolor{keyword}{false};}
\DoxyCodeLine{30     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{bool} \mbox{\hyperlink{a01173_a0f1786af1344f46596f6e58babd87543}{moduliAcceptsVoigt}} = \textcolor{keyword}{false};}
\DoxyCodeLine{31     \textcolor{comment}{// this factor denotes the differences between the returned stresses and moduli and the passed strain}}
\DoxyCodeLine{32     \textcolor{comment}{// for neoHooke the inserted quantity is C the right Cauchy-\/Green tensor,}}
\DoxyCodeLine{33     \textcolor{comment}{// the function relation between the energy and the stresses is S = 2*\(\backslash\)partial \(\backslash\)psi(C)/ \(\backslash\)partial C.}}
\DoxyCodeLine{34     \textcolor{comment}{// This factor is pre factor, which is the difference to the actual derivative is written here}}
\DoxyCodeLine{35     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{double} \mbox{\hyperlink{a01173_a38a89c3043d1eaa77d3a743b89a99480}{derivativeFactor}} = 2;}
\DoxyCodeLine{36 }
\DoxyCodeLine{37     \textcolor{keyword}{template} <\textcolor{keyword}{typename} Derived>}
\DoxyCodeLine{38     \mbox{\hyperlink{a01173_a2c6a3eab38f9a88b18a869d9e66eda53}{ScalarType}} \mbox{\hyperlink{a01173_a49da0bb7428a0cf780cdcad97ec97b74}{storedEnergyImpl}}(\textcolor{keyword}{const} Eigen::MatrixBase<Derived>\& C) \textcolor{keyword}{const} \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{39       \textcolor{keyword}{static\_assert}(Concepts::EigenMatrixOrVoigtNotation3<Derived>);}
\DoxyCodeLine{40       \textcolor{keywordflow}{if} \textcolor{keyword}{constexpr} (!\mbox{\hyperlink{a01581}{Concepts::EigenVector<Derived>}}) \{}
\DoxyCodeLine{41         \textcolor{keyword}{const} \textcolor{keyword}{auto} traceC  = C.trace();}
\DoxyCodeLine{42         \textcolor{keyword}{const} \textcolor{keyword}{auto} logdetF = log(sqrt(C.determinant()));}
\DoxyCodeLine{43         \textcolor{keywordflow}{return} \mbox{\hyperlink{a01173_a65f7f8af8bb74bba74ea19836eceab25}{lambdaAndmu}}.\mbox{\hyperlink{a01209_a3558ad06d2a831f0d412d76956d516f8}{mu}} / 2.0 * (traceC -\/ 3 -\/ 2 * logdetF) + \mbox{\hyperlink{a01173_a65f7f8af8bb74bba74ea19836eceab25}{lambdaAndmu}}.\mbox{\hyperlink{a01209_a0157695e9fc8b735e86f828cc35b64fc}{lambda}} / 2.0 * logdetF * logdetF;}
\DoxyCodeLine{44       \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{45         \textcolor{keyword}{static\_assert}(!\mbox{\hyperlink{a01581}{Concepts::EigenVector<Derived>}},}
\DoxyCodeLine{46                       \textcolor{stringliteral}{"{}NeoHooke energy can only be called with matrix and not a vector in Voigt notation"{}});}
\DoxyCodeLine{47     \}}
\DoxyCodeLine{48 }
\DoxyCodeLine{49     \textcolor{keyword}{template} <\textcolor{keywordtype}{bool} voigt, \textcolor{keyword}{typename} Derived>}
\DoxyCodeLine{50     \textcolor{keyword}{auto} \mbox{\hyperlink{a01173_a2cfcf4034eb9e07c06829785ea92c3f4}{stressesImpl}}(\textcolor{keyword}{const} Eigen::MatrixBase<Derived>\& C)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{51       \textcolor{keyword}{static\_assert}(Concepts::EigenMatrixOrVoigtNotation3<Derived>);}
\DoxyCodeLine{52       \textcolor{keywordflow}{if} \textcolor{keyword}{constexpr} (!voigt) \{}
\DoxyCodeLine{53         \textcolor{keywordflow}{if} \textcolor{keyword}{constexpr} (!\mbox{\hyperlink{a01581}{Concepts::EigenVector<Derived>}}) \{}
\DoxyCodeLine{54           \textcolor{keyword}{const} \textcolor{keyword}{auto} logdetF = log(sqrt(C.determinant()));}
\DoxyCodeLine{55           \textcolor{keyword}{const} \textcolor{keyword}{auto} invC    = C.inverse().eval();}
\DoxyCodeLine{56           \textcolor{keywordflow}{return} (\mbox{\hyperlink{a01173_a65f7f8af8bb74bba74ea19836eceab25}{lambdaAndmu}}.\mbox{\hyperlink{a01209_a3558ad06d2a831f0d412d76956d516f8}{mu}} * (StrainMatrix::Identity() -\/ invC) + \mbox{\hyperlink{a01173_a65f7f8af8bb74bba74ea19836eceab25}{lambdaAndmu}}.\mbox{\hyperlink{a01209_a0157695e9fc8b735e86f828cc35b64fc}{lambda}} * logdetF * invC).eval();}
\DoxyCodeLine{57         \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{58           \textcolor{keyword}{static\_assert}(!\mbox{\hyperlink{a01581}{Concepts::EigenVector<Derived>}},}
\DoxyCodeLine{59                         \textcolor{stringliteral}{"{}NeoHooke can only be called with matrix and not a vector in Voigt notation"{}});}
\DoxyCodeLine{60       \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{61         \textcolor{keyword}{static\_assert}(voigt == \textcolor{keyword}{false}, \textcolor{stringliteral}{"{}NeoHooke does not support returning stresses in Voigt notation"{}});}
\DoxyCodeLine{62     \}}
\DoxyCodeLine{63 }
\DoxyCodeLine{64     \textcolor{keyword}{template} <\textcolor{keywordtype}{bool} voigt, \textcolor{keyword}{typename} Derived>}
\DoxyCodeLine{65     \textcolor{keyword}{auto} \mbox{\hyperlink{a01173_aec2dfac0aca87f7998a0f0c2b3b63133}{tangentModuliImpl}}(\textcolor{keyword}{const} Eigen::MatrixBase<Derived>\& C)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{66       \textcolor{keyword}{static\_assert}(Concepts::EigenMatrixOrVoigtNotation3<Derived>);}
\DoxyCodeLine{67       \textcolor{keywordflow}{if} \textcolor{keyword}{constexpr} (!voigt) \{}
\DoxyCodeLine{68         \textcolor{keyword}{const} \textcolor{keyword}{auto} invC    = C.inverse().eval();}
\DoxyCodeLine{69         \textcolor{keyword}{const} \textcolor{keyword}{auto} logdetF = log(sqrt(C.determinant()));}
\DoxyCodeLine{70         \textcolor{keyword}{const} \textcolor{keyword}{auto} CTinv   = \mbox{\hyperlink{a00219_a1e9e2ec1a0fdbfe5d9f49107c87948e5}{TensorCast}}(invC, std::array<Eigen::Index, 2>(\{3, 3\}));}
\DoxyCodeLine{71         \textcolor{keyword}{static\_assert}(Eigen::TensorFixedSize<ScalarType, Eigen::Sizes<3, 3>>::NumIndices == 2);}
\DoxyCodeLine{72         \textcolor{comment}{// see Javier Bonet, Richard D. Wood -\/ Nonlinear Continuum Mechanics for Finite Element Analysis, 2nd Edition}}
\DoxyCodeLine{73         \textcolor{comment}{// (2008) Eq. 6.30}}
\DoxyCodeLine{74         \textcolor{comment}{//  (first edition has an error)}}
\DoxyCodeLine{75         Eigen::TensorFixedSize<ScalarType, Eigen::Sizes<3, 3, 3, 3>> moduli}
\DoxyCodeLine{76             = (\mbox{\hyperlink{a01173_a65f7f8af8bb74bba74ea19836eceab25}{lambdaAndmu}}.\mbox{\hyperlink{a01209_a0157695e9fc8b735e86f828cc35b64fc}{lambda}} * \mbox{\hyperlink{a00219_ab2cea9ac847cc3635812467c9d96ceb4}{dyadic}}(CTinv, CTinv)}
\DoxyCodeLine{77                + 2 * (\mbox{\hyperlink{a01173_a65f7f8af8bb74bba74ea19836eceab25}{lambdaAndmu}}.\mbox{\hyperlink{a01209_a3558ad06d2a831f0d412d76956d516f8}{mu}} -\/ \mbox{\hyperlink{a01173_a65f7f8af8bb74bba74ea19836eceab25}{lambdaAndmu}}.\mbox{\hyperlink{a01209_a0157695e9fc8b735e86f828cc35b64fc}{lambda}} * logdetF) * \mbox{\hyperlink{a00219_aea03dbfcd8f85ef7af004c7e09244aa9}{symTwoSlots}}(\mbox{\hyperlink{a00219_a8fa2b440586483c1ee0f9b90b9081da2}{fourthOrderIKJL}}(invC, invC), \{2, 3\}))}
\DoxyCodeLine{78                   .eval();}
\DoxyCodeLine{79         \textcolor{keywordflow}{return} moduli;}
\DoxyCodeLine{80       \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{81         \textcolor{keyword}{static\_assert}(voigt == \textcolor{keyword}{false}, \textcolor{stringliteral}{"{}NeoHooke does not support returning tangentModuli in Voigt notation"{}});}
\DoxyCodeLine{82     \}}
\DoxyCodeLine{83 }
\DoxyCodeLine{84     \textcolor{keyword}{template} <\textcolor{keyword}{typename} ScalarTypeOther>}
\DoxyCodeLine{85     \textcolor{keyword}{auto} \mbox{\hyperlink{a01173_a5d32fe6c728cb508b20bc11099baf6a1}{rebind}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{86       \textcolor{keywordflow}{return} \mbox{\hyperlink{a01173}{NeoHookeT<ScalarTypeOther>}}(\mbox{\hyperlink{a01173_a65f7f8af8bb74bba74ea19836eceab25}{lambdaAndmu}});}
\DoxyCodeLine{87     \}}
\DoxyCodeLine{88 }
\DoxyCodeLine{89     \mbox{\hyperlink{a01209}{LamesFirstParameterAndShearModulus}} \mbox{\hyperlink{a01173_a65f7f8af8bb74bba74ea19836eceab25}{lambdaAndmu}};}
\DoxyCodeLine{90   \};}
\DoxyCodeLine{91   \textcolor{keyword}{typedef} \mbox{\hyperlink{a01173}{NeoHookeT<double>}} \mbox{\hyperlink{a00219_a8d5cb9f5246159271193458daad08fdd}{NeoHooke}};}
\DoxyCodeLine{92 }
\DoxyCodeLine{93 \}  \textcolor{comment}{// namespace Ikarus}}

\end{DoxyCode}
