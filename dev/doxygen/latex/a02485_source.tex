\hypertarget{a02485_source}{}\doxysection{finiteelements/mechanics/kirchhoffloveshell.hh}
\label{a02485_source}\index{kirchhoffloveshell.hh@{kirchhoffloveshell.hh}}
\mbox{\hyperlink{a02485}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// SPDX-\/FileCopyrightText: 2021-\/2024 The Ikarus Developers mueller@ibb.uni-\/stuttgart.de}}
\DoxyCodeLine{2 \textcolor{comment}{// SPDX-\/License-\/Identifier: LGPL-\/3.0-\/or-\/later}}
\DoxyCodeLine{3 }
\DoxyCodeLine{9 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{10 }
\DoxyCodeLine{11 \textcolor{preprocessor}{\#include <dune/fufem/boundarypatch.hh>}}
\DoxyCodeLine{12 \textcolor{preprocessor}{\#include <dune/geometry/quadraturerules.hh>}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include <dune/localfefunctions/cachedlocalBasis/cachedlocalBasis.hh>}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include <dune/localfefunctions/impl/standardLocalFunction.hh>}}
\DoxyCodeLine{15 \textcolor{preprocessor}{\#include <dune/localfefunctions/manifolds/realTuple.hh>}}
\DoxyCodeLine{16 }
\DoxyCodeLine{17 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00119}{ikarus/finiteelements/febase.hh}}>}}
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00131}{ikarus/finiteelements/fehelper.hh}}>}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00122}{ikarus/finiteelements/ferequirements.hh}}>}}
\DoxyCodeLine{20 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00194}{ikarus/finiteelements/mechanics/loads.hh}}>}}
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00140}{ikarus/finiteelements/mechanics/materials.hh}}>}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00152}{ikarus/finiteelements/mechanics/membranestrains.hh}}>}}
\DoxyCodeLine{23 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00116}{ikarus/finiteelements/physicshelper.hh}}>}}
\DoxyCodeLine{24 }
\DoxyCodeLine{25 \textcolor{keyword}{namespace }\mbox{\hyperlink{a00328}{Ikarus}} \{}
\DoxyCodeLine{26 }
\DoxyCodeLine{39 \textcolor{keyword}{template} <\textcolor{keyword}{typename} BH, \textcolor{keyword}{typename} FER = FERequirements<>, \textcolor{keywordtype}{bool} useEigenRef = false, \textcolor{keywordtype}{bool} useFlat = true>}
\DoxyCodeLine{40 \textcolor{keyword}{class }\mbox{\hyperlink{a01320}{KirchhoffLoveShell}} : \textcolor{keyword}{public} \mbox{\hyperlink{a01232}{FEBase}}<BH, useFlat, FER, useEigenRef>,}
\DoxyCodeLine{41                            \textcolor{keyword}{public} \mbox{\hyperlink{a01336}{Volume}}<KirchhoffLoveShell<BH, FER, useEigenRef, useFlat>,}
\DoxyCodeLine{42                                          typename FEBase<BH, useFlat, FER, useEigenRef>::Traits>,}
\DoxyCodeLine{43                            \textcolor{keyword}{public} \mbox{\hyperlink{a01332}{Traction}}<KirchhoffLoveShell<BH, FER, useEigenRef, useFlat>,}
\DoxyCodeLine{44                                            typename FEBase<BH, useFlat, FER, useEigenRef>::Traits>}
\DoxyCodeLine{45 \{}
\DoxyCodeLine{46 \textcolor{keyword}{public}:}
\DoxyCodeLine{47   \textcolor{keyword}{using }\mbox{\hyperlink{a01232}{Base}}              = \mbox{\hyperlink{a01232}{FEBase<BH, useFlat, FER, useEigenRef>}};}
\DoxyCodeLine{48   \textcolor{keyword}{using }\mbox{\hyperlink{a01320_a77bd1dc758eedb257d42ace26147ed3d}{Traits}}            = \textcolor{keyword}{typename} \mbox{\hyperlink{a01232_ac5fdc9a8e9d4a7d670df89d397129588}{Base::Traits}};}
\DoxyCodeLine{49   \textcolor{keyword}{using }\mbox{\hyperlink{a01320_ad68761e004008383ae750126279cc018}{BasisHandler}}      = \textcolor{keyword}{typename} Traits::BasisHandler;}
\DoxyCodeLine{50   \textcolor{keyword}{using }\mbox{\hyperlink{a01320_a3b8e898bf7ec07eb7aa58b3534f9a49f}{FlatBasis}}         = \textcolor{keyword}{typename} Traits::FlatBasis;}
\DoxyCodeLine{51   \textcolor{keyword}{using }\mbox{\hyperlink{a01320_a3e8403ae17986b426fea60cbe9ed8423}{FERequirementType}} = \textcolor{keyword}{typename} Traits::FERequirementType;}
\DoxyCodeLine{52   \textcolor{keyword}{using }\mbox{\hyperlink{a01320_a2882d2f7d1fc20f42551b5edc5c9c054}{LocalView}}         = \textcolor{keyword}{typename} Traits::LocalView;}
\DoxyCodeLine{53   \textcolor{keyword}{using }\mbox{\hyperlink{a01320_ab9d8cf76b0245c4a6e3907451027bf38}{Geometry}}          = \textcolor{keyword}{typename} Traits::Geometry;}
\DoxyCodeLine{54   \textcolor{keyword}{using }\mbox{\hyperlink{a01320_a800c1311a384b5345c32b224c056a12e}{GridView}}          = \textcolor{keyword}{typename} Traits::GridView;}
\DoxyCodeLine{55   \textcolor{keyword}{using }\mbox{\hyperlink{a01320_a0caf9be5f23228297ba9a75472fabc4c}{Element}}           = \textcolor{keyword}{typename} Traits::Element;}
\DoxyCodeLine{56   \textcolor{keyword}{using }\mbox{\hyperlink{a01336}{VolumeType}}        = \mbox{\hyperlink{a01336}{Volume<KirchhoffLoveShell, Traits>}};}
\DoxyCodeLine{57   \textcolor{keyword}{using }\mbox{\hyperlink{a01332}{TractionType}}      = \mbox{\hyperlink{a01332}{Traction<KirchhoffLoveShell, Traits>}};}
\DoxyCodeLine{58   \textcolor{keyword}{using }\mbox{\hyperlink{a01320_a9ffa05a3b50bd54058e62033bfa0852b}{LocalBasisType}}    = \textcolor{keyword}{decltype}(std::declval<LocalView>().tree().child(0).finiteElement().localBasis());}
\DoxyCodeLine{59 }
\DoxyCodeLine{60   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} \mbox{\hyperlink{a01320_a968027b6f37635394075db06914c0fa3}{myDim}}              = Traits::mydim;}
\DoxyCodeLine{61   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} \mbox{\hyperlink{a01320_a9d4092ba09ffa6550b1ae2df556884da}{worldDim}}           = Traits::worlddim;}
\DoxyCodeLine{62   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} \mbox{\hyperlink{a01320_aa7c628056868083c91be5904c1f9c609}{membraneStrainSize}} = 3;}
\DoxyCodeLine{63   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} \mbox{\hyperlink{a01320_a326298a6aa2c2e42ef4e79ffec115935}{bendingStrainSize}}  = 3;}
\DoxyCodeLine{64 }
\DoxyCodeLine{74   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST = \textcolor{keywordtype}{double}>}
\DoxyCodeLine{75   \textcolor{keyword}{struct }\mbox{\hyperlink{a01324}{KinematicVariables}}}
\DoxyCodeLine{76   \{}
\DoxyCodeLine{77     Eigen::Matrix<double, 3, 3> \mbox{\hyperlink{a01324_a61d03ac95ddb36ec1dfef4f81cbf62c9}{C}}; }
\DoxyCodeLine{78     Eigen::Vector3<ST> \mbox{\hyperlink{a01324_a04f35f29af27472a062221893635baf2}{epsV}};       }
\DoxyCodeLine{79     Eigen::Vector3<ST> \mbox{\hyperlink{a01324_aa5a298b62041f91aa0c6b1a33a024b67}{kappaV}};     }
\DoxyCodeLine{80     Eigen::Matrix<ST, 2, 3> \mbox{\hyperlink{a01324_ac3e1caec6ac3f5e9d02b8586442b1c45}{j}};     }
\DoxyCodeLine{81     Eigen::Matrix<double, 2, 3> \mbox{\hyperlink{a01324_a9e450cf385c85e1b5fd668e9c537d714}{J}}; }
\DoxyCodeLine{82     Eigen::Matrix3<ST> \mbox{\hyperlink{a01324_a054455a2b5568e3ad24f193f91998bf1}{h}};          }
\DoxyCodeLine{83     Eigen::Matrix3<double> \mbox{\hyperlink{a01324_a9ad4b1bfb856982add427cd254af2803}{H}};      }
\DoxyCodeLine{84     Eigen::Vector3<ST> \mbox{\hyperlink{a01324_ab9c6c5cb909f6eb6b83eddc740ad46c6}{a3N}};        }
\DoxyCodeLine{85     Eigen::Vector3<ST> \mbox{\hyperlink{a01324_a595e8f943beeb8245029bc48fc01a22a}{a3}};         }
\DoxyCodeLine{86   \};}
\DoxyCodeLine{87 }
\DoxyCodeLine{104   \textcolor{keyword}{template} <\textcolor{keyword}{typename} VolumeLoad = utils::LoadDefault, \textcolor{keyword}{typename} NeumannBoundaryLoad = utils::LoadDefault>}
\DoxyCodeLine{105   \mbox{\hyperlink{a01320_a915cc53cbd03163971187078fb392eb6}{KirchhoffLoveShell}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01320_ad68761e004008383ae750126279cc018}{BasisHandler}}\& basisHandler, \textcolor{keyword}{const} \textcolor{keyword}{typename} LocalView::Element\& element, \textcolor{keywordtype}{double} emod,}
\DoxyCodeLine{106                      \textcolor{keywordtype}{double} nu, \textcolor{keywordtype}{double} thickness, VolumeLoad volumeLoad = \{\},}
\DoxyCodeLine{107                      \textcolor{keyword}{const} BoundaryPatch<GridView>* neumannBoundary = \textcolor{keyword}{nullptr},}
\DoxyCodeLine{108                      NeumannBoundaryLoad neumannBoundaryLoad        = \{\})}
\DoxyCodeLine{109       : \mbox{\hyperlink{a01320_aab0fedb95329518f6fcc2afb960386a4}{Base}}(basisHandler, element),}
\DoxyCodeLine{110         \mbox{\hyperlink{a01320_a03bfb93b3d71a2de4d7d398796187435}{VolumeType}}(volumeLoad),}
\DoxyCodeLine{111         \mbox{\hyperlink{a01320_aaebdbf02eef9ecad3551efa605f45c67}{TractionType}}(neumannBoundary, neumannBoundaryLoad),}
\DoxyCodeLine{112         emod\_\{emod\},}
\DoxyCodeLine{113         nu\_\{nu\},}
\DoxyCodeLine{114         thickness\_\{thickness\} \{}
\DoxyCodeLine{115     \textcolor{keyword}{auto}\& firstChild = this-\/>\mbox{\hyperlink{a01232_a53a30773e643a5bc8709ae74a2ba68d3}{localView}}().tree().child(0);}
\DoxyCodeLine{116     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& fe   = firstChild.finiteElement();}
\DoxyCodeLine{117     geo\_             = std::make\_shared<const Geometry>(this-\/>\mbox{\hyperlink{a01232_a53a30773e643a5bc8709ae74a2ba68d3}{localView}}().element().\mbox{\hyperlink{a01320_a9434af373959292616fa3672dd8464d2}{geometry}}());}
\DoxyCodeLine{118     numberOfNodes\_   = fe.size();}
\DoxyCodeLine{119     order\_           = 2 * (fe.localBasis().order());}
\DoxyCodeLine{120     localBasis\_      = Dune::CachedLocalBasis(fe.localBasis());}
\DoxyCodeLine{121     \textcolor{keywordflow}{if} \textcolor{keyword}{constexpr} (\textcolor{keyword}{requires} \{ this-\/>\mbox{\hyperlink{a01232_a53a30773e643a5bc8709ae74a2ba68d3}{localView}}().element().impl().getQuadratureRule(order\_); \})}
\DoxyCodeLine{122       \textcolor{keywordflow}{if} (this-\/>\mbox{\hyperlink{a01232_a53a30773e643a5bc8709ae74a2ba68d3}{localView}}().element().impl().isTrimmed())}
\DoxyCodeLine{123         localBasis\_.bind(this-\/>localView().element().impl().getQuadratureRule(order\_), Dune::bindDerivatives(0, 1, 2));}
\DoxyCodeLine{124       \textcolor{keywordflow}{else}}
\DoxyCodeLine{125         localBasis\_.bind(Dune::QuadratureRules<double, myDim>::rule(this-\/>\mbox{\hyperlink{a01232_a53a30773e643a5bc8709ae74a2ba68d3}{localView}}().element().type(), order\_),}
\DoxyCodeLine{126                          Dune::bindDerivatives(0, 1, 2));}
\DoxyCodeLine{127     \textcolor{keywordflow}{else}}
\DoxyCodeLine{128       localBasis\_.bind(Dune::QuadratureRules<double, myDim>::rule(this-\/>\mbox{\hyperlink{a01232_a53a30773e643a5bc8709ae74a2ba68d3}{localView}}().element().type(), order\_),}
\DoxyCodeLine{129                        Dune::bindDerivatives(0, 1, 2));}
\DoxyCodeLine{130   \}}
\DoxyCodeLine{131 }
\DoxyCodeLine{132 \textcolor{keyword}{public}:}
\DoxyCodeLine{143   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST = \textcolor{keywordtype}{double}>}
\DoxyCodeLine{144   \textcolor{keyword}{auto} \mbox{\hyperlink{a01320_aeaa107c0adc4ef1d6da300b6445f6a62}{displacementFunction}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01320_a3e8403ae17986b426fea60cbe9ed8423}{FERequirementType}}\& par,}
\DoxyCodeLine{145                             \textcolor{keyword}{const} std::optional<\textcolor{keyword}{const} Eigen::VectorX<ST>>\& dx = std::nullopt)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{146     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& d = par.getGlobalSolution(\mbox{\hyperlink{a00315_ggaea763c94a1cecbeefc4f8661debcc5a3a0c2d35f5f278a229db5ba41d40120f1c}{Ikarus::FESolutions::displacement}});}
\DoxyCodeLine{147     \textcolor{keyword}{auto} disp     = Ikarus::FEHelper::localSolutionBlockVector<Traits>(d, this-\/>\mbox{\hyperlink{a01232_a53a30773e643a5bc8709ae74a2ba68d3}{localView}}(), dx);}
\DoxyCodeLine{148     Dune::StandardLocalFunction uFunction(localBasis\_, disp, geo\_);}
\DoxyCodeLine{149     \textcolor{keywordflow}{return} uFunction;}
\DoxyCodeLine{150   \}}
\DoxyCodeLine{151 }
\DoxyCodeLine{152   \textcolor{keyword}{const} \mbox{\hyperlink{a01320_ab9d8cf76b0245c4a6e3907451027bf38}{Geometry}}\& \mbox{\hyperlink{a01320_a9434af373959292616fa3672dd8464d2}{geometry}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} *geo\_; \}}
\DoxyCodeLine{153   [[nodiscard]] \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{a01320_ae562fd15831520b261e4c2120e88135f}{numberOfNodes}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} numberOfNodes\_; \}}
\DoxyCodeLine{154   [[nodiscard]] \textcolor{keywordtype}{int} \mbox{\hyperlink{a01320_a668e27265f67c4db4b01f70d1821124f}{order}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} order\_; \}}
\DoxyCodeLine{155 }
\DoxyCodeLine{164   \textcolor{keywordtype}{double} \mbox{\hyperlink{a01320_aeb40d25fa5f4eb7f97235908f60e4592}{calculateScalar}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01320_a3e8403ae17986b426fea60cbe9ed8423}{FERequirementType}}\& req)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} calculateScalarImpl<double>(req); \}}
\DoxyCodeLine{165 }
\DoxyCodeLine{173   \textcolor{keywordtype}{void} \mbox{\hyperlink{a01320_a1fe5347e0a195c67c23678f47c132b3f}{calculateVector}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01320_a3e8403ae17986b426fea60cbe9ed8423}{FERequirementType}}\& req, \textcolor{keyword}{typename} Traits::template VectorType<> force)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{174     calculateVectorImpl<double>(req, force);}
\DoxyCodeLine{175   \}}
\DoxyCodeLine{183   \textcolor{keywordtype}{void} \mbox{\hyperlink{a01320_a98a89054b165f5590c3515b262bce30f}{calculateMatrix}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01320_a3e8403ae17986b426fea60cbe9ed8423}{FERequirementType}}\& req, \textcolor{keyword}{typename} Traits::template MatrixType<> K)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{184     calculateMatrixImpl<double>(req, K);}
\DoxyCodeLine{185   \}}
\DoxyCodeLine{186 }
\DoxyCodeLine{192   \textcolor{keyword}{template} <\textcolor{keyword}{template} <\textcolor{keyword}{typename}, \textcolor{keywordtype}{int}, \textcolor{keywordtype}{int}> \textcolor{keyword}{class }RT>}
\DoxyCodeLine{193   \textcolor{keyword}{static} \textcolor{keyword}{consteval} \textcolor{keywordtype}{bool} \mbox{\hyperlink{a01320_afdcb8650c777b0cdd6127d8cb54993b8}{canProvideResultType}}() \{}
\DoxyCodeLine{194     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{195   \}}
\DoxyCodeLine{196 }
\DoxyCodeLine{206   \textcolor{keyword}{template} <\textcolor{keyword}{template} <\textcolor{keyword}{typename}, \textcolor{keywordtype}{int}, \textcolor{keywordtype}{int}> \textcolor{keyword}{class }RT>}
\DoxyCodeLine{207   \textcolor{keyword}{requires}(canProvideResultType<RT>())}
\DoxyCodeLine{208   \textcolor{keyword}{auto} \mbox{\hyperlink{a01320_a77fd4b36e8a5c993f562f8d6e108a018}{calculateAt}}([[maybe\_unused]] \textcolor{keyword}{const} \mbox{\hyperlink{a01320_a3e8403ae17986b426fea60cbe9ed8423}{FERequirementType}}\& req,}
\DoxyCodeLine{209                    [[maybe\_unused]] \textcolor{keyword}{const} \mbox{\hyperlink{a01520}{Dune::FieldVector<double, Traits::mydim>}}\& local)}
\DoxyCodeLine{210       -\/> \mbox{\hyperlink{a01276}{ResultWrapper<RT<double, myDim, worldDim>}}, \mbox{\hyperlink{a00328_acfb09bb7db104db62d3d1d2dc3e009b2a57dea6f5039281b7fee517fc43bf3110}{ResultShape::Vector}}> \{}
\DoxyCodeLine{211     DUNE\_THROW(Dune::NotImplemented, \textcolor{stringliteral}{"{}No results are implemented"{}});}
\DoxyCodeLine{212   \}}
\DoxyCodeLine{213 }
\DoxyCodeLine{214 \textcolor{keyword}{private}:}
\DoxyCodeLine{215   std::shared\_ptr<const Geometry> geo\_;}
\DoxyCodeLine{216   Dune::CachedLocalBasis<std::remove\_cvref\_t<LocalBasisType>> localBasis\_;}
\DoxyCodeLine{217   \mbox{\hyperlink{a01364}{DefaultMembraneStrain}} membraneStrain\_;}
\DoxyCodeLine{218   \textcolor{keywordtype}{double} emod\_;}
\DoxyCodeLine{219   \textcolor{keywordtype}{double} nu\_;}
\DoxyCodeLine{220   \textcolor{keywordtype}{double} thickness\_;}
\DoxyCodeLine{221   \textcolor{keywordtype}{size\_t} numberOfNodes\_\{0\};}
\DoxyCodeLine{222   \textcolor{keywordtype}{int} order\_\{\};}
\DoxyCodeLine{223 }
\DoxyCodeLine{224 \textcolor{keyword}{protected}:}
\DoxyCodeLine{244   \textcolor{keyword}{auto} \mbox{\hyperlink{a01320_ace3b4edd51cf93286f7a8b83441537bb}{computeMaterialAndStrains}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01520}{Dune::FieldVector<double, 2>}}\& gpPos, \textcolor{keywordtype}{int} gpIndex, \textcolor{keyword}{const} \mbox{\hyperlink{a01320_ab9d8cf76b0245c4a6e3907451027bf38}{Geometry}}\& geo,}
\DoxyCodeLine{245                                  \textcolor{keyword}{const} \textcolor{keyword}{auto}\& uFunction)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{246     \textcolor{keyword}{using }ST = \textcolor{keyword}{typename} std::remove\_cvref\_t<\textcolor{keyword}{decltype}(uFunction)>::ctype;}
\DoxyCodeLine{247 }
\DoxyCodeLine{248     \mbox{\hyperlink{a01324}{KinematicVariables<ST>}} kin;}
\DoxyCodeLine{249     \textcolor{keyword}{using namespace }\mbox{\hyperlink{a00345}{Dune}};}
\DoxyCodeLine{250     \textcolor{keyword}{using namespace }Dune::DerivativeDirections;}
\DoxyCodeLine{251     \textcolor{keyword}{const} \textcolor{keyword}{auto} [X, Jd, Hd]              = geo\_-\/>impl().zeroFirstAndSecondDerivativeOfPosition(gpPos);}
\DoxyCodeLine{252     kin.J                               = toEigen(Jd);}
\DoxyCodeLine{253     kin.H                               = toEigen(Hd);}
\DoxyCodeLine{254     \textcolor{keyword}{const} Eigen::Matrix<double, 2, 2> A = kin.J * kin.J.transpose();}
\DoxyCodeLine{255     Eigen::Matrix<double, 3, 3> G       = Eigen::Matrix<double, 3, 3>::Zero();}
\DoxyCodeLine{256 }
\DoxyCodeLine{257     G.block<2, 2>(0, 0)                    = A;}
\DoxyCodeLine{258     G(2, 2)                                = 1;}
\DoxyCodeLine{259     \textcolor{keyword}{const} Eigen::Matrix<double, 3, 3> GInv = G.inverse();}
\DoxyCodeLine{260     kin.C                                  = \mbox{\hyperlink{a01320_ad872726b96bf955c86210b75f815df27}{materialTangent}}(GInv);}
\DoxyCodeLine{261 }
\DoxyCodeLine{262     kin.epsV = membraneStrain\_.\mbox{\hyperlink{a01364_ab4ddaa746b858e45fe37237baba4a797}{value}}(gpPos, geo, uFunction);}
\DoxyCodeLine{263 }
\DoxyCodeLine{264     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& Ndd                     = localBasis\_.evaluateSecondDerivatives(gpIndex);}
\DoxyCodeLine{265     \textcolor{keyword}{const} \textcolor{keyword}{auto} uasMatrix                = \mbox{\hyperlink{a00323_gaf9d7cf401f9f03ce1aae728c646ce178}{Dune::viewAsEigenMatrixAsDynFixed}}(uFunction.coefficientsRef());}
\DoxyCodeLine{266     \textcolor{keyword}{const} \textcolor{keyword}{auto} hessianu                 = Ndd.transpose().template cast<ST>() * uasMatrix;}
\DoxyCodeLine{267     kin.h                               = kin.H + hessianu;}
\DoxyCodeLine{268     \textcolor{keyword}{const} Eigen::Matrix<ST, 3, 2> gradu = toEigen(uFunction.evaluateDerivative(}
\DoxyCodeLine{269         gpIndex, Dune::wrt(spatialAll), Dune::on(Dune::DerivativeDirections::referenceElement)));}
\DoxyCodeLine{270     kin.j                               = kin.J + gradu.transpose();}
\DoxyCodeLine{271     kin.a3N                             = (kin.j.row(0).cross(kin.j.row(1)));}
\DoxyCodeLine{272     kin.a3                              = kin.a3N.normalized();}
\DoxyCodeLine{273     Eigen::Vector<ST, 3> bV             = kin.h * kin.a3;}
\DoxyCodeLine{274     bV(2) *= 2; \textcolor{comment}{// Voigt notation requires the two here}}
\DoxyCodeLine{275     \textcolor{keyword}{const} \textcolor{keyword}{auto} BV = \mbox{\hyperlink{a00324_ga4304655095296ce9283e012587817a51}{toVoigt}}(toEigen(geo\_-\/>impl().secondFundamentalForm(gpPos)));}
\DoxyCodeLine{276     kin.kappaV    = BV -\/ bV;}
\DoxyCodeLine{277     \textcolor{keywordflow}{return} kin;}
\DoxyCodeLine{278   \}}
\DoxyCodeLine{279 }
\DoxyCodeLine{280   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST>}
\DoxyCodeLine{281   \textcolor{keywordtype}{void} \mbox{\hyperlink{a01320_aa6b452c8beb9c8b41899486bdefd793b}{calculateMatrixImpl}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01320_a3e8403ae17986b426fea60cbe9ed8423}{FERequirementType}}\& par, \textcolor{keyword}{typename} Traits::template MatrixType<ST> K,}
\DoxyCodeLine{282                            \textcolor{keyword}{const} std::optional<\textcolor{keyword}{const} Eigen::VectorX<ST>>\& dx = std::nullopt)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{283     K.setZero();}
\DoxyCodeLine{284     \textcolor{keyword}{using namespace }Dune::DerivativeDirections;}
\DoxyCodeLine{285     \textcolor{keyword}{using namespace }\mbox{\hyperlink{a00345}{Dune}};}
\DoxyCodeLine{286     \textcolor{keyword}{const} \textcolor{keyword}{auto} uFunction = \mbox{\hyperlink{a01320_aeaa107c0adc4ef1d6da300b6445f6a62}{displacementFunction}}(par, dx);}
\DoxyCodeLine{287     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& lambda   = par.getParameter(\mbox{\hyperlink{a00315_gga0c1577fd05efee8475b0f7fef795bbbeaf72bac0ac84c0315e7bcbb8aa84b2ff8}{FEParameter::loadfactor}});}
\DoxyCodeLine{288 }
\DoxyCodeLine{289     \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}\& [gpIndex, gp] : uFunction.viewOverIntegrationPoints()) \{}
\DoxyCodeLine{290       \textcolor{keyword}{const} \textcolor{keyword}{auto} intElement = geo\_-\/>integrationElement(gp.position()) * gp.weight();}
\DoxyCodeLine{291       \textcolor{keyword}{const} \textcolor{keyword}{auto} [C, epsV, kappaV, jE, J, h, H, a3N, a3] =}
\DoxyCodeLine{292           \mbox{\hyperlink{a01320_ace3b4edd51cf93286f7a8b83441537bb}{computeMaterialAndStrains}}(gp.position(), gpIndex, *geo\_, uFunction);}
\DoxyCodeLine{293       \textcolor{keyword}{const} Eigen::Vector<ST, membraneStrainSize> membraneForces = thickness\_ * C * epsV;}
\DoxyCodeLine{294       \textcolor{keyword}{const} Eigen::Vector<ST, bendingStrainSize> moments         = Dune::power(thickness\_, 3) / 12.0 * C * kappaV;}
\DoxyCodeLine{295 }
\DoxyCodeLine{296       \textcolor{keyword}{const} \textcolor{keyword}{auto}\& Nd  = localBasis\_.evaluateJacobian(gpIndex);}
\DoxyCodeLine{297       \textcolor{keyword}{const} \textcolor{keyword}{auto}\& Ndd = localBasis\_.evaluateSecondDerivatives(gpIndex);}
\DoxyCodeLine{298       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < numberOfNodes\_; ++i) \{}
\DoxyCodeLine{299         Eigen::Matrix<ST, membraneStrainSize, worldDim> bopIMembrane =}
\DoxyCodeLine{300             membraneStrain\_.\mbox{\hyperlink{a01364_af2e92a20898c224f6fe6968f766404b3}{derivative}}(gp.position(), jE, Nd, *geo\_, uFunction, localBasis\_, i);}
\DoxyCodeLine{301 }
\DoxyCodeLine{302         Eigen::Matrix<ST, bendingStrainSize, worldDim> bopIBending = \mbox{\hyperlink{a01320_ad5b032c91b7139faedd27dde5d146aa1}{bopBending}}(jE, h, Nd, Ndd, i, a3N, a3);}
\DoxyCodeLine{303         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} j = i; j < numberOfNodes\_; ++j) \{}
\DoxyCodeLine{304           \textcolor{keyword}{auto} KBlock = K.template block<worldDim, worldDim>(\mbox{\hyperlink{a01320_a9d4092ba09ffa6550b1ae2df556884da}{worldDim}} * i, \mbox{\hyperlink{a01320_a9d4092ba09ffa6550b1ae2df556884da}{worldDim}} * j);}
\DoxyCodeLine{305           Eigen::Matrix<ST, membraneStrainSize, worldDim> bopJMembrane =}
\DoxyCodeLine{306               membraneStrain\_.\mbox{\hyperlink{a01364_af2e92a20898c224f6fe6968f766404b3}{derivative}}(gp.position(), jE, Nd, *geo\_, uFunction, localBasis\_, j);}
\DoxyCodeLine{307           Eigen::Matrix<ST, bendingStrainSize, worldDim> bopJBending = \mbox{\hyperlink{a01320_ad5b032c91b7139faedd27dde5d146aa1}{bopBending}}(jE, h, Nd, Ndd, j, a3N, a3);}
\DoxyCodeLine{308           KBlock += thickness\_ * bopIMembrane.transpose() * C * bopJMembrane * intElement;}
\DoxyCodeLine{309           KBlock += Dune::power(thickness\_, 3) / 12.0 * bopIBending.transpose() * C * bopJBending * intElement;}
\DoxyCodeLine{310 }
\DoxyCodeLine{311           Eigen::Matrix<ST, worldDim, worldDim> kgMembraneIJ =}
\DoxyCodeLine{312               membraneStrain\_.\mbox{\hyperlink{a01364_a3a4c92723db3bf34028b55d9d9ac8d7a}{secondDerivative}}(gp.position(), Nd, *geo\_, uFunction, localBasis\_, membraneForces, i, j);}
\DoxyCodeLine{313           Eigen::Matrix<ST, worldDim, worldDim> kgBendingIJ = \mbox{\hyperlink{a01320_a2862fed3afe54173909821091e762ce2}{kgBending}}(jE, h, Nd, Ndd, a3N, a3, moments, i, j);}
\DoxyCodeLine{314           KBlock += kgMembraneIJ * intElement;}
\DoxyCodeLine{315           KBlock += kgBendingIJ * intElement;}
\DoxyCodeLine{316         \}}
\DoxyCodeLine{317       \}}
\DoxyCodeLine{318     \}}
\DoxyCodeLine{319     K.template triangularView<Eigen::StrictlyLower>() = K.transpose();}
\DoxyCodeLine{320 }
\DoxyCodeLine{321     \textcolor{comment}{// Update due to displacement-\/dependent external loads, e.g., follower loads}}
\DoxyCodeLine{322     \mbox{\hyperlink{a01336_aaed2462e36f9d119ff5c60867ebcaf62}{VolumeType::calculateMatrixImpl}}(par, K, dx);}
\DoxyCodeLine{323     \mbox{\hyperlink{a01332_a38ba7822f8f38691c80a0b607e488d03}{TractionType::calculateMatrixImpl}}(par, K, dx);}
\DoxyCodeLine{324   \}}
\DoxyCodeLine{325 }
\DoxyCodeLine{326   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST>}
\DoxyCodeLine{327   \textcolor{keywordtype}{void} \mbox{\hyperlink{a01320_a6dbd8faca927367f2665a67132cf66d6}{calculateVectorImpl}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01320_a3e8403ae17986b426fea60cbe9ed8423}{FERequirementType}}\& par, \textcolor{keyword}{typename} Traits::template VectorType<ST> force,}
\DoxyCodeLine{328                            \textcolor{keyword}{const} std::optional<\textcolor{keyword}{const} Eigen::VectorX<ST>>\& dx = std::nullopt)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{329     force.setZero();}
\DoxyCodeLine{330     \textcolor{keyword}{using namespace }Dune::DerivativeDirections;}
\DoxyCodeLine{331     \textcolor{keyword}{using namespace }\mbox{\hyperlink{a00345}{Dune}};}
\DoxyCodeLine{332     \textcolor{keyword}{const} \textcolor{keyword}{auto} uFunction = \mbox{\hyperlink{a01320_aeaa107c0adc4ef1d6da300b6445f6a62}{displacementFunction}}(par, dx);}
\DoxyCodeLine{333     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& lambda   = par.getParameter(\mbox{\hyperlink{a00315_gga0c1577fd05efee8475b0f7fef795bbbeaf72bac0ac84c0315e7bcbb8aa84b2ff8}{FEParameter::loadfactor}});}
\DoxyCodeLine{334 }
\DoxyCodeLine{335     \textcolor{comment}{// Internal forces}}
\DoxyCodeLine{336     \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}\& [gpIndex, gp] : uFunction.viewOverIntegrationPoints()) \{}
\DoxyCodeLine{337       \textcolor{keyword}{const} \textcolor{keyword}{auto} [C, epsV, kappaV, jE, J, h, H, a3N, a3] =}
\DoxyCodeLine{338           \mbox{\hyperlink{a01320_ace3b4edd51cf93286f7a8b83441537bb}{computeMaterialAndStrains}}(gp.position(), gpIndex, *geo\_, uFunction);}
\DoxyCodeLine{339       \textcolor{keyword}{const} Eigen::Vector<ST, 3> membraneForces = thickness\_ * C * epsV;}
\DoxyCodeLine{340       \textcolor{keyword}{const} Eigen::Vector<ST, 3> moments        = Dune::power(thickness\_, 3) / 12.0 * C * kappaV;}
\DoxyCodeLine{341 }
\DoxyCodeLine{342       \textcolor{keyword}{const} \textcolor{keyword}{auto}\& Nd  = localBasis\_.evaluateJacobian(gpIndex);}
\DoxyCodeLine{343       \textcolor{keyword}{const} \textcolor{keyword}{auto}\& Ndd = localBasis\_.evaluateSecondDerivatives(gpIndex);}
\DoxyCodeLine{344       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < numberOfNodes\_; ++i) \{}
\DoxyCodeLine{345         Eigen::Matrix<ST, 3, 3> bopIMembrane =}
\DoxyCodeLine{346             membraneStrain\_.\mbox{\hyperlink{a01364_af2e92a20898c224f6fe6968f766404b3}{derivative}}(gp.position(), jE, Nd, *geo\_, uFunction, localBasis\_, i);}
\DoxyCodeLine{347         Eigen::Matrix<ST, 3, 3> bopIBending = \mbox{\hyperlink{a01320_ad5b032c91b7139faedd27dde5d146aa1}{bopBending}}(jE, h, Nd, Ndd, i, a3N, a3);}
\DoxyCodeLine{348         force.template segment<3>(3 * i) +=}
\DoxyCodeLine{349             bopIMembrane.transpose() * membraneForces * geo\_-\/>integrationElement(gp.position()) * gp.weight();}
\DoxyCodeLine{350         force.template segment<3>(3 * i) +=}
\DoxyCodeLine{351             bopIBending.transpose() * moments * geo\_-\/>integrationElement(gp.position()) * gp.weight();}
\DoxyCodeLine{352       \}}
\DoxyCodeLine{353     \}}
\DoxyCodeLine{354 }
\DoxyCodeLine{355     \textcolor{comment}{// External forces volume forces over the domain}}
\DoxyCodeLine{356     \mbox{\hyperlink{a01336_a9b91a057a51ab4487656d8bd94fdd234}{VolumeType::calculateVectorImpl}}(par, force, dx);}
\DoxyCodeLine{357 }
\DoxyCodeLine{358     \textcolor{comment}{// External forces, boundary forces, i.e., at the Neumann boundary}}
\DoxyCodeLine{359     \mbox{\hyperlink{a01332_aabcfd5d855e2230fe90abb12a1ba8d2b}{TractionType::calculateVectorImpl}}(par, force, dx);}
\DoxyCodeLine{360   \}}
\DoxyCodeLine{361 }
\DoxyCodeLine{362   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST>}
\DoxyCodeLine{363   \textcolor{keyword}{auto} \mbox{\hyperlink{a01320_a3eff5a18382fed4d45da446ad8d9fdb0}{calculateScalarImpl}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01320_a3e8403ae17986b426fea60cbe9ed8423}{FERequirementType}}\& par,}
\DoxyCodeLine{364                            \textcolor{keyword}{const} std::optional<\textcolor{keyword}{const} Eigen::VectorX<ST>>\& dx = std::nullopt) \textcolor{keyword}{const} -\/> ST \{}
\DoxyCodeLine{365     \textcolor{keyword}{using namespace }Dune::DerivativeDirections;}
\DoxyCodeLine{366     \textcolor{keyword}{using namespace }\mbox{\hyperlink{a00345}{Dune}};}
\DoxyCodeLine{367     \textcolor{keyword}{const} \textcolor{keyword}{auto} uFunction = \mbox{\hyperlink{a01320_aeaa107c0adc4ef1d6da300b6445f6a62}{displacementFunction}}(par, dx);}
\DoxyCodeLine{368     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& lambda   = par.getParameter(\mbox{\hyperlink{a00315_gga0c1577fd05efee8475b0f7fef795bbbeaf72bac0ac84c0315e7bcbb8aa84b2ff8}{Ikarus::FEParameter::loadfactor}});}
\DoxyCodeLine{369     ST energy            = 0.0;}
\DoxyCodeLine{370 }
\DoxyCodeLine{371     \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}\& [gpIndex, gp] : uFunction.viewOverIntegrationPoints()) \{}
\DoxyCodeLine{372       \textcolor{keyword}{const} \textcolor{keyword}{auto} [C, epsV, kappaV, j, J, h, H, a3N, a3] =}
\DoxyCodeLine{373           \mbox{\hyperlink{a01320_ace3b4edd51cf93286f7a8b83441537bb}{computeMaterialAndStrains}}(gp.position(), gpIndex, *geo\_, uFunction);}
\DoxyCodeLine{374 }
\DoxyCodeLine{375       \textcolor{keyword}{const} ST membraneEnergy = 0.5 * thickness\_ * epsV.dot(C * epsV);}
\DoxyCodeLine{376       \textcolor{keyword}{const} ST bendingEnergy  = 0.5 * Dune::power(thickness\_, 3) / 12.0 * kappaV.dot(C * kappaV);}
\DoxyCodeLine{377       energy += (membraneEnergy + bendingEnergy) * geo\_-\/>integrationElement(gp.position()) * gp.weight();}
\DoxyCodeLine{378     \}}
\DoxyCodeLine{379 }
\DoxyCodeLine{380     \textcolor{comment}{// External forces volume forces over the domain}}
\DoxyCodeLine{381     energy += \mbox{\hyperlink{a01336_a7ec1326b708d8c08fee05ca7b601f997}{VolumeType::calculateScalarImpl}}(par, dx);}
\DoxyCodeLine{382 }
\DoxyCodeLine{383     \textcolor{comment}{// line or surface loads, i.e., neumann boundary}}
\DoxyCodeLine{384     energy += \mbox{\hyperlink{a01332_a2576d38cb79bb0b5bf59f433fa7c1633}{TractionType::calculateScalarImpl}}(par, dx);}
\DoxyCodeLine{385     \textcolor{keywordflow}{return} energy;}
\DoxyCodeLine{386   \}}
\DoxyCodeLine{387 }
\DoxyCodeLine{388   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST>}
\DoxyCodeLine{389   Eigen::Matrix<ST, 3, 3> \mbox{\hyperlink{a01320_a2862fed3afe54173909821091e762ce2}{kgBending}}(\textcolor{keyword}{const} Eigen::Matrix<ST, 2, 3>\& jcur, \textcolor{keyword}{const} Eigen::Matrix3<ST>\& h, \textcolor{keyword}{const} \textcolor{keyword}{auto}\& dN,}
\DoxyCodeLine{390                                     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& ddN, \textcolor{keyword}{const} Eigen::Vector3<ST>\& a3N, \textcolor{keyword}{const} Eigen::Vector3<ST>\& a3,}
\DoxyCodeLine{391                                     \textcolor{keyword}{const} Eigen::Vector3<ST>\& S, \textcolor{keywordtype}{int} I, \textcolor{keywordtype}{int} J)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{392     Eigen::Matrix<ST, 3, 3> kg;}
\DoxyCodeLine{393     kg.setZero();}
\DoxyCodeLine{394 }
\DoxyCodeLine{395     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& dN1i = dN(I, 0);}
\DoxyCodeLine{396     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& dN1j = dN(J, 0);}
\DoxyCodeLine{397     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& dN2i = dN(I, 1);}
\DoxyCodeLine{398     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& dN2j = dN(J, 1);}
\DoxyCodeLine{399 }
\DoxyCodeLine{400     \textcolor{keyword}{const} Eigen::Matrix<ST, 3, 3> P =}
\DoxyCodeLine{401         1.0 / a3N.norm() * (Eigen::Matrix<double, 3, 3>::Identity() -\/ a3 * a3.transpose());}
\DoxyCodeLine{402 }
\DoxyCodeLine{403     \textcolor{keyword}{const} \textcolor{keyword}{auto} a1dxI = Eigen::Matrix<double, 3, 3>::Identity() *}
\DoxyCodeLine{404                        dN1i; \textcolor{comment}{// the auto here allows the exploitation of the identity matrices,}}
\DoxyCodeLine{405     \textcolor{comment}{// due to Eigen's expression templates}}
\DoxyCodeLine{406     \textcolor{keyword}{const} \textcolor{keyword}{auto} a2dxI                    = Eigen::Matrix<double, 3, 3>::Identity() * dN2i;}
\DoxyCodeLine{407     \textcolor{keyword}{const} \textcolor{keyword}{auto} a1dxJ                    = Eigen::Matrix<double, 3, 3>::Identity() * dN1j;}
\DoxyCodeLine{408     \textcolor{keyword}{const} \textcolor{keyword}{auto} a2dxJ                    = Eigen::Matrix<double, 3, 3>::Identity() * dN2j;}
\DoxyCodeLine{409     \textcolor{keyword}{const} \textcolor{keyword}{auto} a1                       = jcur.row(0);}
\DoxyCodeLine{410     \textcolor{keyword}{const} \textcolor{keyword}{auto} a2                       = jcur.row(1);}
\DoxyCodeLine{411     \textcolor{keyword}{const} Eigen::Matrix<ST, 3, 3> a3NdI = a1dxI.colwise().cross(a2) -\/ a2dxI.colwise().cross(a1);}
\DoxyCodeLine{412     \textcolor{keyword}{const} Eigen::Matrix<ST, 3, 3> a3NdJ = a1dxJ.colwise().cross(a2) -\/ a2dxJ.colwise().cross(a1);}
\DoxyCodeLine{413     Eigen::Matrix<ST, 3, 3> a3dI        = P * a3NdI;}
\DoxyCodeLine{414     Eigen::Matrix<ST, 3, 3> a3dJ        = P * a3NdJ;}
\DoxyCodeLine{415     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 3; ++i) \{}
\DoxyCodeLine{416       \textcolor{keyword}{const} \textcolor{keyword}{auto} a\_albe       = h.row(i).transpose();}
\DoxyCodeLine{417       \textcolor{keyword}{const} \textcolor{keyword}{auto}\& ddNI        = ddN(I, i);}
\DoxyCodeLine{418       \textcolor{keyword}{const} \textcolor{keyword}{auto}\& ddNJ        = ddN(J, i);}
\DoxyCodeLine{419       Eigen::Vector3<ST> vecd = P * a\_albe;}
\DoxyCodeLine{420 }
\DoxyCodeLine{421       Eigen::Matrix<ST, 3, 3> a3Ndd =}
\DoxyCodeLine{422           1.0 / a3N.squaredNorm() *}
\DoxyCodeLine{423           ((3 * a3 * a3.transpose() -\/ Eigen::Matrix<double, 3, 3>::Identity()) * (a3.dot(a\_albe)) -\/}
\DoxyCodeLine{424            a\_albe * a3.transpose() -\/ a3 * a\_albe.transpose());}
\DoxyCodeLine{425 }
\DoxyCodeLine{426       Eigen::Matrix<ST, 3, 3> secondDerivativeDirectorIJ = \mbox{\hyperlink{a00323_ga1496a9776a583f8b09c4244a68453394}{skew}}(((dN2i * dN1j -\/ dN1i * dN2j) * vecd).eval());}
\DoxyCodeLine{427       kg -\/= (a3NdI.transpose() * a3Ndd * a3NdJ + secondDerivativeDirectorIJ + (ddNI * a3dJ + ddNJ * a3dI.transpose())) *}
\DoxyCodeLine{428             S[i] * (i == 2 ? 2 : 1);}
\DoxyCodeLine{429     \}}
\DoxyCodeLine{430 }
\DoxyCodeLine{431     \textcolor{keywordflow}{return} kg;}
\DoxyCodeLine{432   \}}
\DoxyCodeLine{433 }
\DoxyCodeLine{434   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST>}
\DoxyCodeLine{435   Eigen::Matrix<ST, 3, 3> \mbox{\hyperlink{a01320_ad5b032c91b7139faedd27dde5d146aa1}{bopBending}}(\textcolor{keyword}{const} Eigen::Matrix<ST, 2, 3>\& jcur, \textcolor{keyword}{const} Eigen::Matrix3<ST>\& h, \textcolor{keyword}{const} \textcolor{keyword}{auto}\& dN,}
\DoxyCodeLine{436                                      \textcolor{keyword}{const} \textcolor{keyword}{auto}\& ddN, \textcolor{keyword}{const} \textcolor{keywordtype}{int} node, \textcolor{keyword}{const} Eigen::Vector3<ST>\& a3N,}
\DoxyCodeLine{437                                      \textcolor{keyword}{const} Eigen::Vector3<ST>\& a3)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{438     \textcolor{keyword}{const} Eigen::Matrix<ST, 3, 3> a1dxI =}
\DoxyCodeLine{439         Eigen::Matrix<double, 3, 3>::Identity() * dN(node, 0); \textcolor{comment}{// this should be double}}
\DoxyCodeLine{440     \textcolor{comment}{// but the cross-\/product below complains otherwise}}
\DoxyCodeLine{441     \textcolor{keyword}{const} Eigen::Matrix<ST, 3, 3> a2dxI = Eigen::Matrix<double, 3, 3>::Identity() * dN(node, 1);}
\DoxyCodeLine{442     \textcolor{keyword}{const} \textcolor{keyword}{auto} a1                       = jcur.row(0);}
\DoxyCodeLine{443     \textcolor{keyword}{const} \textcolor{keyword}{auto} a2                       = jcur.row(1);}
\DoxyCodeLine{444     \textcolor{keyword}{const} Eigen::Matrix<ST, 3, 3> a3NdI =}
\DoxyCodeLine{445         a1dxI.colwise().cross(a2) -\/ a2dxI.colwise().cross(a1); \textcolor{comment}{// minus needed since order has}}
\DoxyCodeLine{446     \textcolor{comment}{// to be swapped to get column-\/wise cross product working}}
\DoxyCodeLine{447     \textcolor{keyword}{const} Eigen::Matrix<ST, 3, 3> a3d1 =}
\DoxyCodeLine{448         1.0 / a3N.norm() * (Eigen::Matrix<double, 3, 3>::Identity() -\/ a3 * a3.transpose()) * a3NdI;}
\DoxyCodeLine{449 }
\DoxyCodeLine{450     Eigen::Matrix<ST, 3, 3> bop = -\/(h * a3d1 + (a3 * ddN.row(node)).\mbox{\hyperlink{a00328_ac2c6469be19ce4ef2e630bfa1c5a5e24}{transpose}}());}
\DoxyCodeLine{451     bop.row(2) *= 2;}
\DoxyCodeLine{452 }
\DoxyCodeLine{453     \textcolor{keywordflow}{return} bop;}
\DoxyCodeLine{454   \}}
\DoxyCodeLine{455 }
\DoxyCodeLine{456   Eigen::Matrix<double, 3, 3> \mbox{\hyperlink{a01320_ad872726b96bf955c86210b75f815df27}{materialTangent}}(\textcolor{keyword}{const} Eigen::Matrix<double, 3, 3>\& Aconv)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{457     \textcolor{keyword}{const} \textcolor{keywordtype}{double} lambda   = emod\_ * nu\_ / ((1.0 + nu\_) * (1.0 -\/ 2.0 * nu\_));}
\DoxyCodeLine{458     \textcolor{keyword}{const} \textcolor{keywordtype}{double} mu       = emod\_ / (2.0 * (1.0 + nu\_));}
\DoxyCodeLine{459     \textcolor{keyword}{const} \textcolor{keywordtype}{double} lambdbar = 2.0 * lambda * mu / (lambda + 2.0 * mu);}
\DoxyCodeLine{460     Eigen::TensorFixedSize<double, Eigen::Sizes<3, 3, 3, 3>> moduli;}
\DoxyCodeLine{461     \textcolor{keyword}{const} \textcolor{keyword}{auto} AconvT = \mbox{\hyperlink{a00324_ga5cfd9d098384fb067d897b3c0499b447}{tensorView}}(Aconv, std::array<Eigen::Index, 2>(\{3, 3\}));}
\DoxyCodeLine{462     moduli = lambdbar * \mbox{\hyperlink{a00324_gab2cea9ac847cc3635812467c9d96ceb4}{dyadic}}(AconvT, AconvT).eval() + 2.0 * mu * symmetricFourthOrder<double>(Aconv, Aconv);}
\DoxyCodeLine{463 }
\DoxyCodeLine{464     \textcolor{keyword}{auto} C                          = \mbox{\hyperlink{a00324_ga4304655095296ce9283e012587817a51}{toVoigt}}(moduli);}
\DoxyCodeLine{465     Eigen::Matrix<double, 3, 3> C33 = C(\{0, 1, 5\}, \{0, 1, 5\});}
\DoxyCodeLine{466     \textcolor{keywordflow}{return} C33;}
\DoxyCodeLine{467   \}}
\DoxyCodeLine{468 \};}
\DoxyCodeLine{469 \} \textcolor{comment}{// namespace Ikarus}}

\end{DoxyCode}
