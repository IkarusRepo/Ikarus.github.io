\hypertarget{a00263_source}{}\doxysection{fehelper.\+hh}
\label{a00263_source}\index{fehelper.hh@{fehelper.hh}}
\mbox{\hyperlink{a00263}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// SPDX-\/FileCopyrightText: 2021-\/2024 The Ikarus Developers mueller@ibb.uni-\/stuttgart.de}}
\DoxyCodeLine{2 \textcolor{comment}{// SPDX-\/License-\/Identifier: LGPL-\/3.0-\/or-\/later}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{5 }
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include <dune/localfefunctions/manifolds/realTuple.hh>}}
\DoxyCodeLine{7 }
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00005}{ikarus/utils/traversal.hh}}>}}
\DoxyCodeLine{9 }
\DoxyCodeLine{10 \textcolor{keyword}{namespace }\mbox{\hyperlink{a00328}{Ikarus::FEHelper}} \{}
\DoxyCodeLine{23 \textcolor{keyword}{template} <\textcolor{keyword}{typename} Traits, \textcolor{keyword}{typename} ST>}
\DoxyCodeLine{24 \textcolor{keyword}{auto} \mbox{\hyperlink{a00328_a98c9e3d7c5cc47d0c177684a18a41bd5}{localSolutionBlockVector}}(\textcolor{keyword}{const} \textcolor{keyword}{typename} Traits::FERequirementType::SolutionVectorTypeRaw\& x,}
\DoxyCodeLine{25                               \textcolor{keyword}{const} \textcolor{keyword}{typename} Traits::LocalView\& localView,}
\DoxyCodeLine{26                               \textcolor{keyword}{const} std::optional<\textcolor{keyword}{const} Eigen::VectorX<ST>>\& dx = std::nullopt) \{}
\DoxyCodeLine{27   \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} worldDim = Traits::worlddim;}
\DoxyCodeLine{28   \textcolor{keyword}{const} \textcolor{keyword}{auto}\& fe         = localView.tree().child(0).finiteElement();}
\DoxyCodeLine{29   Dune::BlockVector<Dune::RealTuple<ST, worldDim>> localX(fe.size());}
\DoxyCodeLine{30   \textcolor{keywordflow}{if} (dx)}
\DoxyCodeLine{31     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} i = 0U; i < localX.size(); ++i)}
\DoxyCodeLine{32       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} j = 0U; j < worldDim; ++j)}
\DoxyCodeLine{33         localX[i][j] = dx.value()[i * worldDim + j] + x[localView.index(localView.tree().child(j).localIndex(i))[0]];}
\DoxyCodeLine{34   \textcolor{keywordflow}{else}}
\DoxyCodeLine{35     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} i = 0U; i < localX.size(); ++i)}
\DoxyCodeLine{36       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} j = 0U; j < worldDim; ++j)}
\DoxyCodeLine{37         localX[i][j] = x[localView.index(localView.tree().child(j).localIndex(i))[0]];}
\DoxyCodeLine{38   \textcolor{keywordflow}{return} localX;}
\DoxyCodeLine{39 \}}
\DoxyCodeLine{40 }
\DoxyCodeLine{41 \textcolor{keyword}{namespace }Impl \{}
\DoxyCodeLine{52   \textcolor{keyword}{template} <\textcolor{keyword}{typename} LocalView, \textcolor{keyword}{typename} Node>}
\DoxyCodeLine{53   \textcolor{keywordtype}{void} leafNodeIndices(\textcolor{keyword}{const} LocalView\& localView, \textcolor{keyword}{const} Node\& node,}
\DoxyCodeLine{54                        std::vector<typename LocalView::MultiIndex>\& \mbox{\hyperlink{a00328_a44e16df41148f7e4538be224814a3423}{globalIndices}}) \{}
\DoxyCodeLine{55     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& fe = node.finiteElement();}
\DoxyCodeLine{56     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < fe.size(); ++i)}
\DoxyCodeLine{57       \mbox{\hyperlink{a00328_a44e16df41148f7e4538be224814a3423}{globalIndices}}.push\_back(localView.index(node.localIndex(i)));}
\DoxyCodeLine{58   \}}
\DoxyCodeLine{59 }
\DoxyCodeLine{70   \textcolor{keyword}{template} <\textcolor{keyword}{typename} LocalView, \textcolor{keyword}{typename} Node>}
\DoxyCodeLine{71   \textcolor{keywordtype}{void} powerNodeIndices(\textcolor{keyword}{const} LocalView\& localView, \textcolor{keyword}{const} Node\& node,}
\DoxyCodeLine{72                         std::vector<typename LocalView::MultiIndex>\& \mbox{\hyperlink{a00328_a44e16df41148f7e4538be224814a3423}{globalIndices}}) \{}
\DoxyCodeLine{73     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& fe         = node.child(0).finiteElement();}
\DoxyCodeLine{74     \textcolor{keyword}{const} \textcolor{keywordtype}{int} childrenSize = node.degree();}
\DoxyCodeLine{75     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < fe.size(); ++i)}
\DoxyCodeLine{76       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < childrenSize; ++j)}
\DoxyCodeLine{77         \mbox{\hyperlink{a00328_a44e16df41148f7e4538be224814a3423}{globalIndices}}.push\_back(localView.index(node.child(j).localIndex(i)));}
\DoxyCodeLine{78   \}}
\DoxyCodeLine{79 \} \textcolor{comment}{// namespace Impl}}
\DoxyCodeLine{80 }
\DoxyCodeLine{89 \textcolor{keyword}{template} <\textcolor{keyword}{typename} LocalView>}
\DoxyCodeLine{90 \textcolor{keywordtype}{void} \mbox{\hyperlink{a00328_a2a4ac5503d4288b339457aae427ff661}{globalIndicesFromLocalView}}(\textcolor{keyword}{const} LocalView\& localView,}
\DoxyCodeLine{91                                 std::vector<typename LocalView::MultiIndex>\& \mbox{\hyperlink{a00328_a44e16df41148f7e4538be224814a3423}{globalIndices}}) \{}
\DoxyCodeLine{92   \mbox{\hyperlink{a00328_a44e16df41148f7e4538be224814a3423}{globalIndices}}.clear();}
\DoxyCodeLine{93   \textcolor{keyword}{using namespace }Dune::Indices;}
\DoxyCodeLine{94   \textcolor{keyword}{using namespace }FEHelper::Impl;}
\DoxyCodeLine{95 }
\DoxyCodeLine{96   \textcolor{keyword}{auto} leafOpFunc = [\&](\textcolor{keyword}{auto}\&\& node, [[maybe\_unused]] \textcolor{keyword}{auto}\&\& treePath) \{}
\DoxyCodeLine{97     leafNodeIndices(localView, node, \mbox{\hyperlink{a00328_a44e16df41148f7e4538be224814a3423}{globalIndices}});}
\DoxyCodeLine{98   \};}
\DoxyCodeLine{99 }
\DoxyCodeLine{100   \textcolor{keyword}{auto} powerOpFunc = [\&](\textcolor{keyword}{auto}\&\& node, [[maybe\_unused]] \textcolor{keyword}{auto}\&\& treePath) \{}
\DoxyCodeLine{101     powerNodeIndices(localView, node, \mbox{\hyperlink{a00328_a44e16df41148f7e4538be224814a3423}{globalIndices}});}
\DoxyCodeLine{102   \};}
\DoxyCodeLine{103 }
\DoxyCodeLine{104   \mbox{\hyperlink{a00336_a63742d75d099b93da7ddf6e78a3c1f56}{utils::forEachLeafOrPowerLeafNode}}(localView.tree(), Dune::TypeTree::hybridTreePath(), powerOpFunc, leafOpFunc);}
\DoxyCodeLine{105 \}}
\DoxyCodeLine{106 }
\DoxyCodeLine{118 \textcolor{keyword}{template} <\textcolor{keyword}{typename} FiniteElement>}
\DoxyCodeLine{119 \textcolor{keywordtype}{void} \mbox{\hyperlink{a00328_a44e16df41148f7e4538be224814a3423}{globalIndices}}(\textcolor{keyword}{const} FiniteElement\& fe, std::vector<typename FiniteElement::LocalView::MultiIndex>\& \mbox{\hyperlink{a00328_a44e16df41148f7e4538be224814a3423}{globalIndices}}) \{}
\DoxyCodeLine{120   \mbox{\hyperlink{a00328_a2a4ac5503d4288b339457aae427ff661}{globalIndicesFromLocalView}}(fe.localView(), \mbox{\hyperlink{a00328_a44e16df41148f7e4538be224814a3423}{globalIndices}});}
\DoxyCodeLine{121 \}}
\DoxyCodeLine{122 \} \textcolor{comment}{// namespace Ikarus::FEHelper}}

\end{DoxyCode}
