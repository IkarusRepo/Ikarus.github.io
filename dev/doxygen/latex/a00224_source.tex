\hypertarget{a00224_source}{}\doxysection{eas2d.\+hh}
\label{a00224_source}\index{eas2d.hh@{eas2d.hh}}
\mbox{\hyperlink{a00224}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// SPDX-\/FileCopyrightText: 2021-\/2024 The Ikarus Developers mueller@ibb.uni-\/stuttgart.de}}
\DoxyCodeLine{2 \textcolor{comment}{// SPDX-\/License-\/Identifier: LGPL-\/3.0-\/or-\/later}}
\DoxyCodeLine{3 }
\DoxyCodeLine{10 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{11 }
\DoxyCodeLine{12 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00020}{ikarus/utils/tensorutils.hh}}>}}
\DoxyCodeLine{13 }
\DoxyCodeLine{14 \textcolor{keyword}{namespace }\mbox{\hyperlink{a00330}{Ikarus::EAS}} \{}
\DoxyCodeLine{15 }
\DoxyCodeLine{25 \textcolor{keyword}{template} <\textcolor{keyword}{typename} GEO>}
\DoxyCodeLine{26 \textcolor{keyword}{struct }\mbox{\hyperlink{a01262}{Q1E4}}}
\DoxyCodeLine{27 \{}
\DoxyCodeLine{28   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} \mbox{\hyperlink{a01262_a31972bc371b0267eb4f04f62f4c88219}{strainSize}}         = 3;}
\DoxyCodeLine{29   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} \mbox{\hyperlink{a01262_ab1a8b1d505b07f61bc8182de7c65d66a}{enhancedStrainSize}} = 4;}
\DoxyCodeLine{30   \textcolor{keyword}{using }\mbox{\hyperlink{a01262_a9d9bcd6fbf0b5560904dc1ab9b872633}{MType}}                             = Eigen::Matrix<double, strainSize, enhancedStrainSize>;}
\DoxyCodeLine{31 }
\DoxyCodeLine{32   \mbox{\hyperlink{a01262_a68eb22d5d7f45fe8c0fed77de62ad799}{Q1E4}}() = \textcolor{keywordflow}{default};}
\DoxyCodeLine{33   \textcolor{keyword}{explicit} \mbox{\hyperlink{a01262_a43ede2403a5e817099bd51ae4f26f8f1}{Q1E4}}(\textcolor{keyword}{const} GEO\& geometry)}
\DoxyCodeLine{34       : geometry\_\{std::make\_shared<GEO>(geometry)\},}
\DoxyCodeLine{35         T0InverseTransformed\_\{\mbox{\hyperlink{a00325_a7a5b9f5e83f6918ca1726fb4316c3b86}{calcTransformationMatrix2D}}(geometry)\} \{\}}
\DoxyCodeLine{36 }
\DoxyCodeLine{37   \textcolor{keyword}{auto} \mbox{\hyperlink{a01262_a03e4a1b446ffd59d5e15c95fd7291b9f}{calcM}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01370}{Dune::FieldVector<double, 2>}}\& quadPos)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{38     \mbox{\hyperlink{a01262_a9d9bcd6fbf0b5560904dc1ab9b872633}{MType}} M;}
\DoxyCodeLine{39     M.setZero(\mbox{\hyperlink{a01262_a31972bc371b0267eb4f04f62f4c88219}{strainSize}}, \mbox{\hyperlink{a01262_ab1a8b1d505b07f61bc8182de7c65d66a}{enhancedStrainSize}});}
\DoxyCodeLine{40     \textcolor{keyword}{const} \textcolor{keywordtype}{double} xi   = quadPos[0];}
\DoxyCodeLine{41     \textcolor{keyword}{const} \textcolor{keywordtype}{double} eta  = quadPos[1];}
\DoxyCodeLine{42     M(0, 0)           = 2 * xi -\/ 1.0;}
\DoxyCodeLine{43     M(1, 1)           = 2 * eta -\/ 1.0;}
\DoxyCodeLine{44     M(2, 2)           = 2 * xi -\/ 1.0;}
\DoxyCodeLine{45     M(2, 3)           = 2 * eta -\/ 1.0;}
\DoxyCodeLine{46     \textcolor{keyword}{const} \textcolor{keywordtype}{double} detJ = geometry\_-\/>integrationElement(quadPos);}
\DoxyCodeLine{47     M                 = T0InverseTransformed\_ / detJ * M;}
\DoxyCodeLine{48     \textcolor{keywordflow}{return} M;}
\DoxyCodeLine{49   \}}
\DoxyCodeLine{50 }
\DoxyCodeLine{51 \textcolor{keyword}{private}:}
\DoxyCodeLine{52   std::shared\_ptr<GEO> geometry\_;}
\DoxyCodeLine{53   Eigen::Matrix3d T0InverseTransformed\_;}
\DoxyCodeLine{54 \};}
\DoxyCodeLine{55 }
\DoxyCodeLine{63 \textcolor{keyword}{template} <\textcolor{keyword}{typename} GEO>}
\DoxyCodeLine{64 \textcolor{keyword}{struct }\mbox{\hyperlink{a01266}{Q1E5}}}
\DoxyCodeLine{65 \{}
\DoxyCodeLine{66   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} \mbox{\hyperlink{a01266_a70978fa46b16e2d6210cf77d76bead62}{strainSize}}         = 3;}
\DoxyCodeLine{67   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} \mbox{\hyperlink{a01266_ab1a680222be27a73de9204c3881f7ec8}{enhancedStrainSize}} = 5;}
\DoxyCodeLine{68   \textcolor{keyword}{using }\mbox{\hyperlink{a01266_aa19cdd636627ea0efc74bb2c380d6836}{MType}}                             = Eigen::Matrix<double, strainSize, enhancedStrainSize>;}
\DoxyCodeLine{69 }
\DoxyCodeLine{70   \mbox{\hyperlink{a01266_a7bedf208a422c415e0037f898c8ec85a}{Q1E5}}() = \textcolor{keywordflow}{default};}
\DoxyCodeLine{71   \textcolor{keyword}{explicit} \mbox{\hyperlink{a01266_a7a4921dd86b88f516f34cd55accf0629}{Q1E5}}(\textcolor{keyword}{const} GEO\& geometry)}
\DoxyCodeLine{72       : geometry\_\{std::make\_shared<GEO>(geometry)\},}
\DoxyCodeLine{73         T0InverseTransformed\_\{\mbox{\hyperlink{a00325_a7a5b9f5e83f6918ca1726fb4316c3b86}{calcTransformationMatrix2D}}(geometry)\} \{\}}
\DoxyCodeLine{74 }
\DoxyCodeLine{75   \textcolor{keyword}{auto} \mbox{\hyperlink{a01266_a2f5b495d9eabc2e3fcccfee1595e61eb}{calcM}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01370}{Dune::FieldVector<double, 2>}}\& quadPos)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{76     \mbox{\hyperlink{a01266_aa19cdd636627ea0efc74bb2c380d6836}{MType}} M;}
\DoxyCodeLine{77     M.setZero();}
\DoxyCodeLine{78     \textcolor{keyword}{const} \textcolor{keywordtype}{double} xi   = quadPos[0];}
\DoxyCodeLine{79     \textcolor{keyword}{const} \textcolor{keywordtype}{double} eta  = quadPos[1];}
\DoxyCodeLine{80     M(0, 0)           = 2 * xi -\/ 1.0;}
\DoxyCodeLine{81     M(1, 1)           = 2 * eta -\/ 1.0;}
\DoxyCodeLine{82     M(2, 2)           = 2 * xi -\/ 1.0;}
\DoxyCodeLine{83     M(2, 3)           = 2 * eta -\/ 1.0;}
\DoxyCodeLine{84     M(2, 4)           = (2 * xi -\/ 1.0) * (2 * eta -\/ 1.0);}
\DoxyCodeLine{85     \textcolor{keyword}{const} \textcolor{keywordtype}{double} detJ = geometry\_-\/>integrationElement(quadPos);}
\DoxyCodeLine{86     M                 = T0InverseTransformed\_ / detJ * M;}
\DoxyCodeLine{87     \textcolor{keywordflow}{return} M;}
\DoxyCodeLine{88   \}}
\DoxyCodeLine{89 }
\DoxyCodeLine{90 \textcolor{keyword}{private}:}
\DoxyCodeLine{91   std::shared\_ptr<GEO> geometry\_;}
\DoxyCodeLine{92   Eigen::Matrix3d T0InverseTransformed\_;}
\DoxyCodeLine{93 \};}
\DoxyCodeLine{94 }
\DoxyCodeLine{102 \textcolor{keyword}{template} <\textcolor{keyword}{typename} GEO>}
\DoxyCodeLine{103 \textcolor{keyword}{struct }\mbox{\hyperlink{a01270}{Q1E7}}}
\DoxyCodeLine{104 \{}
\DoxyCodeLine{105   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} \mbox{\hyperlink{a01270_a79a495f2932fe90867b44e1f4e92bfd3}{strainSize}}         = 3;}
\DoxyCodeLine{106   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} \mbox{\hyperlink{a01270_a3373c7120dffedafda0be40fa6647c46}{enhancedStrainSize}} = 7;}
\DoxyCodeLine{107   \textcolor{keyword}{using }\mbox{\hyperlink{a01270_a3936fb3159e8887532007a2df1cc3915}{MType}}                             = Eigen::Matrix<double, strainSize, enhancedStrainSize>;}
\DoxyCodeLine{108 }
\DoxyCodeLine{109   \mbox{\hyperlink{a01270_ac320a2701922ade2a114460221fd8897}{Q1E7}}() = \textcolor{keywordflow}{default};}
\DoxyCodeLine{110   \textcolor{keyword}{explicit} \mbox{\hyperlink{a01270_a8db7bc977482fbd9cc783ef8515b3aba}{Q1E7}}(\textcolor{keyword}{const} GEO\& geometry)}
\DoxyCodeLine{111       : geometry\_\{std::make\_shared<GEO>(geometry)\},}
\DoxyCodeLine{112         T0InverseTransformed\_\{\mbox{\hyperlink{a00325_a7a5b9f5e83f6918ca1726fb4316c3b86}{calcTransformationMatrix2D}}(geometry)\} \{\}}
\DoxyCodeLine{113 }
\DoxyCodeLine{114   \textcolor{keyword}{auto} \mbox{\hyperlink{a01270_adee00ef1f4bd1c7db877fb39626b4ed8}{calcM}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01370}{Dune::FieldVector<double, 2>}}\& quadPos)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{115     \mbox{\hyperlink{a01270_a3936fb3159e8887532007a2df1cc3915}{MType}} M;}
\DoxyCodeLine{116     M.setZero();}
\DoxyCodeLine{117     \textcolor{keyword}{const} \textcolor{keywordtype}{double} xi   = quadPos[0];}
\DoxyCodeLine{118     \textcolor{keyword}{const} \textcolor{keywordtype}{double} eta  = quadPos[1];}
\DoxyCodeLine{119     M(0, 0)           = 2 * xi -\/ 1.0;}
\DoxyCodeLine{120     M(1, 1)           = 2 * eta -\/ 1.0;}
\DoxyCodeLine{121     M(2, 2)           = 2 * xi -\/ 1.0;}
\DoxyCodeLine{122     M(2, 3)           = 2 * eta -\/ 1.0;}
\DoxyCodeLine{123     M(0, 4)           = (2 * xi -\/ 1.0) * (2 * eta -\/ 1.0);}
\DoxyCodeLine{124     M(1, 5)           = (2 * xi -\/ 1.0) * (2 * eta -\/ 1.0);}
\DoxyCodeLine{125     M(2, 6)           = (2 * xi -\/ 1.0) * (2 * eta -\/ 1.0);}
\DoxyCodeLine{126     \textcolor{keyword}{const} \textcolor{keywordtype}{double} detJ = geometry\_-\/>integrationElement(quadPos);}
\DoxyCodeLine{127     M                 = T0InverseTransformed\_ / detJ * M;}
\DoxyCodeLine{128     \textcolor{keywordflow}{return} M;}
\DoxyCodeLine{129   \}}
\DoxyCodeLine{130 }
\DoxyCodeLine{131 \textcolor{keyword}{private}:}
\DoxyCodeLine{132   std::shared\_ptr<GEO> geometry\_;}
\DoxyCodeLine{133   Eigen::Matrix3d T0InverseTransformed\_;}
\DoxyCodeLine{134 \};}
\DoxyCodeLine{135 \} \textcolor{comment}{// namespace Ikarus::EAS}}

\end{DoxyCode}
