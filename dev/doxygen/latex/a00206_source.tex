\hypertarget{a00206_source}{}\doxysection{neohooke.\+hh}
\label{a00206_source}\index{neohooke.hh@{neohooke.hh}}
\mbox{\hyperlink{a00206}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// SPDX-\/FileCopyrightText: 2021-\/2024 The Ikarus Developers mueller@ibb.uni-\/stuttgart.de}}
\DoxyCodeLine{2 \textcolor{comment}{// SPDX-\/License-\/Identifier: LGPL-\/3.0-\/or-\/later}}
\DoxyCodeLine{3 }
\DoxyCodeLine{10 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{11 }
\DoxyCodeLine{12 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00209}{ikarus/finiteelements/mechanics/materials/interface.hh}}>}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00044}{ikarus/utils/tensorutils.hh}}>}}
\DoxyCodeLine{14 }
\DoxyCodeLine{15 \textcolor{keyword}{namespace }\mbox{\hyperlink{a00316}{Ikarus}} \{}
\DoxyCodeLine{16 }
\DoxyCodeLine{35 \textcolor{keyword}{template} <\textcolor{keyword}{typename} ScalarType\_>}
\DoxyCodeLine{36 \textcolor{keyword}{struct }\mbox{\hyperlink{a01312}{NeoHookeT}} : \textcolor{keyword}{public} \mbox{\hyperlink{a01304}{Material}}<NeoHookeT<ScalarType\_>>}
\DoxyCodeLine{37 \{}
\DoxyCodeLine{38   [[nodiscard]] \textcolor{keyword}{constexpr} std::string \mbox{\hyperlink{a01312_a437008f3343a4f701fdd4c5e425313ce}{nameImpl}}() const noexcept \{ \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}NeoHooke"{}}; \}}
\DoxyCodeLine{39 }
\DoxyCodeLine{44   \textcolor{keyword}{explicit} \mbox{\hyperlink{a01312_a10eb1792f7a78e2f52c625a01301f5ef}{NeoHookeT}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01356}{LamesFirstParameterAndShearModulus}}\& mpt)}
\DoxyCodeLine{45       : \mbox{\hyperlink{a01312_a65f7f8af8bb74bba74ea19836eceab25}{lambdaAndmu}}\{mpt\} \{\}}
\DoxyCodeLine{46 }
\DoxyCodeLine{47   \textcolor{keyword}{using }\mbox{\hyperlink{a01312_a2c6a3eab38f9a88b18a869d9e66eda53}{ScalarType}}                    = ScalarType\_;}
\DoxyCodeLine{48   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} \mbox{\hyperlink{a01312_a5eebe95a0e13399abd7f26020f0c0f3a}{worldDimension}} = 3;}
\DoxyCodeLine{49   \textcolor{keyword}{using }\mbox{\hyperlink{a01312_a273e05e32f6a9728440ad3da6669ec7a}{StrainMatrix}}                  = Eigen::Matrix<ScalarType, worldDimension, worldDimension>;}
\DoxyCodeLine{50   \textcolor{keyword}{using }\mbox{\hyperlink{a01312_ac8ebe95bef84eb82bf38ed45261f2173}{StressMatrix}}                  = \mbox{\hyperlink{a01312_a273e05e32f6a9728440ad3da6669ec7a}{StrainMatrix}};}
\DoxyCodeLine{51 }
\DoxyCodeLine{52   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{auto} \mbox{\hyperlink{a01312_a505b0b0ada1c096262412fda6a823cef}{strainTag}}          = \mbox{\hyperlink{a00305_ggacef1e451de1a99845c59d7391064fb8faea40a9960a7a89c4f366beeab85d07d2}{StrainTags::rightCauchyGreenTensor}};}
\DoxyCodeLine{53   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{auto} \mbox{\hyperlink{a01312_aa0b04d47fd84e036f8487cf9641abb41}{stressTag}}          = \mbox{\hyperlink{a00305_gga70b4ce43c53cc5e949d49919f437501eab13248d68ac5516c015337b68346fc21}{StressTags::PK2}};}
\DoxyCodeLine{54   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{auto} \mbox{\hyperlink{a01312_ab6adef71801c1e3d9cff0fc522950c1f}{tangentModuliTag}}   = \mbox{\hyperlink{a00305_gga05ac785124262c1e323d2f937d520a1bad92a8333dd3ccb895cc65f7455b71206}{TangentModuliTags::Material}};}
\DoxyCodeLine{55   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{bool} \mbox{\hyperlink{a01312_a39c43bb592cf54c9a2fd3b60c741a252}{energyAcceptsVoigt}} = \textcolor{keyword}{false};}
\DoxyCodeLine{56   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{bool} \mbox{\hyperlink{a01312_a37a9776bddff633282912937c1e737a3}{stressToVoigt}}      = \textcolor{keyword}{false};}
\DoxyCodeLine{57   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{bool} \mbox{\hyperlink{a01312_ada1f302b0b332d6cff1ddfa62ac72871}{stressAcceptsVoigt}} = \textcolor{keyword}{false};}
\DoxyCodeLine{58   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{bool} \mbox{\hyperlink{a01312_ad72e02a26d4a3b6d8d29f6341a15952a}{moduliToVoigt}}      = \textcolor{keyword}{false};}
\DoxyCodeLine{59   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{bool} \mbox{\hyperlink{a01312_a0f1786af1344f46596f6e58babd87543}{moduliAcceptsVoigt}} = \textcolor{keyword}{false};}
\DoxyCodeLine{60   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{double} \mbox{\hyperlink{a01312_a38a89c3043d1eaa77d3a743b89a99480}{derivativeFactor}} = 2;}
\DoxyCodeLine{61 }
\DoxyCodeLine{68   \textcolor{keyword}{template} <\textcolor{keyword}{typename} Derived>}
\DoxyCodeLine{69   \mbox{\hyperlink{a01312_a2c6a3eab38f9a88b18a869d9e66eda53}{ScalarType}} \mbox{\hyperlink{a01312_a49da0bb7428a0cf780cdcad97ec97b74}{storedEnergyImpl}}(\textcolor{keyword}{const} Eigen::MatrixBase<Derived>\& C) \textcolor{keyword}{const} \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{70     \textcolor{keyword}{static\_assert}(Concepts::EigenMatrixOrVoigtNotation3<Derived>);}
\DoxyCodeLine{71     \textcolor{keywordflow}{if} \textcolor{keyword}{constexpr} (!\mbox{\hyperlink{a01638}{Concepts::EigenVector<Derived>}}) \{}
\DoxyCodeLine{72       \textcolor{keyword}{const} \textcolor{keyword}{auto} traceC  = C.trace();}
\DoxyCodeLine{73       \textcolor{keyword}{const} \textcolor{keyword}{auto} logdetF = log(sqrt(C.determinant()));}
\DoxyCodeLine{74       \textcolor{keywordflow}{return} \mbox{\hyperlink{a01312_a65f7f8af8bb74bba74ea19836eceab25}{lambdaAndmu}}.\mbox{\hyperlink{a01356_a3558ad06d2a831f0d412d76956d516f8}{mu}} / 2.0 * (traceC -\/ 3 -\/ 2 * logdetF) + \mbox{\hyperlink{a01312_a65f7f8af8bb74bba74ea19836eceab25}{lambdaAndmu}}.\mbox{\hyperlink{a01356_a0157695e9fc8b735e86f828cc35b64fc}{lambda}} / 2.0 * logdetF * logdetF;}
\DoxyCodeLine{75     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{76       \textcolor{keyword}{static\_assert}(!\mbox{\hyperlink{a01638}{Concepts::EigenVector<Derived>}},}
\DoxyCodeLine{77                     \textcolor{stringliteral}{"{}NeoHooke energy can only be called with a matrix and not a vector in Voigt notation"{}});}
\DoxyCodeLine{78   \}}
\DoxyCodeLine{79 }
\DoxyCodeLine{87   \textcolor{keyword}{template} <\textcolor{keywordtype}{bool} voigt, \textcolor{keyword}{typename} Derived>}
\DoxyCodeLine{88   \textcolor{keyword}{auto} \mbox{\hyperlink{a01312_a2cfcf4034eb9e07c06829785ea92c3f4}{stressesImpl}}(\textcolor{keyword}{const} Eigen::MatrixBase<Derived>\& C)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{89     \textcolor{keyword}{static\_assert}(Concepts::EigenMatrixOrVoigtNotation3<Derived>);}
\DoxyCodeLine{90     \textcolor{keywordflow}{if} \textcolor{keyword}{constexpr} (!voigt) \{}
\DoxyCodeLine{91       \textcolor{keywordflow}{if} \textcolor{keyword}{constexpr} (!\mbox{\hyperlink{a01638}{Concepts::EigenVector<Derived>}}) \{}
\DoxyCodeLine{92         \textcolor{keyword}{const} \textcolor{keyword}{auto} logdetF = log(sqrt(C.determinant()));}
\DoxyCodeLine{93         \textcolor{keyword}{const} \textcolor{keyword}{auto} invC    = C.inverse().eval();}
\DoxyCodeLine{94         \textcolor{keywordflow}{return} (\mbox{\hyperlink{a01312_a65f7f8af8bb74bba74ea19836eceab25}{lambdaAndmu}}.\mbox{\hyperlink{a01356_a3558ad06d2a831f0d412d76956d516f8}{mu}} * (StrainMatrix::Identity() -\/ invC) + \mbox{\hyperlink{a01312_a65f7f8af8bb74bba74ea19836eceab25}{lambdaAndmu}}.\mbox{\hyperlink{a01356_a0157695e9fc8b735e86f828cc35b64fc}{lambda}} * logdetF * invC).eval();}
\DoxyCodeLine{95       \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{96         \textcolor{keyword}{static\_assert}(!\mbox{\hyperlink{a01638}{Concepts::EigenVector<Derived>}},}
\DoxyCodeLine{97                       \textcolor{stringliteral}{"{}NeoHooke can only be called with a matrix and not a vector in Voigt notation"{}});}
\DoxyCodeLine{98     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{99       \textcolor{keyword}{static\_assert}(voigt == \textcolor{keyword}{false}, \textcolor{stringliteral}{"{}NeoHooke does not support returning stresses in Voigt notation"{}});}
\DoxyCodeLine{100   \}}
\DoxyCodeLine{101 }
\DoxyCodeLine{109   \textcolor{keyword}{template} <\textcolor{keywordtype}{bool} voigt, \textcolor{keyword}{typename} Derived>}
\DoxyCodeLine{110   \textcolor{keyword}{auto} \mbox{\hyperlink{a01312_aec2dfac0aca87f7998a0f0c2b3b63133}{tangentModuliImpl}}(\textcolor{keyword}{const} Eigen::MatrixBase<Derived>\& C)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{111     \textcolor{keyword}{static\_assert}(Concepts::EigenMatrixOrVoigtNotation3<Derived>);}
\DoxyCodeLine{112     \textcolor{keywordflow}{if} \textcolor{keyword}{constexpr} (!voigt) \{}
\DoxyCodeLine{113       \textcolor{keyword}{const} \textcolor{keyword}{auto} invC    = C.inverse().eval();}
\DoxyCodeLine{114       \textcolor{keyword}{const} \textcolor{keyword}{auto} logdetF = log(sqrt(C.determinant()));}
\DoxyCodeLine{115       \textcolor{keyword}{const} \textcolor{keyword}{auto} CTinv   = \mbox{\hyperlink{a00312_ga5cfd9d098384fb067d897b3c0499b447}{tensorView}}(invC, std::array<Eigen::Index, 2>(\{3, 3\}));}
\DoxyCodeLine{116       \textcolor{keyword}{static\_assert}(Eigen::TensorFixedSize<ScalarType, Eigen::Sizes<3, 3>>::NumIndices == 2);}
\DoxyCodeLine{117       Eigen::TensorFixedSize<ScalarType, Eigen::Sizes<3, 3, 3, 3>> moduli =}
\DoxyCodeLine{118           (\mbox{\hyperlink{a01312_a65f7f8af8bb74bba74ea19836eceab25}{lambdaAndmu}}.\mbox{\hyperlink{a01356_a0157695e9fc8b735e86f828cc35b64fc}{lambda}} * \mbox{\hyperlink{a00312_gab2cea9ac847cc3635812467c9d96ceb4}{dyadic}}(CTinv, CTinv) +}
\DoxyCodeLine{119            2 * (\mbox{\hyperlink{a01312_a65f7f8af8bb74bba74ea19836eceab25}{lambdaAndmu}}.\mbox{\hyperlink{a01356_a3558ad06d2a831f0d412d76956d516f8}{mu}} -\/ \mbox{\hyperlink{a01312_a65f7f8af8bb74bba74ea19836eceab25}{lambdaAndmu}}.\mbox{\hyperlink{a01356_a0157695e9fc8b735e86f828cc35b64fc}{lambda}} * logdetF) * \mbox{\hyperlink{a00312_gaea03dbfcd8f85ef7af004c7e09244aa9}{symTwoSlots}}(\mbox{\hyperlink{a00312_ga8fa2b440586483c1ee0f9b90b9081da2}{fourthOrderIKJL}}(invC, invC), \{2, 3\}))}
\DoxyCodeLine{120               .eval();}
\DoxyCodeLine{121       \textcolor{keywordflow}{return} moduli;}
\DoxyCodeLine{122     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{123       \textcolor{keyword}{static\_assert}(voigt == \textcolor{keyword}{false}, \textcolor{stringliteral}{"{}NeoHooke does not support returning tangent moduli in Voigt notation"{}});}
\DoxyCodeLine{124   \}}
\DoxyCodeLine{125 }
\DoxyCodeLine{131   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ScalarTypeOther>}
\DoxyCodeLine{132   \textcolor{keyword}{auto} \mbox{\hyperlink{a01312_a5d32fe6c728cb508b20bc11099baf6a1}{rebind}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{133     \textcolor{keywordflow}{return} \mbox{\hyperlink{a01312}{NeoHookeT<ScalarTypeOther>}}(\mbox{\hyperlink{a01312_a65f7f8af8bb74bba74ea19836eceab25}{lambdaAndmu}});}
\DoxyCodeLine{134   \}}
\DoxyCodeLine{135 }
\DoxyCodeLine{136   \mbox{\hyperlink{a01356}{LamesFirstParameterAndShearModulus}} \mbox{\hyperlink{a01312_a65f7f8af8bb74bba74ea19836eceab25}{lambdaAndmu}};}
\DoxyCodeLine{137 \};}
\DoxyCodeLine{138 }
\DoxyCodeLine{142 \textcolor{keyword}{typedef} \mbox{\hyperlink{a01312}{NeoHookeT<double>}} \mbox{\hyperlink{a00316_a8d5cb9f5246159271193458daad08fdd}{NeoHooke}};}
\DoxyCodeLine{143 }
\DoxyCodeLine{144 \} \textcolor{comment}{// namespace Ikarus}}

\end{DoxyCode}
