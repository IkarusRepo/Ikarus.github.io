\hypertarget{a00161_source}{}\doxysection{kirchhoffloveshell.\+hh}
\label{a00161_source}\index{kirchhoffloveshell.hh@{kirchhoffloveshell.hh}}
\mbox{\hyperlink{a00161}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// SPDX-\/FileCopyrightText: 2021-\/2024 The Ikarus Developers mueller@ibb.uni-\/stuttgart.de}}
\DoxyCodeLine{2 \textcolor{comment}{// SPDX-\/License-\/Identifier: LGPL-\/3.0-\/or-\/later}}
\DoxyCodeLine{3 }
\DoxyCodeLine{9 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{10 }
\DoxyCodeLine{11 \textcolor{preprocessor}{\#include <dune/geometry/quadraturerules.hh>}}
\DoxyCodeLine{12 \textcolor{preprocessor}{\#include <dune/localfefunctions/cachedlocalBasis/cachedlocalBasis.hh>}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include <dune/localfefunctions/impl/standardLocalFunction.hh>}}
\DoxyCodeLine{14 }
\DoxyCodeLine{15 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00125}{ikarus/finiteelements/fehelper.hh}}>}}
\DoxyCodeLine{16 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00128}{ikarus/finiteelements/ferequirements.hh}}>}}
\DoxyCodeLine{17 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00182}{ikarus/finiteelements/mechanics/loads.hh}}>}}
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00167}{ikarus/finiteelements/mechanics/membranestrains.hh}}>}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00200}{ikarus/finiteelements/physicshelper.hh}}>}}
\DoxyCodeLine{20 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00056}{ikarus/utils/linearalgebrahelper.hh}}>}}
\DoxyCodeLine{21 }
\DoxyCodeLine{22 \textcolor{keyword}{namespace }\mbox{\hyperlink{a00363}{Ikarus}} \{}
\DoxyCodeLine{23 \textcolor{keyword}{template} <\textcolor{keyword}{typename} PreFE, \textcolor{keyword}{typename} FE>}
\DoxyCodeLine{24 \textcolor{keyword}{class }KirchhoffLoveShell;}
\DoxyCodeLine{25 }
\DoxyCodeLine{29 \textcolor{keyword}{struct }\mbox{\hyperlink{a01420}{KirchhoffLoveShellPre}}}
\DoxyCodeLine{30 \{}
\DoxyCodeLine{31   \mbox{\hyperlink{a01524}{YoungsModulusAndPoissonsRatio}} \mbox{\hyperlink{a01420_ab9e6c9d9f7fc9143b4e757a1bc3434e6}{material}};}
\DoxyCodeLine{32   \textcolor{keywordtype}{double} \mbox{\hyperlink{a01420_a011229be59e800e251f4ea13d35197bc}{thickness}};}
\DoxyCodeLine{33 }
\DoxyCodeLine{34   \textcolor{keyword}{template} <\textcolor{keyword}{typename} PreFE, \textcolor{keyword}{typename} FE>}
\DoxyCodeLine{35   \textcolor{keyword}{using }\mbox{\hyperlink{a01416}{Skill}} = \mbox{\hyperlink{a01416}{KirchhoffLoveShell<PreFE, FE>}};}
\DoxyCodeLine{36 \};}
\DoxyCodeLine{37 }
\DoxyCodeLine{48 \textcolor{keyword}{template} <\textcolor{keyword}{typename} PreFE, \textcolor{keyword}{typename} FE>}
\DoxyCodeLine{49 \textcolor{keyword}{class }\mbox{\hyperlink{a01416}{KirchhoffLoveShell}}}
\DoxyCodeLine{50 \{}
\DoxyCodeLine{51 \textcolor{keyword}{public}:}
\DoxyCodeLine{52   \textcolor{keyword}{using }\mbox{\hyperlink{a01372}{Traits}}       = \mbox{\hyperlink{a01316_a826c356a5afb013faffb5f7ac893cff4}{PreFE::Traits}};}
\DoxyCodeLine{53   \textcolor{keyword}{using }\mbox{\hyperlink{a01416_a86b5868555fe2fe7c40cbaed6dec9e83}{BasisHandler}} = \textcolor{keyword}{typename} \mbox{\hyperlink{a01372_a129085c175bca28f94c71699b734ba04}{Traits::BasisHandler}};}
\DoxyCodeLine{54   \textcolor{keyword}{using }\mbox{\hyperlink{a01416_a628bbafe0ebd786149113b468854aa3e}{FlatBasis}}    = \textcolor{keyword}{typename} \mbox{\hyperlink{a01372_a81feef959fedef62b2e1daabbd52b5f2}{Traits::FlatBasis}};}
\DoxyCodeLine{55   \textcolor{keyword}{using }\mbox{\hyperlink{a01344}{Requirement}} =}
\DoxyCodeLine{56       \mbox{\hyperlink{a01344}{FERequirementsFactory<FESolutions::displacement, FEParameter::loadfactor, Traits::useEigenRef>::type}};}
\DoxyCodeLine{57   \textcolor{keyword}{using }\mbox{\hyperlink{a01416_a73209ba03ea3a205bc8fe7a46bddf51d}{LocalView}}      = \textcolor{keyword}{typename} \mbox{\hyperlink{a01372_a06bdad066f621e46875af45a22677a3c}{Traits::LocalView}};}
\DoxyCodeLine{58   \textcolor{keyword}{using }\mbox{\hyperlink{a01416_a107cf43d15a86e96bba2d8e0a6530c09}{Geometry}}       = \textcolor{keyword}{typename} \mbox{\hyperlink{a01372_a0b7be1104fba2d190e3fed46f291a851}{Traits::Geometry}};}
\DoxyCodeLine{59   \textcolor{keyword}{using }\mbox{\hyperlink{a01416_a3ab68ba8bee36b87fb522e9649dfdb4c}{GridView}}       = \textcolor{keyword}{typename} \mbox{\hyperlink{a01372_a3ec0294824df467074f5070cb58f5a91}{Traits::GridView}};}
\DoxyCodeLine{60   \textcolor{keyword}{using }\mbox{\hyperlink{a01416_a0c1e8965155bd80eccbfa06c280a4313}{Element}}        = \textcolor{keyword}{typename} \mbox{\hyperlink{a01372_ac4668b9c9142defdf3b70cca8eeb30c4}{Traits::Element}};}
\DoxyCodeLine{61   \textcolor{keyword}{using }\mbox{\hyperlink{a01416_a39b4e56c142a7a1edab8f54939fe01ba}{LocalBasisType}} = \textcolor{keyword}{decltype}(std::declval<LocalView>().tree().child(0).finiteElement().localBasis());}
\DoxyCodeLine{62   \textcolor{keyword}{using }\mbox{\hyperlink{a01420}{Pre}}            = \mbox{\hyperlink{a01420}{KirchhoffLoveShellPre}};}
\DoxyCodeLine{63 }
\DoxyCodeLine{64   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} \mbox{\hyperlink{a01416_a2bddb9b1657599421f38a3b89f7d9a1b}{myDim}}              = \mbox{\hyperlink{a01372_ae15b8efa9f66a3caee81d99dd5c648de}{Traits::mydim}};}
\DoxyCodeLine{65   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} \mbox{\hyperlink{a01416_a46b76aacc5dc6fe0fdc354cc7cbd7d01}{worldDim}}           = \mbox{\hyperlink{a01372_a5d611e1d48285bac5c5ebd6fda9c7cc7}{Traits::worlddim}};}
\DoxyCodeLine{66   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} \mbox{\hyperlink{a01416_ab67caa7fc4bbe7a221c7189207262b99}{membraneStrainSize}} = 3;}
\DoxyCodeLine{67   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} \mbox{\hyperlink{a01416_a32788b9d1b6081e273e0f474099793f4}{bendingStrainSize}}  = 3;}
\DoxyCodeLine{68 }
\DoxyCodeLine{78   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST = \textcolor{keywordtype}{double}>}
\DoxyCodeLine{79   \textcolor{keyword}{struct }\mbox{\hyperlink{a01424}{KinematicVariables}}}
\DoxyCodeLine{80   \{}
\DoxyCodeLine{81     Eigen::Matrix<double, 3, 3> \mbox{\hyperlink{a01424_a501dbd410136f9cc48cb3d21682f3b3d}{C}}; }
\DoxyCodeLine{82     Eigen::Vector3<ST> \mbox{\hyperlink{a01424_a9519ddbd1efb331678c6b4bfb6a23b23}{epsV}};       }
\DoxyCodeLine{83     Eigen::Vector3<ST> \mbox{\hyperlink{a01424_a373e791fb4275f192135fdfc5f46d655}{kappaV}};     }
\DoxyCodeLine{84     Eigen::Matrix<ST, 2, 3> \mbox{\hyperlink{a01424_a7d632741a1be67d3d2228ef97c1caedb}{j}};     }
\DoxyCodeLine{85     Eigen::Matrix<double, 2, 3> \mbox{\hyperlink{a01424_af58b37d5448b1e9ddd2148992f57006e}{J}}; }
\DoxyCodeLine{86     Eigen::Matrix3<ST> \mbox{\hyperlink{a01424_a972a554418bfc2968060377c193a304b}{h}};          }
\DoxyCodeLine{87     Eigen::Matrix3<double> \mbox{\hyperlink{a01424_a19a8eab6e7901a50c3bfaf649ae5af9a}{H}};      }
\DoxyCodeLine{88     Eigen::Vector3<ST> \mbox{\hyperlink{a01424_aa3b0078482e0fff572404a85256817c1}{a3N}};        }
\DoxyCodeLine{89     Eigen::Vector3<ST> \mbox{\hyperlink{a01424_abdcd538eca8535a418378184903aa21a}{a3}};         }
\DoxyCodeLine{90   \};}
\DoxyCodeLine{91 }
\DoxyCodeLine{99   \mbox{\hyperlink{a01416_a66a395230714582f88bc53779690e900}{KirchhoffLoveShell}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01420}{Pre}}\& pre)}
\DoxyCodeLine{100       : mat\_\{pre.material\},}
\DoxyCodeLine{101         thickness\_\{pre.thickness\} \{\}}
\DoxyCodeLine{102 }
\DoxyCodeLine{103 \textcolor{keyword}{protected}:}
\DoxyCodeLine{107   \textcolor{keywordtype}{void} \mbox{\hyperlink{a01416_a4a49206de92d37d0ac1ae6240cf72960}{bindImpl}}() \{}
\DoxyCodeLine{108     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& localView = underlying().localView();}
\DoxyCodeLine{109     assert(localView.bound());}
\DoxyCodeLine{110     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& element = localView.element();}
\DoxyCodeLine{111     \textcolor{keyword}{auto}\& firstChild    = localView.tree().child(0);}
\DoxyCodeLine{112 }
\DoxyCodeLine{113     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& fe = firstChild.finiteElement();}
\DoxyCodeLine{114     \textcolor{comment}{// geo\_.emplace(element.geometry());}}
\DoxyCodeLine{115     numberOfNodes\_ = fe.size();}
\DoxyCodeLine{116     order\_         = 2 * (fe.localBasis().order());}
\DoxyCodeLine{117     localBasis\_    = Dune::CachedLocalBasis(fe.localBasis());}
\DoxyCodeLine{118     \textcolor{keywordflow}{if} \textcolor{keyword}{constexpr} (\textcolor{keyword}{requires} \{ element.impl().getQuadratureRule(order\_); \})}
\DoxyCodeLine{119       \textcolor{keywordflow}{if} (element.impl().isTrimmed())}
\DoxyCodeLine{120         localBasis\_.bind(element.impl().getQuadratureRule(order\_), Dune::bindDerivatives(0, 1, 2));}
\DoxyCodeLine{121       \textcolor{keywordflow}{else}}
\DoxyCodeLine{122         localBasis\_.bind(Dune::QuadratureRules<double, myDim>::rule(element.type(), order\_),}
\DoxyCodeLine{123                          Dune::bindDerivatives(0, 1, 2));}
\DoxyCodeLine{124     \textcolor{keywordflow}{else}}
\DoxyCodeLine{125       localBasis\_.bind(Dune::QuadratureRules<double, myDim>::rule(element.type(), order\_),}
\DoxyCodeLine{126                        Dune::bindDerivatives(0, 1, 2));}
\DoxyCodeLine{127   \}}
\DoxyCodeLine{128 }
\DoxyCodeLine{129 \textcolor{keyword}{public}:}
\DoxyCodeLine{140   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST = \textcolor{keywordtype}{double}>}
\DoxyCodeLine{141   \textcolor{keyword}{auto} \mbox{\hyperlink{a01416_a1a0ead836c312ccac84c75ce2fccccfd}{displacementFunction}}(}
\DoxyCodeLine{142       \textcolor{keyword}{const} \mbox{\hyperlink{a01344}{Requirement}}\& par,}
\DoxyCodeLine{143       \textcolor{keyword}{const} std::optional<std::reference\_wrapper<\textcolor{keyword}{const} Eigen::VectorX<ST>>>\& dx = std::nullopt)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{144     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& d = par.\mbox{\hyperlink{a01344_a523ed390dfea00379b5b638e523ddb74}{globalSolution}}();}
\DoxyCodeLine{145     \textcolor{keyword}{auto} disp     = Ikarus::FEHelper::localSolutionBlockVector<Traits>(d, underlying().localView(), dx);}
\DoxyCodeLine{146     Dune::StandardLocalFunction uFunction(}
\DoxyCodeLine{147         localBasis\_, disp, std::make\_shared<const Geometry>(underlying().localView().element().\mbox{\hyperlink{a01416_a368cffe9f1d3f287c857176842a3a575}{geometry}}()));}
\DoxyCodeLine{148     \textcolor{keywordflow}{return} uFunction;}
\DoxyCodeLine{149   \}}
\DoxyCodeLine{150 }
\DoxyCodeLine{151   \mbox{\hyperlink{a01416_a107cf43d15a86e96bba2d8e0a6530c09}{Geometry}} \mbox{\hyperlink{a01416_a368cffe9f1d3f287c857176842a3a575}{geometry}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} underlying().localView().element().geometry(); \}}
\DoxyCodeLine{152   [[nodiscard]] \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{a01416_a2385d3296b8e50cdc22e0de59e47afce}{numberOfNodes}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} numberOfNodes\_; \}}
\DoxyCodeLine{153   [[nodiscard]] \textcolor{keywordtype}{int} \mbox{\hyperlink{a01416_af313e6f922e1ec9a4e07a6dc0fcdf639}{order}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} order\_; \}}
\DoxyCodeLine{154 }
\DoxyCodeLine{160   \textcolor{keyword}{template} <\textcolor{keyword}{template} <\textcolor{keyword}{typename}, \textcolor{keywordtype}{int}, \textcolor{keywordtype}{int}> \textcolor{keyword}{class }RT>}
\DoxyCodeLine{161   \textcolor{keyword}{static} \textcolor{keyword}{consteval} \textcolor{keywordtype}{bool} \mbox{\hyperlink{a01416_a338509d6641dbd3d51b3dfca10e32834}{canProvideResultType}}() \{}
\DoxyCodeLine{162     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{163   \}}
\DoxyCodeLine{164 }
\DoxyCodeLine{165   \textcolor{keyword}{using }\mbox{\hyperlink{a01416_ad22ca7a490e6f5d08d7a0df636536bc9}{SupportedResultTypes}} = std::tuple<>;}
\DoxyCodeLine{166 }
\DoxyCodeLine{176   \textcolor{keyword}{template} <\textcolor{keyword}{template} <\textcolor{keyword}{typename}, \textcolor{keywordtype}{int}, \textcolor{keywordtype}{int}> \textcolor{keyword}{class }RT>}
\DoxyCodeLine{177   \textcolor{keyword}{requires}(canProvideResultType<RT>())}
\DoxyCodeLine{178   \textcolor{keyword}{auto} \mbox{\hyperlink{a01416_a2edbffdb7df6c8521bb07502b25b26e2}{calculateAtImpl}}([[maybe\_unused]] \textcolor{keyword}{const} \mbox{\hyperlink{a01344}{Requirement}}\& req,}
\DoxyCodeLine{179                        [[maybe\_unused]] \textcolor{keyword}{const} \mbox{\hyperlink{a01692}{Dune::FieldVector<double, Traits::mydim>}}\& local)}
\DoxyCodeLine{180       -\/> \mbox{\hyperlink{a01368}{ResultWrapper<RT<double, myDim, worldDim>}}, \mbox{\hyperlink{a00363_acfb09bb7db104db62d3d1d2dc3e009b2a57dea6f5039281b7fee517fc43bf3110}{ResultShape::Vector}}> \{}
\DoxyCodeLine{181     DUNE\_THROW(Dune::NotImplemented, \textcolor{stringliteral}{"{}No results are implemented"{}});}
\DoxyCodeLine{182   \}}
\DoxyCodeLine{183 }
\DoxyCodeLine{184 \textcolor{keyword}{private}:}
\DoxyCodeLine{185   \textcolor{comment}{//> CRTP}}
\DoxyCodeLine{186   \textcolor{keyword}{const} \textcolor{keyword}{auto}\& underlying()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \textcolor{keyword}{static\_cast<}\textcolor{keyword}{const }\mbox{\hyperlink{a01312}{FE}}\&\textcolor{keyword}{>}(*this); \}}
\DoxyCodeLine{187   \textcolor{keyword}{auto}\& underlying() \{ \textcolor{keywordflow}{return} \textcolor{keyword}{static\_cast<}FE\&\textcolor{keyword}{>}(*this); \}}
\DoxyCodeLine{188   \textcolor{comment}{// std::optional<Geometry> geo\_;}}
\DoxyCodeLine{189   Dune::CachedLocalBasis<std::remove\_cvref\_t<LocalBasisType>> localBasis\_;}
\DoxyCodeLine{190   \textcolor{comment}{// DefaultMembraneStrain membraneStrain\_;}}
\DoxyCodeLine{191   YoungsModulusAndPoissonsRatio mat\_;}
\DoxyCodeLine{192   \textcolor{keywordtype}{double} thickness\_;}
\DoxyCodeLine{193 }
\DoxyCodeLine{194   \textcolor{keywordtype}{size\_t} numberOfNodes\_\{0\};}
\DoxyCodeLine{195   \textcolor{keywordtype}{int} order\_\{\};}
\DoxyCodeLine{196 }
\DoxyCodeLine{197 \textcolor{keyword}{protected}:}
\DoxyCodeLine{212   \textcolor{keyword}{auto} \mbox{\hyperlink{a01416_a2116db254c03a1873dc6d1d432d8eaa1}{computeMaterialAndStrains}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01692}{Dune::FieldVector<double, 2>}}\& gpPos, \textcolor{keywordtype}{int} gpIndex, \textcolor{keyword}{const} \mbox{\hyperlink{a01416_a107cf43d15a86e96bba2d8e0a6530c09}{Geometry}}\& geo,}
\DoxyCodeLine{213                                  \textcolor{keyword}{const} \textcolor{keyword}{auto}\& uFunction)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{214     \textcolor{keyword}{using }ST = \textcolor{keyword}{typename} std::remove\_cvref\_t<\textcolor{keyword}{decltype}(uFunction)>::ctype;}
\DoxyCodeLine{215 }
\DoxyCodeLine{216     \mbox{\hyperlink{a01424}{KinematicVariables<ST>}} kin;}
\DoxyCodeLine{217     \textcolor{keyword}{using namespace }\mbox{\hyperlink{a00381}{Dune}};}
\DoxyCodeLine{218     \textcolor{keyword}{using namespace }Dune::DerivativeDirections;}
\DoxyCodeLine{219     \textcolor{keyword}{const} \textcolor{keyword}{auto} [X, Jd, Hd]              = geo.impl().zeroFirstAndSecondDerivativeOfPosition(gpPos);}
\DoxyCodeLine{220     kin.J                               = toEigen(Jd);}
\DoxyCodeLine{221     kin.H                               = toEigen(Hd);}
\DoxyCodeLine{222     \textcolor{keyword}{const} Eigen::Matrix<double, 2, 2> A = kin.J * kin.J.transpose();}
\DoxyCodeLine{223     Eigen::Matrix<double, 3, 3> G       = Eigen::Matrix<double, 3, 3>::Zero();}
\DoxyCodeLine{224 }
\DoxyCodeLine{225     G.block<2, 2>(0, 0)                    = A;}
\DoxyCodeLine{226     G(2, 2)                                = 1;}
\DoxyCodeLine{227     \textcolor{keyword}{const} Eigen::Matrix<double, 3, 3> GInv = G.inverse();}
\DoxyCodeLine{228     kin.C                                  = \mbox{\hyperlink{a01416_a0a02eda2ec4b244354d313e8c98568f6}{materialTangent}}(GInv);}
\DoxyCodeLine{229 }
\DoxyCodeLine{230     kin.epsV = \mbox{\hyperlink{a01480_a7c65ab77e1e42865fc4d0b04a5cb288a}{DefaultMembraneStrain::value}}(gpPos, geo, uFunction);}
\DoxyCodeLine{231 }
\DoxyCodeLine{232     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& Ndd                     = localBasis\_.evaluateSecondDerivatives(gpIndex);}
\DoxyCodeLine{233     \textcolor{keyword}{const} \textcolor{keyword}{auto} uasMatrix                = \mbox{\hyperlink{a00358_gaf9d7cf401f9f03ce1aae728c646ce178}{Dune::viewAsEigenMatrixAsDynFixed}}(uFunction.coefficientsRef());}
\DoxyCodeLine{234     \textcolor{keyword}{const} \textcolor{keyword}{auto} hessianu                 = Ndd.transpose().template cast<ST>() * uasMatrix;}
\DoxyCodeLine{235     kin.h                               = kin.H + hessianu;}
\DoxyCodeLine{236     \textcolor{keyword}{const} Eigen::Matrix<ST, 3, 2> gradu = toEigen(uFunction.evaluateDerivative(}
\DoxyCodeLine{237         gpIndex, Dune::wrt(spatialAll), Dune::on(Dune::DerivativeDirections::referenceElement)));}
\DoxyCodeLine{238     kin.j                               = kin.J + gradu.transpose();}
\DoxyCodeLine{239     kin.a3N                             = (kin.j.row(0).cross(kin.j.row(1)));}
\DoxyCodeLine{240     kin.a3                              = kin.a3N.normalized();}
\DoxyCodeLine{241     Eigen::Vector<ST, 3> bV             = kin.h * kin.a3;}
\DoxyCodeLine{242     bV(2) *= 2; \textcolor{comment}{// Voigt notation requires the two here}}
\DoxyCodeLine{243     \textcolor{keyword}{const} \textcolor{keyword}{auto} BV = \mbox{\hyperlink{a00359_ga4304655095296ce9283e012587817a51}{toVoigt}}(toEigen(geo.impl().secondFundamentalForm(gpPos)));}
\DoxyCodeLine{244     kin.kappaV    = BV -\/ bV;}
\DoxyCodeLine{245     \textcolor{keywordflow}{return} kin;}
\DoxyCodeLine{246   \}}
\DoxyCodeLine{247 }
\DoxyCodeLine{248   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST>}
\DoxyCodeLine{249   \textcolor{keywordtype}{void} \mbox{\hyperlink{a01416_a71e905f315ca4efee16150b0c43fbabe}{calculateMatrixImpl}}(}
\DoxyCodeLine{250       \textcolor{keyword}{const} \mbox{\hyperlink{a01344}{Requirement}}\& par, \textcolor{keyword}{const} \mbox{\hyperlink{a00363_a390d5311179ec61d163a29c943b3d1a0}{MatrixAffordance}}\& affordance, \textcolor{keyword}{typename} Traits::template MatrixType<ST> K,}
\DoxyCodeLine{251       \textcolor{keyword}{const} std::optional<std::reference\_wrapper<\textcolor{keyword}{const} Eigen::VectorX<ST>>>\& dx = std::nullopt)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{252     \textcolor{keywordflow}{if} (affordance != \mbox{\hyperlink{a00363_a390d5311179ec61d163a29c943b3d1a0a086e8b527490b8abe606a8dd76586ab1}{MatrixAffordance::stiffness}})}
\DoxyCodeLine{253       DUNE\_THROW(Dune::NotImplemented, \textcolor{stringliteral}{"{}MatrixAffordance not implemented: "{}} + \mbox{\hyperlink{a00363_aef80b6b5b45dcfbea4f722f51a84f53f}{toString}}(affordance));}
\DoxyCodeLine{254     \textcolor{keyword}{using namespace }Dune::DerivativeDirections;}
\DoxyCodeLine{255     \textcolor{keyword}{using namespace }\mbox{\hyperlink{a00381}{Dune}};}
\DoxyCodeLine{256     \textcolor{keyword}{const} \textcolor{keyword}{auto} uFunction = \mbox{\hyperlink{a01416_a1a0ead836c312ccac84c75ce2fccccfd}{displacementFunction}}(par, dx);}
\DoxyCodeLine{257     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& lambda   = par.\mbox{\hyperlink{a01344_af11316c1f0fca6982a2d7497bc71a10c}{parameter}}();}
\DoxyCodeLine{258     \textcolor{keyword}{const} \textcolor{keyword}{auto} geo       = underlying().localView().element().geometry();}
\DoxyCodeLine{259 }
\DoxyCodeLine{260     \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}\& [gpIndex, gp] : uFunction.viewOverIntegrationPoints()) \{}
\DoxyCodeLine{261       \textcolor{keyword}{const} \textcolor{keyword}{auto} intElement = geo.integrationElement(gp.position()) * gp.weight();}
\DoxyCodeLine{262       \textcolor{keyword}{const} \textcolor{keyword}{auto} [C, epsV, kappaV, jE, J, h, H, a3N, a3] =}
\DoxyCodeLine{263           \mbox{\hyperlink{a01416_a2116db254c03a1873dc6d1d432d8eaa1}{computeMaterialAndStrains}}(gp.position(), gpIndex, geo, uFunction);}
\DoxyCodeLine{264       \textcolor{keyword}{const} Eigen::Vector<ST, membraneStrainSize> membraneForces = thickness\_ * C * epsV;}
\DoxyCodeLine{265       \textcolor{keyword}{const} Eigen::Vector<ST, bendingStrainSize> moments         = Dune::power(thickness\_, 3) / 12.0 * C * kappaV;}
\DoxyCodeLine{266 }
\DoxyCodeLine{267       \textcolor{keyword}{const} \textcolor{keyword}{auto}\& Nd  = localBasis\_.evaluateJacobian(gpIndex);}
\DoxyCodeLine{268       \textcolor{keyword}{const} \textcolor{keyword}{auto}\& Ndd = localBasis\_.evaluateSecondDerivatives(gpIndex);}
\DoxyCodeLine{269       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < numberOfNodes\_; ++i) \{}
\DoxyCodeLine{270         Eigen::Matrix<ST, membraneStrainSize, worldDim> bopIMembrane =}
\DoxyCodeLine{271             \mbox{\hyperlink{a01480_a0e9910984eae86b868f317f0a26a132e}{DefaultMembraneStrain::derivative}}(gp.position(), jE, Nd, geo, uFunction, localBasis\_, i);}
\DoxyCodeLine{272 }
\DoxyCodeLine{273         Eigen::Matrix<ST, bendingStrainSize, worldDim> bopIBending = \mbox{\hyperlink{a01416_ab64163b2440a36540cffe5be74981574}{bopBending}}(jE, h, Nd, Ndd, i, a3N, a3);}
\DoxyCodeLine{274         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} j = i; j < numberOfNodes\_; ++j) \{}
\DoxyCodeLine{275           \textcolor{keyword}{auto} KBlock = K.template block<worldDim, worldDim>(\mbox{\hyperlink{a01416_a46b76aacc5dc6fe0fdc354cc7cbd7d01}{worldDim}} * i, \mbox{\hyperlink{a01416_a46b76aacc5dc6fe0fdc354cc7cbd7d01}{worldDim}} * j);}
\DoxyCodeLine{276           Eigen::Matrix<ST, membraneStrainSize, worldDim> bopJMembrane =}
\DoxyCodeLine{277               \mbox{\hyperlink{a01480_a0e9910984eae86b868f317f0a26a132e}{DefaultMembraneStrain::derivative}}(gp.position(), jE, Nd, geo, uFunction, localBasis\_, j);}
\DoxyCodeLine{278           Eigen::Matrix<ST, bendingStrainSize, worldDim> bopJBending = \mbox{\hyperlink{a01416_ab64163b2440a36540cffe5be74981574}{bopBending}}(jE, h, Nd, Ndd, j, a3N, a3);}
\DoxyCodeLine{279           KBlock += thickness\_ * bopIMembrane.transpose() * C * bopJMembrane * intElement;}
\DoxyCodeLine{280           KBlock += Dune::power(thickness\_, 3) / 12.0 * bopIBending.transpose() * C * bopJBending * intElement;}
\DoxyCodeLine{281 }
\DoxyCodeLine{282           Eigen::Matrix<ST, worldDim, worldDim> kgMembraneIJ = \mbox{\hyperlink{a01480_a28a06b4e89e7e526e8b09b020d6adfcf}{DefaultMembraneStrain::secondDerivative}}(}
\DoxyCodeLine{283               gp.position(), Nd, geo, uFunction, localBasis\_, membraneForces, i, j);}
\DoxyCodeLine{284           Eigen::Matrix<ST, worldDim, worldDim> kgBendingIJ = \mbox{\hyperlink{a01416_a93f11b9294df96b1955867984fe71670}{kgBending}}(jE, h, Nd, Ndd, a3N, a3, moments, i, j);}
\DoxyCodeLine{285           KBlock += kgMembraneIJ * intElement;}
\DoxyCodeLine{286           KBlock += kgBendingIJ * intElement;}
\DoxyCodeLine{287         \}}
\DoxyCodeLine{288       \}}
\DoxyCodeLine{289     \}}
\DoxyCodeLine{290     K.template triangularView<Eigen::StrictlyLower>() = K.transpose();}
\DoxyCodeLine{291   \}}
\DoxyCodeLine{292 }
\DoxyCodeLine{293   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST>}
\DoxyCodeLine{294   \textcolor{keywordtype}{void} \mbox{\hyperlink{a01416_a14aa1287417c41d90c1f9cad4738cc93}{calculateVectorImpl}}(}
\DoxyCodeLine{295       \textcolor{keyword}{const} \mbox{\hyperlink{a01344}{Requirement}}\& par, \textcolor{keyword}{const} \mbox{\hyperlink{a00363_aab9e3e38507d1db7602bc750718c302a}{VectorAffordance}}\& affordance, \textcolor{keyword}{typename} Traits::template VectorType<ST> force,}
\DoxyCodeLine{296       \textcolor{keyword}{const} std::optional<std::reference\_wrapper<\textcolor{keyword}{const} Eigen::VectorX<ST>>>\& dx = std::nullopt)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{297     \textcolor{keywordflow}{if} (affordance != \mbox{\hyperlink{a00363_aab9e3e38507d1db7602bc750718c302aa2c05161a7e67e946ddc889571aac4e89}{VectorAffordance::forces}})}
\DoxyCodeLine{298       DUNE\_THROW(Dune::NotImplemented, \textcolor{stringliteral}{"{}VectorAffordance not implemented: "{}} + \mbox{\hyperlink{a00363_aef80b6b5b45dcfbea4f722f51a84f53f}{toString}}(affordance));}
\DoxyCodeLine{299     \textcolor{keyword}{using namespace }Dune::DerivativeDirections;}
\DoxyCodeLine{300     \textcolor{keyword}{using namespace }\mbox{\hyperlink{a00381}{Dune}};}
\DoxyCodeLine{301     \textcolor{keyword}{const} \textcolor{keyword}{auto} uFunction = \mbox{\hyperlink{a01416_a1a0ead836c312ccac84c75ce2fccccfd}{displacementFunction}}(par, dx);}
\DoxyCodeLine{302     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& lambda   = par.\mbox{\hyperlink{a01344_af11316c1f0fca6982a2d7497bc71a10c}{parameter}}();}
\DoxyCodeLine{303     \textcolor{keyword}{const} \textcolor{keyword}{auto} geo       = underlying().localView().element().geometry();}
\DoxyCodeLine{304 }
\DoxyCodeLine{305     \textcolor{comment}{// Internal forces}}
\DoxyCodeLine{306     \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}\& [gpIndex, gp] : uFunction.viewOverIntegrationPoints()) \{}
\DoxyCodeLine{307       \textcolor{keyword}{const} \textcolor{keyword}{auto} [C, epsV, kappaV, jE, J, h, H, a3N, a3] =}
\DoxyCodeLine{308           \mbox{\hyperlink{a01416_a2116db254c03a1873dc6d1d432d8eaa1}{computeMaterialAndStrains}}(gp.position(), gpIndex, geo, uFunction);}
\DoxyCodeLine{309       \textcolor{keyword}{const} Eigen::Vector<ST, 3> membraneForces = thickness\_ * C * epsV;}
\DoxyCodeLine{310       \textcolor{keyword}{const} Eigen::Vector<ST, 3> moments        = Dune::power(thickness\_, 3) / 12.0 * C * kappaV;}
\DoxyCodeLine{311 }
\DoxyCodeLine{312       \textcolor{keyword}{const} \textcolor{keyword}{auto}\& Nd  = localBasis\_.evaluateJacobian(gpIndex);}
\DoxyCodeLine{313       \textcolor{keyword}{const} \textcolor{keyword}{auto}\& Ndd = localBasis\_.evaluateSecondDerivatives(gpIndex);}
\DoxyCodeLine{314       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < numberOfNodes\_; ++i) \{}
\DoxyCodeLine{315         Eigen::Matrix<ST, 3, 3> bopIMembrane =}
\DoxyCodeLine{316             \mbox{\hyperlink{a01480_a0e9910984eae86b868f317f0a26a132e}{DefaultMembraneStrain::derivative}}(gp.position(), jE, Nd, geo, uFunction, localBasis\_, i);}
\DoxyCodeLine{317         Eigen::Matrix<ST, 3, 3> bopIBending = \mbox{\hyperlink{a01416_ab64163b2440a36540cffe5be74981574}{bopBending}}(jE, h, Nd, Ndd, i, a3N, a3);}
\DoxyCodeLine{318         force.template segment<3>(3 * i) +=}
\DoxyCodeLine{319             bopIMembrane.transpose() * membraneForces * geo.integrationElement(gp.position()) * gp.weight();}
\DoxyCodeLine{320         force.template segment<3>(3 * i) +=}
\DoxyCodeLine{321             bopIBending.transpose() * moments * geo.integrationElement(gp.position()) * gp.weight();}
\DoxyCodeLine{322       \}}
\DoxyCodeLine{323     \}}
\DoxyCodeLine{324   \}}
\DoxyCodeLine{325 }
\DoxyCodeLine{326   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST>}
\DoxyCodeLine{327   \textcolor{keyword}{auto} \mbox{\hyperlink{a01416_ac901c3457b487e52ca4c40ccfb1e69a6}{calculateScalarImpl}}(}
\DoxyCodeLine{328       \textcolor{keyword}{const} \mbox{\hyperlink{a01344}{Requirement}}\& par, \textcolor{keyword}{const} \mbox{\hyperlink{a00363_af6f894084edd9109762b86222995ef2a}{ScalarAffordance}}\& affordance,}
\DoxyCodeLine{329       \textcolor{keyword}{const} std::optional<std::reference\_wrapper<\textcolor{keyword}{const} Eigen::VectorX<ST>>>\& dx = std::nullopt) \textcolor{keyword}{const} -\/> ST \{}
\DoxyCodeLine{330     \textcolor{keywordflow}{if} (affordance != \mbox{\hyperlink{a00363_af6f894084edd9109762b86222995ef2aa814f34f472acef493e9ecf0ffccdcae6}{ScalarAffordance::mechanicalPotentialEnergy}})}
\DoxyCodeLine{331       DUNE\_THROW(Dune::NotImplemented, \textcolor{stringliteral}{"{}ScalarAffordance not implemented: "{}} + \mbox{\hyperlink{a00363_aef80b6b5b45dcfbea4f722f51a84f53f}{toString}}(affordance));}
\DoxyCodeLine{332     \textcolor{keyword}{using namespace }Dune::DerivativeDirections;}
\DoxyCodeLine{333     \textcolor{keyword}{using namespace }\mbox{\hyperlink{a00381}{Dune}};}
\DoxyCodeLine{334     \textcolor{keyword}{const} \textcolor{keyword}{auto} uFunction = \mbox{\hyperlink{a01416_a1a0ead836c312ccac84c75ce2fccccfd}{displacementFunction}}(par, dx);}
\DoxyCodeLine{335     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& lambda   = par.parameter();}
\DoxyCodeLine{336     ST energy            = 0.0;}
\DoxyCodeLine{337 }
\DoxyCodeLine{338     \textcolor{keyword}{const} \textcolor{keyword}{auto} geo = underlying().localView().element().geometry();}
\DoxyCodeLine{339 }
\DoxyCodeLine{340     \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}\& [gpIndex, gp] : uFunction.viewOverIntegrationPoints()) \{}
\DoxyCodeLine{341       \textcolor{keyword}{const} \textcolor{keyword}{auto} [C, epsV, kappaV, j, J, h, H, a3N, a3] =}
\DoxyCodeLine{342           \mbox{\hyperlink{a01416_a2116db254c03a1873dc6d1d432d8eaa1}{computeMaterialAndStrains}}(gp.position(), gpIndex, geo, uFunction);}
\DoxyCodeLine{343 }
\DoxyCodeLine{344       \textcolor{keyword}{const} ST membraneEnergy = 0.5 * thickness\_ * epsV.dot(C * epsV);}
\DoxyCodeLine{345       \textcolor{keyword}{const} ST bendingEnergy  = 0.5 * Dune::power(thickness\_, 3) / 12.0 * kappaV.dot(C * kappaV);}
\DoxyCodeLine{346       energy += (membraneEnergy + bendingEnergy) * geo.integrationElement(gp.position()) * gp.weight();}
\DoxyCodeLine{347     \}}
\DoxyCodeLine{348 }
\DoxyCodeLine{349     \textcolor{keywordflow}{return} energy;}
\DoxyCodeLine{350   \}}
\DoxyCodeLine{351 }
\DoxyCodeLine{352   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST>}
\DoxyCodeLine{353   Eigen::Matrix<ST, 3, 3> \mbox{\hyperlink{a01416_a93f11b9294df96b1955867984fe71670}{kgBending}}(\textcolor{keyword}{const} Eigen::Matrix<ST, 2, 3>\& jcur, \textcolor{keyword}{const} Eigen::Matrix3<ST>\& h, \textcolor{keyword}{const} \textcolor{keyword}{auto}\& dN,}
\DoxyCodeLine{354                                     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& ddN, \textcolor{keyword}{const} Eigen::Vector3<ST>\& a3N, \textcolor{keyword}{const} Eigen::Vector3<ST>\& a3,}
\DoxyCodeLine{355                                     \textcolor{keyword}{const} Eigen::Vector3<ST>\& S, \textcolor{keywordtype}{int} I, \textcolor{keywordtype}{int} J)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{356     Eigen::Matrix<ST, 3, 3> kg;}
\DoxyCodeLine{357     kg.setZero();}
\DoxyCodeLine{358 }
\DoxyCodeLine{359     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& dN1i = dN(I, 0);}
\DoxyCodeLine{360     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& dN1j = dN(J, 0);}
\DoxyCodeLine{361     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& dN2i = dN(I, 1);}
\DoxyCodeLine{362     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& dN2j = dN(J, 1);}
\DoxyCodeLine{363 }
\DoxyCodeLine{364     \textcolor{keyword}{const} Eigen::Matrix<ST, 3, 3> P =}
\DoxyCodeLine{365         1.0 / a3N.norm() * (Eigen::Matrix<double, 3, 3>::Identity() -\/ a3 * a3.transpose());}
\DoxyCodeLine{366 }
\DoxyCodeLine{367     \textcolor{keyword}{const} \textcolor{keyword}{auto} a1dxI = Eigen::Matrix<double, 3, 3>::Identity() *}
\DoxyCodeLine{368                        dN1i; \textcolor{comment}{// the auto here allows the exploitation of the identity matrices,}}
\DoxyCodeLine{369     \textcolor{comment}{// due to Eigen's expression templates}}
\DoxyCodeLine{370     \textcolor{keyword}{const} \textcolor{keyword}{auto} a2dxI                    = Eigen::Matrix<double, 3, 3>::Identity() * dN2i;}
\DoxyCodeLine{371     \textcolor{keyword}{const} \textcolor{keyword}{auto} a1dxJ                    = Eigen::Matrix<double, 3, 3>::Identity() * dN1j;}
\DoxyCodeLine{372     \textcolor{keyword}{const} \textcolor{keyword}{auto} a2dxJ                    = Eigen::Matrix<double, 3, 3>::Identity() * dN2j;}
\DoxyCodeLine{373     \textcolor{keyword}{const} \textcolor{keyword}{auto} a1                       = jcur.row(0);}
\DoxyCodeLine{374     \textcolor{keyword}{const} \textcolor{keyword}{auto} a2                       = jcur.row(1);}
\DoxyCodeLine{375     \textcolor{keyword}{const} Eigen::Matrix<ST, 3, 3> a3NdI = a1dxI.colwise().cross(a2) -\/ a2dxI.colwise().cross(a1);}
\DoxyCodeLine{376     \textcolor{keyword}{const} Eigen::Matrix<ST, 3, 3> a3NdJ = a1dxJ.colwise().cross(a2) -\/ a2dxJ.colwise().cross(a1);}
\DoxyCodeLine{377     Eigen::Matrix<ST, 3, 3> a3dI        = P * a3NdI;}
\DoxyCodeLine{378     Eigen::Matrix<ST, 3, 3> a3dJ        = P * a3NdJ;}
\DoxyCodeLine{379     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 3; ++i) \{}
\DoxyCodeLine{380       \textcolor{keyword}{const} \textcolor{keyword}{auto} a\_albe       = h.row(i).transpose();}
\DoxyCodeLine{381       \textcolor{keyword}{const} \textcolor{keyword}{auto}\& ddNI        = ddN(I, i);}
\DoxyCodeLine{382       \textcolor{keyword}{const} \textcolor{keyword}{auto}\& ddNJ        = ddN(J, i);}
\DoxyCodeLine{383       Eigen::Vector3<ST> vecd = P * a\_albe;}
\DoxyCodeLine{384 }
\DoxyCodeLine{385       Eigen::Matrix<ST, 3, 3> a3Ndd =}
\DoxyCodeLine{386           1.0 / a3N.squaredNorm() *}
\DoxyCodeLine{387           ((3 * a3 * a3.transpose() -\/ Eigen::Matrix<double, 3, 3>::Identity()) * (a3.dot(a\_albe)) -\/}
\DoxyCodeLine{388            a\_albe * a3.transpose() -\/ a3 * a\_albe.transpose());}
\DoxyCodeLine{389 }
\DoxyCodeLine{390       Eigen::Matrix<ST, 3, 3> secondDerivativeDirectorIJ = \mbox{\hyperlink{a00358_ga1496a9776a583f8b09c4244a68453394}{skew}}(((dN2i * dN1j -\/ dN1i * dN2j) * vecd).eval());}
\DoxyCodeLine{391       kg -\/= (a3NdI.transpose() * a3Ndd * a3NdJ + secondDerivativeDirectorIJ + (ddNI * a3dJ + ddNJ * a3dI.transpose())) *}
\DoxyCodeLine{392             S[i] * (i == 2 ? 2 : 1);}
\DoxyCodeLine{393     \}}
\DoxyCodeLine{394 }
\DoxyCodeLine{395     \textcolor{keywordflow}{return} kg;}
\DoxyCodeLine{396   \}}
\DoxyCodeLine{397 }
\DoxyCodeLine{398   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ST>}
\DoxyCodeLine{399   Eigen::Matrix<ST, 3, 3> \mbox{\hyperlink{a01416_ab64163b2440a36540cffe5be74981574}{bopBending}}(\textcolor{keyword}{const} Eigen::Matrix<ST, 2, 3>\& jcur, \textcolor{keyword}{const} Eigen::Matrix3<ST>\& h, \textcolor{keyword}{const} \textcolor{keyword}{auto}\& dN,}
\DoxyCodeLine{400                                      \textcolor{keyword}{const} \textcolor{keyword}{auto}\& ddN, \textcolor{keyword}{const} \textcolor{keywordtype}{int} node, \textcolor{keyword}{const} Eigen::Vector3<ST>\& a3N,}
\DoxyCodeLine{401                                      \textcolor{keyword}{const} Eigen::Vector3<ST>\& a3)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{402     \textcolor{keyword}{const} Eigen::Matrix<ST, 3, 3> a1dxI =}
\DoxyCodeLine{403         Eigen::Matrix<double, 3, 3>::Identity() * dN(node, 0); \textcolor{comment}{// this should be double}}
\DoxyCodeLine{404     \textcolor{comment}{// but the cross-\/product below complains otherwise}}
\DoxyCodeLine{405     \textcolor{keyword}{const} Eigen::Matrix<ST, 3, 3> a2dxI = Eigen::Matrix<double, 3, 3>::Identity() * dN(node, 1);}
\DoxyCodeLine{406     \textcolor{keyword}{const} \textcolor{keyword}{auto} a1                       = jcur.row(0);}
\DoxyCodeLine{407     \textcolor{keyword}{const} \textcolor{keyword}{auto} a2                       = jcur.row(1);}
\DoxyCodeLine{408     \textcolor{keyword}{const} Eigen::Matrix<ST, 3, 3> a3NdI =}
\DoxyCodeLine{409         a1dxI.colwise().cross(a2) -\/ a2dxI.colwise().cross(a1); \textcolor{comment}{// minus needed since order has}}
\DoxyCodeLine{410     \textcolor{comment}{// to be swapped to get column-\/wise cross product working}}
\DoxyCodeLine{411     \textcolor{keyword}{const} Eigen::Matrix<ST, 3, 3> a3d1 =}
\DoxyCodeLine{412         1.0 / a3N.norm() * (Eigen::Matrix<double, 3, 3>::Identity() -\/ a3 * a3.transpose()) * a3NdI;}
\DoxyCodeLine{413 }
\DoxyCodeLine{414     Eigen::Matrix<ST, 3, 3> bop = -\/(h * a3d1 + (a3 * ddN.row(node)).\mbox{\hyperlink{a00363_ac2c6469be19ce4ef2e630bfa1c5a5e24}{transpose}}());}
\DoxyCodeLine{415     bop.row(2) *= 2;}
\DoxyCodeLine{416 }
\DoxyCodeLine{417     \textcolor{keywordflow}{return} bop;}
\DoxyCodeLine{418   \}}
\DoxyCodeLine{419 }
\DoxyCodeLine{426   Eigen::Matrix<double, 3, 3> \mbox{\hyperlink{a01416_a0a02eda2ec4b244354d313e8c98568f6}{materialTangent}}(\textcolor{keyword}{const} Eigen::Matrix<double, 3, 3>\& Aconv)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{427     \textcolor{keyword}{const} \textcolor{keywordtype}{double} lambda   = mat\_.emodul * mat\_.nu / ((1.0 + mat\_.nu) * (1.0 -\/ 2.0 * mat\_.nu));}
\DoxyCodeLine{428     \textcolor{keyword}{const} \textcolor{keywordtype}{double} mu       = mat\_.emodul / (2.0 * (1.0 + mat\_.nu));}
\DoxyCodeLine{429     \textcolor{keyword}{const} \textcolor{keywordtype}{double} lambdbar = 2.0 * lambda * mu / (lambda + 2.0 * mu);}
\DoxyCodeLine{430     Eigen::TensorFixedSize<double, Eigen::Sizes<3, 3, 3, 3>> moduli;}
\DoxyCodeLine{431     \textcolor{keyword}{const} \textcolor{keyword}{auto} AconvT = \mbox{\hyperlink{a00359_ga5cfd9d098384fb067d897b3c0499b447}{tensorView}}(Aconv, std::array<Eigen::Index, 2>(\{3, 3\}));}
\DoxyCodeLine{432     moduli = lambdbar * \mbox{\hyperlink{a00359_gab2cea9ac847cc3635812467c9d96ceb4}{dyadic}}(AconvT, AconvT).eval() + 2.0 * mu * symmetricFourthOrder<double>(Aconv, Aconv);}
\DoxyCodeLine{433 }
\DoxyCodeLine{434     \textcolor{keyword}{auto} C                          = \mbox{\hyperlink{a00359_ga4304655095296ce9283e012587817a51}{toVoigt}}(moduli);}
\DoxyCodeLine{435     Eigen::Matrix<double, 3, 3> C33 = C(\{0, 1, 5\}, \{0, 1, 5\});}
\DoxyCodeLine{436     \textcolor{keywordflow}{return} C33;}
\DoxyCodeLine{437   \}}
\DoxyCodeLine{438 \};}
\DoxyCodeLine{439 }
\DoxyCodeLine{444 \textcolor{keyword}{struct }\mbox{\hyperlink{a01428}{KlArgs}}}
\DoxyCodeLine{445 \{}
\DoxyCodeLine{446   \textcolor{keywordtype}{double} \mbox{\hyperlink{a01428_a3e897b238caac293258b7f9e292a51f1}{youngs\_modulus}};}
\DoxyCodeLine{447   \textcolor{keywordtype}{double} \mbox{\hyperlink{a01428_a6c6f839affa58485ab1ccd37ab483982}{nu}};}
\DoxyCodeLine{448   \textcolor{keywordtype}{double} \mbox{\hyperlink{a01428_a9e17b3dc5ce89a7c6cb85ebed38ba31b}{thickness}};}
\DoxyCodeLine{449 \};}
\DoxyCodeLine{450 }
\DoxyCodeLine{456 \textcolor{keyword}{auto} \mbox{\hyperlink{a00363_aecb794f40bd585f77e094976751ba41e}{kirchhoffLoveShell}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01428}{KlArgs}}\& args) \{}
\DoxyCodeLine{457   \mbox{\hyperlink{a01420}{KirchhoffLoveShellPre}} pre(\{.emodul = args.\mbox{\hyperlink{a01428_a3e897b238caac293258b7f9e292a51f1}{youngs\_modulus}}, .nu = args.\mbox{\hyperlink{a01428_a6c6f839affa58485ab1ccd37ab483982}{nu}}\}, args.\mbox{\hyperlink{a01428_a9e17b3dc5ce89a7c6cb85ebed38ba31b}{thickness}});}
\DoxyCodeLine{458 }
\DoxyCodeLine{459   \textcolor{keywordflow}{return} pre;}
\DoxyCodeLine{460 \}}
\DoxyCodeLine{461 \} \textcolor{comment}{// namespace Ikarus}}

\end{DoxyCode}
