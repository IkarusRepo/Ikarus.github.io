\hypertarget{a00080_source}{}\doxysection{material.\+hh}
\label{a00080_source}\index{material.hh@{material.hh}}
\mbox{\hyperlink{a00080}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// SPDX-\/FileCopyrightText: 2021-\/2024 The Ikarus Developers mueller@ibb.uni-\/stuttgart.de}}
\DoxyCodeLine{2 \textcolor{comment}{// SPDX-\/License-\/Identifier: LGPL-\/3.0-\/or-\/later}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{5 }
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include <dune/common/classname.hh>}}
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include <dune/python/common/typeregistry.hh>}}
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include <dune/python/pybind11/eigen.h>}}
\DoxyCodeLine{9 \textcolor{preprocessor}{\#include <dune/python/pybind11/pybind11.h>}}
\DoxyCodeLine{10 \textcolor{preprocessor}{\#include <dune/python/pybind11/stl.h>}}
\DoxyCodeLine{11 }
\DoxyCodeLine{12 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00053}{ikarus/finiteelements/mechanics/materials.hh}}>}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00101}{ikarus/utils/concepts.hh}}>}}
\DoxyCodeLine{14 }
\DoxyCodeLine{15 \textcolor{preprocessor}{\#define MAKE\_MaterialFunction(clsName, materialName, functionname, vecSize)                                            \(\backslash\)}}
\DoxyCodeLine{16 \textcolor{preprocessor}{  clsName.def(                                                                                                         \(\backslash\)}}
\DoxyCodeLine{17 \textcolor{preprocessor}{      \#functionname,                                                                                                   \(\backslash\)}}
\DoxyCodeLine{18 \textcolor{preprocessor}{      [](materialName\& self, const std::string\& straintag, Eigen::Ref<const Eigen::Vector<double, vecSize>> eVoigt\_) \{ \(\backslash\)}}
\DoxyCodeLine{19 \textcolor{preprocessor}{        if constexpr (not Concepts::IsMaterial<LinearElasticityT, materialName>) \{                                     \(\backslash\)}}
\DoxyCodeLine{20 \textcolor{preprocessor}{          Eigen::Vector<double, vecSize> eVoigt = eVoigt\_;                                                             \(\backslash\)}}
\DoxyCodeLine{21 \textcolor{preprocessor}{          if (straintag == toString(StrainTags::rightCauchyGreenTensor))                                               \(\backslash\)}}
\DoxyCodeLine{22 \textcolor{preprocessor}{            return self.template functionname<StrainTags::rightCauchyGreenTensor>(eVoigt);                             \(\backslash\)}}
\DoxyCodeLine{23 \textcolor{preprocessor}{          else if (straintag == toString(StrainTags::greenLagrangian))                                                 \(\backslash\)}}
\DoxyCodeLine{24 \textcolor{preprocessor}{            return self.template functionname<StrainTags::greenLagrangian>(eVoigt);                                    \(\backslash\)}}
\DoxyCodeLine{25 \textcolor{preprocessor}{          else if (straintag == toString(StrainTags::linear))                                                          \(\backslash\)}}
\DoxyCodeLine{26 \textcolor{preprocessor}{            DUNE\_THROW(Dune::MathError, "{}Passing linear strain to "{}} + std::string(\#materialName)                       \(\backslash\)}
\DoxyCodeLine{27                                             + "{} does not makes sense use LinearElastic class"{});                        \(\backslash\)}
\DoxyCodeLine{28           else if (straintag == toString(StrainTags::displacementGradient))                                            \(\backslash\)}
\DoxyCodeLine{29             DUNE\_THROW(Dune::MathError,                                                                                \(\backslash\)}
\DoxyCodeLine{30                        "{}Passing displacementGradient strain in 6d Voigt notation does not make any sense!"{});           \(\backslash\)}
\DoxyCodeLine{31           else if (straintag == toString(StrainTags::deformationGradient))                                             \(\backslash\)}
\DoxyCodeLine{32             DUNE\_THROW(Dune::MathError,                                                                                \(\backslash\)}
\DoxyCodeLine{33                        "{}Passing deformationGradient strain in 6d Voigt notation does not make any sense!"{});            \(\backslash\)}
\DoxyCodeLine{34           else                                                                                                         \(\backslash\)}
\DoxyCodeLine{35             DUNE\_THROW(Dune::MathError, straintag + "{}is not a valid strain tag."{});                                     \(\backslash\)}
\DoxyCodeLine{36         \} else \{                                                                                                       \(\backslash\)}
\DoxyCodeLine{37           Eigen::Vector<double, vecSize> eVoigt = eVoigt\_; \textcolor{comment}{/* Linear elastic path */}\textcolor{preprocessor}{                                   \(\backslash\)}}
\DoxyCodeLine{38 \textcolor{preprocessor}{          if (straintag == toString(StrainTags::linear))                                                               \(\backslash\)}}
\DoxyCodeLine{39 \textcolor{preprocessor}{            return self.template functionname<StrainTags::linear>(eVoigt);                                             \(\backslash\)}}
\DoxyCodeLine{40 \textcolor{preprocessor}{          else                                                                                                         \(\backslash\)}}
\DoxyCodeLine{41 \textcolor{preprocessor}{            DUNE\_THROW(Dune::MathError, "{}Linear elastic material only accepts linear strains!"{}});                       \(\backslash\)}
\DoxyCodeLine{42         \}                                                                                                              \(\backslash\)}
\DoxyCodeLine{43         \_\_builtin\_unreachable();                                                                                       \(\backslash\)}
\DoxyCodeLine{44       \},                                                                                                               \(\backslash\)}
\DoxyCodeLine{45       "{}StrainName"{}\_a, "{}strainVector"{}\_a);}
\DoxyCodeLine{46 }
\DoxyCodeLine{47 \textcolor{preprocessor}{\#define MAKE\_MATERIAL\_REGISTERY\_FUNCTION(Materialname, vecSize)                                                                \(\backslash\)}}
\DoxyCodeLine{48 \textcolor{preprocessor}{  template <class Materialname, class... options>                                                                              \(\backslash\)}}
\DoxyCodeLine{49 \textcolor{preprocessor}{  void register\#\#Materialname(pybind11::handle scope, pybind11::class\_<Materialname, options...> cls\#\#Materialname) \{          \(\backslash\)}}
\DoxyCodeLine{50 \textcolor{preprocessor}{    using pybind11::operator"{}"{}}\_a;                                                                                              \(\backslash\)}
\DoxyCodeLine{51     namespace py = pybind11;                                                                                                   \(\backslash\)}
\DoxyCodeLine{52     cls\#\#Materialname.def(pybind11::init([](double emod, double nu) \{                                                          \(\backslash\)}
\DoxyCodeLine{53                             auto matParameter                                                                                  \(\backslash\)}
\DoxyCodeLine{54                                 = Ikarus::toLamesFirstParameterAndShearModulus(\{.emodul = emod, .nu = nu\});                    \(\backslash\)}
\DoxyCodeLine{55                             return new Materialname(matParameter);                                                             \(\backslash\)}
\DoxyCodeLine{56                           \}),                                                                                                  \(\backslash\)}
\DoxyCodeLine{57                           "{}Material constructor that takes Young's modulus E and Poisson's ratio nu"{}, "{}E"{}\_a, "{}nu"{}\_a);          \(\backslash\)}
\DoxyCodeLine{58     MAKE\_MaterialFunction(cls\#\#Materialname, Materialname, storedEnergy, vecSize);                                             \(\backslash\)}
\DoxyCodeLine{59     MAKE\_MaterialFunction(cls\#\#Materialname, Materialname, stresses, vecSize);                                                 \(\backslash\)}
\DoxyCodeLine{60     MAKE\_MaterialFunction(cls\#\#Materialname, Materialname, tangentModuli, vecSize);                                            \(\backslash\)}
\DoxyCodeLine{61                                                                                                                                \(\backslash\)}
\DoxyCodeLine{62     using PlaneStressClass = decltype(planeStress(std::declval<Materialname>()));                                              \(\backslash\)}
\DoxyCodeLine{63     auto includes          = Dune::Python::IncludeFiles\{"{}ikarus/finiteelements/mechanics/materials.hh"{}\};                       \(\backslash\)}
\DoxyCodeLine{64     auto pS                = Dune::Python::insertClass<PlaneStressClass>(                                                      \(\backslash\)}
\DoxyCodeLine{65                   scope, std::string("{}PlaneStress\_"{}) + \#Materialname,                                           \(\backslash\)}
\DoxyCodeLine{66                   Dune::Python::GenerateTypeName(                                                               \(\backslash\)}
\DoxyCodeLine{67                                      "{}Ikarus::VanishingStress<std::array<Ikarus::Impl::StressIndexPair, "{}                      \(\backslash\)}
\DoxyCodeLine{68                                                     "{}3ul>\{\{Ikarus::Impl::StressIndexPair\{2ul, 1ul\}, Ikarus::Impl::StressIndexPair\{2ul,0ul\}, "{} \(\backslash\)}
\DoxyCodeLine{69                                                     "{}Ikarus::Impl::StressIndexPair\{2ul, 2ul\}\}\},"{}                                              \(\backslash\)}
\DoxyCodeLine{70                                      + Dune::className<Materialname>() + "{}>"{}),                                                 \(\backslash\)}
\DoxyCodeLine{71                   includes)                                                                                     \(\backslash\)}
\DoxyCodeLine{72                   .first;                                                                                                      \(\backslash\)}
\DoxyCodeLine{73     MAKE\_MaterialFunction(pS, PlaneStressClass, storedEnergy, 3);                                                              \(\backslash\)}
\DoxyCodeLine{74     MAKE\_MaterialFunction(pS, PlaneStressClass, stresses, 3);                                                                  \(\backslash\)}
\DoxyCodeLine{75     MAKE\_MaterialFunction(pS, PlaneStressClass, tangentModuli, 3);                                                             \(\backslash\)}
\DoxyCodeLine{76     MAKE\_MaterialFunction(pS, PlaneStressClass, storedEnergy, 6);                                                              \(\backslash\)}
\DoxyCodeLine{77     MAKE\_MaterialFunction(pS, PlaneStressClass, stresses, 6);                                                                  \(\backslash\)}
\DoxyCodeLine{78     MAKE\_MaterialFunction(pS, PlaneStressClass, tangentModuli, 6);                                                             \(\backslash\)}
\DoxyCodeLine{79     cls\#\#Materialname.def("{}asPlaneStress"{}, [](Materialname\& self) \{                                                            \(\backslash\)}
\DoxyCodeLine{80       return planeStress(self);                                                                                                \(\backslash\)}
\DoxyCodeLine{81     \}); \textcolor{comment}{/* no keep\_alive since planeStress copies the material */}\textcolor{preprocessor}{                                                              \(\backslash\)}}
\DoxyCodeLine{82 \textcolor{preprocessor}{    using shellMaterialClass = decltype(shellMaterial(std::declval<Materialname>()));                                          \(\backslash\)}}
\DoxyCodeLine{83 \textcolor{preprocessor}{    auto shellmaterial                                                                                                         \(\backslash\)}}
\DoxyCodeLine{84 \textcolor{preprocessor}{        = Dune::Python::insertClass<shellMaterialClass>(                                                                       \(\backslash\)}}
\DoxyCodeLine{85 \textcolor{preprocessor}{              scope, std::string("{}Shell\_"{}}) + \#Materialname,                                                                    \(\backslash\)}
\DoxyCodeLine{86               Dune::Python::GenerateTypeName("{}Ikarus::VanishingStress<std::array<Ikarus::Impl::StressIndexPair, "{}              \(\backslash\)}
\DoxyCodeLine{87                                              "{}1ul>\{\{Ikarus::Impl::StressIndexPair\{2ul, 2ul\}\}\},"{}                                \(\backslash\)}
\DoxyCodeLine{88                                              + Dune::className<Materialname>() + "{}>"{}),                                         \(\backslash\)}
\DoxyCodeLine{89               includes)                                                                                                        \(\backslash\)}
\DoxyCodeLine{90               .first;                                                                                                          \(\backslash\)}
\DoxyCodeLine{91     MAKE\_MaterialFunction(shellmaterial, shellMaterialClass, storedEnergy, 5);                                                 \(\backslash\)}
\DoxyCodeLine{92     MAKE\_MaterialFunction(shellmaterial, shellMaterialClass, stresses, 5);                                                     \(\backslash\)}
\DoxyCodeLine{93     MAKE\_MaterialFunction(shellmaterial, shellMaterialClass, tangentModuli, 5);                                                \(\backslash\)}
\DoxyCodeLine{94     MAKE\_MaterialFunction(shellmaterial, shellMaterialClass, storedEnergy, 6);                                                 \(\backslash\)}
\DoxyCodeLine{95     MAKE\_MaterialFunction(shellmaterial, shellMaterialClass, stresses, 6);                                                     \(\backslash\)}
\DoxyCodeLine{96     MAKE\_MaterialFunction(shellmaterial, shellMaterialClass, tangentModuli, 6);                                                \(\backslash\)}
\DoxyCodeLine{97     cls\#\#Materialname.def("{}asShellMaterial"{}, [](Materialname\& self) \{                                                          \(\backslash\)}
\DoxyCodeLine{98       return shellMaterial(self);                                                                                              \(\backslash\)}
\DoxyCodeLine{99     \}); \textcolor{comment}{/* no keep\_alive since shellMaterial copies the material */}\textcolor{preprocessor}{                                                            \(\backslash\)}}
\DoxyCodeLine{100 \textcolor{preprocessor}{    using beamMaterialClass = decltype(beamMaterial(std::declval<Materialname>()));                                            \(\backslash\)}}
\DoxyCodeLine{101 \textcolor{preprocessor}{    auto beammaterial       = Dune::Python::insertClass<beamMaterialClass>(                                                    \(\backslash\)}}
\DoxyCodeLine{102 \textcolor{preprocessor}{                            scope, std::string("{}Beam\_"{}}) + \#Materialname,                                                 \(\backslash\)}
\DoxyCodeLine{103                             Dune::Python::GenerateTypeName(                                                              \(\backslash\)}
\DoxyCodeLine{104                                       "{}Ikarus::VanishingStress<std::array<Ikarus::Impl::StressIndexPair, "{}                     \(\backslash\)}
\DoxyCodeLine{105                                             "{}2ul>\{\{Impl::StressIndexPair\{1, 1\},Ikarus::Impl::StressIndexPair\{2ul, 2ul\}\}\},"{}           \(\backslash\)}
\DoxyCodeLine{106                                       + Dune::className<Materialname>() + "{}>"{}),                                                \(\backslash\)}
\DoxyCodeLine{107                             includes)                                                                                    \(\backslash\)}
\DoxyCodeLine{108                             .first;                                                                                            \(\backslash\)}
\DoxyCodeLine{109     MAKE\_MaterialFunction(beammaterial, beamMaterialClass, storedEnergy, 4);                                                   \(\backslash\)}
\DoxyCodeLine{110     MAKE\_MaterialFunction(beammaterial, beamMaterialClass, stresses, 4);                                                       \(\backslash\)}
\DoxyCodeLine{111     MAKE\_MaterialFunction(beammaterial, beamMaterialClass, tangentModuli, 4);                                                  \(\backslash\)}
\DoxyCodeLine{112     MAKE\_MaterialFunction(beammaterial, beamMaterialClass, storedEnergy, 6);                                                   \(\backslash\)}
\DoxyCodeLine{113     MAKE\_MaterialFunction(beammaterial, beamMaterialClass, stresses, 6);                                                       \(\backslash\)}
\DoxyCodeLine{114     MAKE\_MaterialFunction(beammaterial, beamMaterialClass, tangentModuli, 6);                                                  \(\backslash\)}
\DoxyCodeLine{115     cls\#\#Materialname.def("{}asBeamMaterial"{}, [](Materialname\& self) \{                                                           \(\backslash\)}
\DoxyCodeLine{116       return beamMaterial(self);                                                                                               \(\backslash\)}
\DoxyCodeLine{117     \}); \textcolor{comment}{/* no keep\_alive since beamMaterial copies the material */}\textcolor{preprocessor}{                                                             \(\backslash\)}}
\DoxyCodeLine{118 \textcolor{preprocessor}{  \}}}
\DoxyCodeLine{119 }
\DoxyCodeLine{120 \textcolor{preprocessor}{\#define MAKE\_MATERIAL\_CLASS\_IN\_MODULE(Materialname, args)                                                      \(\backslash\)}}
\DoxyCodeLine{121 \textcolor{preprocessor}{  auto includes\#\#Materialname = Dune::Python::IncludeFiles\{"{}ikarus/finiteelements/mechanics/materials.hh"{}}\};    \(\backslash\)}
\DoxyCodeLine{122   auto cls\#\#Materialname                                                                                       \(\backslash\)}
\DoxyCodeLine{123       = Dune::Python::insertClass<Ikarus::Materialname<args>>(                                                 \(\backslash\)}
\DoxyCodeLine{124             m, \#Materialname, Dune::Python::GenerateTypeName("{}Ikarus::"{} + std::string(\#Materialname<\#\#args>)), \(\backslash\)}
\DoxyCodeLine{125             includes\#\#Materialname)                                                                            \(\backslash\)}
\DoxyCodeLine{126             .first;                                                                                            \(\backslash\)}
\DoxyCodeLine{127   cls\#\#Materialname.def(pybind11::init([](double emod, double nu) \{                                            \(\backslash\)}
\DoxyCodeLine{128                           auto matParameter                                                                    \(\backslash\)}
\DoxyCodeLine{129                               = Ikarus::toLamesFirstParameterAndShearModulus(\{.emodul = emod, .nu = nu\});      \(\backslash\)}
\DoxyCodeLine{130                           return new Materialname(matParameter);                                               \(\backslash\)}
\DoxyCodeLine{131                         \}),                                                                                    \(\backslash\)}
\DoxyCodeLine{132                         "{}Material constructor that takes Young's modulus E and Poisson's ratio nu"{}             \(\backslash\)}
\DoxyCodeLine{133                         "{}E"{}\_a,                                                                                 \(\backslash\)}
\DoxyCodeLine{134                         "{}nu"{}\_a);                                                                               \(\backslash\)}
\DoxyCodeLine{135   MAKE\_MaterialFunction(Materialname<\#\#args>, storedEnergy);                                                   \(\backslash\)}
\DoxyCodeLine{136   MAKE\_MaterialFunction(Materialname<\#\#args>, stresses);                                                       \(\backslash\)}
\DoxyCodeLine{137   MAKE\_MaterialFunction(Materialname<\#\#args>, tangentModuli);}
\DoxyCodeLine{138 }
\DoxyCodeLine{139 \textcolor{keyword}{namespace }\mbox{\hyperlink{a00227}{Ikarus::Python}} \{}
\DoxyCodeLine{140 }
\DoxyCodeLine{141   \mbox{\hyperlink{a00227_a2cdc302115d5d01f08f150303127978d}{MAKE\_MATERIAL\_REGISTERY\_FUNCTION}}(\mbox{\hyperlink{a01169}{LinearElasticity}}, 6);}
\DoxyCodeLine{142   \mbox{\hyperlink{a00227_a2cdc302115d5d01f08f150303127978d}{MAKE\_MATERIAL\_REGISTERY\_FUNCTION}}(\mbox{\hyperlink{a01177}{StVenantKirchhoff}}, 6);}
\DoxyCodeLine{143   \mbox{\hyperlink{a00227_a2cdc302115d5d01f08f150303127978d}{MAKE\_MATERIAL\_REGISTERY\_FUNCTION}}(\mbox{\hyperlink{a01173}{NeoHooke}}, 6);}
\DoxyCodeLine{144 \}  \textcolor{comment}{// namespace Ikarus::Python}}

\end{DoxyCode}
