\hypertarget{a00179_source}{}\doxysection{resultfunction.\+hh}
\label{a00179_source}\index{resultfunction.hh@{resultfunction.hh}}
\mbox{\hyperlink{a00179}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// SPDX-\/FileCopyrightText: 2021-\/2024 The Ikarus Developers mueller@ibb.uni-\/stuttgart.de}}
\DoxyCodeLine{2 \textcolor{comment}{// SPDX-\/License-\/Identifier: LGPL-\/3.0-\/or-\/later}}
\DoxyCodeLine{3 }
\DoxyCodeLine{11 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{12 }
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include <type\_traits>}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include <utility>}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{preprocessor}{\#include <dune/vtk/vtkwriter.hh>}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00206}{ikarus/finiteelements/ferequirements.hh}}>}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00182}{ikarus/io/resultevaluators.hh}}>}}
\DoxyCodeLine{20 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00044}{ikarus/utils/eigendunetransformations.hh}}>}}
\DoxyCodeLine{21 }
\DoxyCodeLine{22 \textcolor{keyword}{namespace }\mbox{\hyperlink{a00325}{Ikarus}} \{}
\DoxyCodeLine{23 \textcolor{keyword}{namespace }Impl \{}
\DoxyCodeLine{24   \textcolor{keyword}{struct }DefaultUserFunction}
\DoxyCodeLine{25   \{}
\DoxyCodeLine{26   \};}
\DoxyCodeLine{27 \} \textcolor{comment}{// namespace Impl}}
\DoxyCodeLine{28 }
\DoxyCodeLine{46 \textcolor{keyword}{template} <\textcolor{keyword}{typename} FE, ResultType resType, \textcolor{keyword}{typename} UserFunction = Impl::DefaultUserFunction>}
\DoxyCodeLine{47 \textcolor{keyword}{class }\mbox{\hyperlink{a01386}{ResultFunction}} : \textcolor{keyword}{public} Dune::VTKFunction<typename FE::GridView>}
\DoxyCodeLine{48 \{}
\DoxyCodeLine{49 \textcolor{keyword}{public}:}
\DoxyCodeLine{50   \textcolor{keyword}{using }\mbox{\hyperlink{a01386_aba444e0afcbef3afab7c7dba660dd39c}{FiniteElement}}          = FE;}
\DoxyCodeLine{51   \textcolor{keyword}{using }\mbox{\hyperlink{a01386_a6c4177e83cfe14cba5d6de0a7ce87283}{FERequirementType}}      = \textcolor{keyword}{typename} FiniteElement::FERequirementType;}
\DoxyCodeLine{52   \textcolor{keyword}{using }\mbox{\hyperlink{a01386_a2744c437727bc72267b949c121fc912b}{GridView}}               = \textcolor{keyword}{typename} FiniteElement::GridView;}
\DoxyCodeLine{53   \textcolor{keyword}{using }\mbox{\hyperlink{a01386_a1b960380b9e520e5c37a552158dcbc9e}{ctype}}                  = \textcolor{keyword}{typename} GridView::ctype;}
\DoxyCodeLine{54   \textcolor{keyword}{constexpr} \textcolor{keyword}{static} \textcolor{keywordtype}{int} \mbox{\hyperlink{a01386_ae74f225ad7718b34215ae249c3d235b1}{griddim}} = GridView::dimension;}
\DoxyCodeLine{55   \textcolor{keyword}{using }\mbox{\hyperlink{a01386_a51070aab44aa6c0d6399555c3b737542}{Entity}}                 = \textcolor{keyword}{typename} GridView::template Codim<0>::Entity;}
\DoxyCodeLine{56 }
\DoxyCodeLine{67   \textcolor{keywordtype}{double} \mbox{\hyperlink{a01386_a91d31c9d876847fd0e136a03dab6969a}{evaluate}}(\textcolor{keywordtype}{int} comp, \textcolor{keyword}{const} \mbox{\hyperlink{a01386_a51070aab44aa6c0d6399555c3b737542}{Entity}}\& e, \textcolor{keyword}{const} \mbox{\hyperlink{a01370}{Dune::FieldVector<ctype, griddim>}}\& local)\textcolor{keyword}{ const override }\{}
\DoxyCodeLine{68     \textcolor{keyword}{auto} index = gridView\_.indexSet().index(e);}
\DoxyCodeLine{69     \textcolor{keywordflow}{return} evaluateComponent(index, local, comp);}
\DoxyCodeLine{70   \}}
\DoxyCodeLine{71 }
\DoxyCodeLine{79   [[nodiscard]] \textcolor{keywordtype}{int} \mbox{\hyperlink{a01386_a45726779c3ca035c7c4fa700cee30d93}{ncomps}}()\textcolor{keyword}{ const override }\{}
\DoxyCodeLine{80     \textcolor{keywordflow}{if} \textcolor{keyword}{constexpr} (std::is\_same\_v<UserFunction, Impl::DefaultUserFunction>) \{}
\DoxyCodeLine{81       \mbox{\hyperlink{a01370}{Dune::FieldVector<ctype, griddim>}} val(0.0);}
\DoxyCodeLine{82 }
\DoxyCodeLine{83       \textcolor{keyword}{auto} sigma = fes\_-\/>at(0).template calculateAt<resType>(feRequirements\_, val);}
\DoxyCodeLine{84 }
\DoxyCodeLine{85       \textcolor{keywordflow}{return} \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(sigma.rows() * sigma.cols());}
\DoxyCodeLine{86     \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{87       \textcolor{keywordflow}{return} userFunction\_.ncomps();}
\DoxyCodeLine{88   \}}
\DoxyCodeLine{89 }
\DoxyCodeLine{97   [[nodiscard]] \textcolor{keyword}{constexpr} std::string \mbox{\hyperlink{a01386_a8be0f4769c4f515b64805b77b0146ae4}{name}}()\textcolor{keyword}{ const override }\{}
\DoxyCodeLine{98     \textcolor{keywordflow}{if} \textcolor{keyword}{constexpr} (std::is\_same\_v<UserFunction, Impl::DefaultUserFunction>)}
\DoxyCodeLine{99       \textcolor{keywordflow}{return} \mbox{\hyperlink{a00325_a0853622412d4cedc078b81ba454eb250}{toString}}(resType);}
\DoxyCodeLine{100     \textcolor{keywordflow}{else}}
\DoxyCodeLine{101       \textcolor{keywordflow}{return} userFunction\_.name();}
\DoxyCodeLine{102   \}}
\DoxyCodeLine{103 }
\DoxyCodeLine{112   \mbox{\hyperlink{a01386_ab9999ef0144c8caf38883e080ac489a0}{ResultFunction}}(std::vector<FiniteElement>* fes, \textcolor{keyword}{const} \mbox{\hyperlink{a01386_a6c4177e83cfe14cba5d6de0a7ce87283}{FERequirementType}}\& req)}
\DoxyCodeLine{113       : gridView\_\{fes-\/>at(0).localView().globalBasis().gridView()\},}
\DoxyCodeLine{114         feRequirements\_\{req\},}
\DoxyCodeLine{115         fes\_\{fes\},}
\DoxyCodeLine{116         userFunction\_\{UserFunction\{\}\} \{\}}
\DoxyCodeLine{117 }
\DoxyCodeLine{118 \textcolor{keyword}{private}:}
\DoxyCodeLine{119   \textcolor{keywordtype}{double} evaluateComponent(\textcolor{keywordtype}{int} eleID, \textcolor{keyword}{const} \mbox{\hyperlink{a01370}{Dune::FieldVector<ctype, griddim>}}\& local, \textcolor{keywordtype}{int} comp)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{120     \textcolor{keyword}{auto} result = fes\_-\/>at(eleID).template calculateAt<resType>(feRequirements\_, local);}
\DoxyCodeLine{121 }
\DoxyCodeLine{122     \textcolor{keywordflow}{if} \textcolor{keyword}{constexpr} (!std::is\_same\_v<UserFunction, Impl::DefaultUserFunction>)}
\DoxyCodeLine{123       \textcolor{keywordflow}{return} userFunction\_(result, comp);}
\DoxyCodeLine{124     \textcolor{keywordflow}{else}}
\DoxyCodeLine{125       \textcolor{keywordflow}{return} result(comp);}
\DoxyCodeLine{126   \}}
\DoxyCodeLine{127 }
\DoxyCodeLine{128   \mbox{\hyperlink{a01386_a2744c437727bc72267b949c121fc912b}{GridView}} gridView\_;}
\DoxyCodeLine{129   \mbox{\hyperlink{a01386_a6c4177e83cfe14cba5d6de0a7ce87283}{FERequirementType}} feRequirements\_;}
\DoxyCodeLine{130   std::vector<FiniteElement>* fes\_;}
\DoxyCodeLine{131   [[no\_unique\_address]] std::string name\_\{\};}
\DoxyCodeLine{132   UserFunction userFunction\_;}
\DoxyCodeLine{133 \};}
\DoxyCodeLine{134 \} \textcolor{comment}{// namespace Ikarus}}

\end{DoxyCode}
