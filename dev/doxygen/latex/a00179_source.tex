\hypertarget{a00179_source}{}\doxysection{powerbasisfe.\+hh}
\label{a00179_source}\index{powerbasisfe.hh@{powerbasisfe.hh}}
\mbox{\hyperlink{a00179}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// SPDX-\/FileCopyrightText: 2021-\/2024 The Ikarus Developers mueller@ibb.uni-\/stuttgart.de}}
\DoxyCodeLine{2 \textcolor{comment}{// SPDX-\/License-\/Identifier: LGPL-\/3.0-\/or-\/later}}
\DoxyCodeLine{3 }
\DoxyCodeLine{9 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{10 }
\DoxyCodeLine{11 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{a00185}{ikarus/finiteelements/fetraits.hh}}>}}
\DoxyCodeLine{12 }
\DoxyCodeLine{13 \textcolor{keyword}{namespace }\mbox{\hyperlink{a00325}{Ikarus}} \{}
\DoxyCodeLine{14 }
\DoxyCodeLine{22 \textcolor{keyword}{template} <\textcolor{keyword}{typename} Basis>}
\DoxyCodeLine{23 \textcolor{keyword}{class }\mbox{\hyperlink{a01226}{PowerBasisFE}}}
\DoxyCodeLine{24 \{}
\DoxyCodeLine{25 \textcolor{keyword}{public}:}
\DoxyCodeLine{26   \textcolor{keyword}{using }\mbox{\hyperlink{a01258}{Traits}}      = \mbox{\hyperlink{a01258}{FETraits<Basis>}};              }
\DoxyCodeLine{27   \textcolor{keyword}{using }\mbox{\hyperlink{a01226_a9199b27c710f3cf1bb3379381e1d3ac8}{RootBasis}}   = \textcolor{keyword}{typename} \mbox{\hyperlink{a01258_aa32f74d438637b2a1e3862b20b010823}{Traits::FlatBasis}};   }
\DoxyCodeLine{28   \textcolor{keyword}{using }\mbox{\hyperlink{a01226_ae2267e6126300a8e6afac2b3cdf15a87}{LocalView}}   = \textcolor{keyword}{typename} \mbox{\hyperlink{a01258_aaff1416c2f755aa06e3f85dbf46c2bcb}{Traits::LocalView}};   }
\DoxyCodeLine{29   \textcolor{keyword}{using }\mbox{\hyperlink{a01226_a8d6c61ef84c53a1468462f803cdba0a5}{GlobalIndex}} = \textcolor{keyword}{typename} \mbox{\hyperlink{a01258_a58c165013cc9427aef846dad4dc6703e}{Traits::GlobalIndex}}; }
\DoxyCodeLine{30   \textcolor{keyword}{using }\mbox{\hyperlink{a01226_a983249c2d5963504ba570dd6da67f67c}{GridElement}} = \textcolor{keyword}{typename} \mbox{\hyperlink{a01258_a17b758b602def406352e9dd72a136288}{Traits::Element}};     }
\DoxyCodeLine{31 }
\DoxyCodeLine{38   \textcolor{keyword}{explicit} \mbox{\hyperlink{a01226_a009345be8aeaf011f22f4c32c7d6f638}{PowerBasisFE}}(\textcolor{keyword}{const} \mbox{\hyperlink{a01458}{Basis}}\& p\_basis, \textcolor{keyword}{const} \textcolor{keyword}{typename} LocalView::Element\& element)}
\DoxyCodeLine{39       : localView\_\{p\_basis.flat().\mbox{\hyperlink{a01226_a4b49c02de08fb5c115affa646c5f249a}{localView}}()\} \{}
\DoxyCodeLine{40     \textcolor{keyword}{static\_assert}(\mbox{\hyperlink{a01628}{Ikarus::Concepts::PowerBasis<RootBasis>}},}
\DoxyCodeLine{41                   \textcolor{stringliteral}{"{}You didn't pass a localview of a power basis to this method"{}});}
\DoxyCodeLine{42     \textcolor{keyword}{static\_assert}(RootBasis::PreBasis::Node::degree() != 1, \textcolor{stringliteral}{"{}The basis has only one children. Maybe use scalarFE.hh."{}});}
\DoxyCodeLine{43 }
\DoxyCodeLine{44     localView\_.bind(element);}
\DoxyCodeLine{45   \}}
\DoxyCodeLine{46 }
\DoxyCodeLine{48   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} \mbox{\hyperlink{a01226_a08d63c99f722a352ee1ebe29bcb88bcd}{num\_children}} = RootBasis::PreBasis::Node::degree();}
\DoxyCodeLine{49 }
\DoxyCodeLine{54   [[nodiscard]] \textcolor{keyword}{constexpr} \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{a01226_a65fbcfb67bd20fd4a434230b5efa5bd1}{size}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} localView\_.size(); \}}
\DoxyCodeLine{55 }
\DoxyCodeLine{63   \textcolor{keywordtype}{void} \mbox{\hyperlink{a01226_ac47a208cf2511bf8676282280360ab38}{globalFlatIndices}}(std::vector<GlobalIndex>\& globalIndices)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{64     globalIndices.clear();}
\DoxyCodeLine{65 }
\DoxyCodeLine{66     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& fe = localView\_.tree().child(0).finiteElement();}
\DoxyCodeLine{67     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < fe.size(); ++i) \{}
\DoxyCodeLine{68       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < \mbox{\hyperlink{a01226_a08d63c99f722a352ee1ebe29bcb88bcd}{num\_children}}; ++j) \{}
\DoxyCodeLine{69         globalIndices.push\_back(localView\_.index((localView\_.tree().child(j).localIndex(i))));}
\DoxyCodeLine{70       \}}
\DoxyCodeLine{71     \}}
\DoxyCodeLine{72   \}}
\DoxyCodeLine{73 }
\DoxyCodeLine{78   \textcolor{keyword}{const} \mbox{\hyperlink{a01226_a983249c2d5963504ba570dd6da67f67c}{GridElement}}\& \mbox{\hyperlink{a01226_a0fe5d4e10f331905629351786c72ce6a}{gridElement}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} localView\_.element(); \}}
\DoxyCodeLine{79 }
\DoxyCodeLine{84   \textcolor{keyword}{const} \mbox{\hyperlink{a01226_ae2267e6126300a8e6afac2b3cdf15a87}{LocalView}}\& \mbox{\hyperlink{a01226_a4b49c02de08fb5c115affa646c5f249a}{localView}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} localView\_; \}}
\DoxyCodeLine{85 }
\DoxyCodeLine{90   \mbox{\hyperlink{a01226_ae2267e6126300a8e6afac2b3cdf15a87}{LocalView}}\& \mbox{\hyperlink{a01226_a00a045439d18c431ef49d7349230272b}{localView}}() \{ \textcolor{keywordflow}{return} localView\_; \}}
\DoxyCodeLine{91 }
\DoxyCodeLine{92 \textcolor{keyword}{private}:}
\DoxyCodeLine{93   \mbox{\hyperlink{a01226_ae2267e6126300a8e6afac2b3cdf15a87}{LocalView}} localView\_;}
\DoxyCodeLine{94 \};}
\DoxyCodeLine{95 }
\DoxyCodeLine{96 \} \textcolor{comment}{// namespace Ikarus}}

\end{DoxyCode}
